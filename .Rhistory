# Chunk 3
dwd.spp<-dwd3 %>%
group_by(COMMON_NAME)%>%
summarize(n=n())
dwd.spp$pct<-(dwd.spp$n/sum(dwd.spp$n)*100)
# Chunk 4
dwd3$SPGR<-ifelse(dwd3$SFTWD_HRDWD=="S","Sftwd","Hwd")
dwd3$SPGR<-ifelse(dwd3$ECOSUB %in% c(251,411,255,333,999),"All", dwd3$SPGR)
dwd4<-merge(dwd3,parm,by=c("ECOSUB","SPGR"))
# Chunk 5
dwd5<-dwd4 %>%
mutate(ELEV_m=ELEV*0.0348,
SLOPDIST_m=SLOPDIST*0.3048,
HORIZ_DIST_m=HORIZ_DIST*0.3048,
TRANSDIA_cm=TRANSDIA*2.54,
SMALLDIA_cm=SMALLDIA*2.54,
LARGEDIA_cm=LARGEDIA*2.54,
LENGTH_m=LENGTH*0.3048)
# Chunk 6
DIAM.hat<-function(b0,b1,b2,b3,DT,DC){
DIAM.hat=b0+(b1*DT)+(b2*DC)+(b3*(DT*DC))
return(DIAM.hat)
}
LTH.hat<-function(b0,b1,b2,b3,DS.hat,DL.hat,DC){
LTH.hat=b0+(b1*DS.hat)+(b2*DL.hat)+(b3*DC)
return(LTH.hat)
}
dwd5$DL.hat.woodall<-DIAM.hat(b0=dwd5$b0_ld,b1=dwd5$b1_ld,b2=dwd5$b2_ld,b3=dwd5$b3_ld,
DT=dwd5$TRANSDIA_m,DC=dwd5$DECAYCD)
dwd5$DS.hat.woodall<-DIAM.hat(b0=dwd5$b0_sd,b1=dwd5$b1_sd,b2=dwd5$b2_sd,b3=dwd5$b3_sd,
DT=dwd5$TRANSDIA_m,DC=dwd5$DECAYCD)
dwd5$LTH.hat.woodall<-LTH.hat(b0=dwd5$b0_lth,b1=dwd5$b1_lth,b2=dwd5$b2_lth,b3=dwd5$b3_lth,
DS.hat=dwd5$DS.hat.woodall,DL.hat=dwd5$DL.hat.woodall,DC=dwd5$DECAYCD)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
#Dataset = 736,553 observations, downloaded 11 May 2019
dwd.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//DWM_COARSE_WOODY_DEBRIS.csv')
plot.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//PLOT.csv')
plot.raw<-plot.raw %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV)
dwd<-merge(dwd.raw,plot.raw,by=c("STATECD","COUNTYCD","PLOT","INVYR"))
dwd<-dwd %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV,SUBP,TRANSECT,CWDID,MEASYEAR,CONDID,SLOPDIST,HORIZ_DIST, SPCD,DECAYCD,TRANSDIA,SMALLDIA,LARGEDIA,LENGTH,HOLLOWCD,CWDHSTCD,ECOSUBCD,LAT,LON,ELEV)
dwd<-mutate(dwd, ECOSUB = substr(ECOSUBCD,2,4))
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c("33A"),"333",dwd$ECOSUB)
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c(""),"999",dwd$ECOSUB)
dwd.eco<-dwd %>%
group_by(ECOSUB)%>%
summarize(n=n())
dwd.eco
#Woodall et al. parameters
#Woodall CW, Westfall JA, Lutes DC, Oswalt SN (2008).
#End-point diameter and total length coarse woody debris models for the United States.
#For Ecol Manage 255:3700-3706
#Some ecogerions do not have parameters listed in Woodall et al.
#For these, parameters for a similar ecogerion were used:
#211 = 212
#223 = 221
#241 = 242
#411 = 255
#999 = average of parameters from all others
parm<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//dwdparms.csv')
#Read in species dataset to get major species group codes
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
spp<-spp %>%
select(SPCD,MAJOR_SPGRPCD,SFTWD_HRDWD,COMMON_NAME)
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,999,dwd2$SPCD)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
# Chunk 3
dwd.spp<-dwd3 %>%
group_by(COMMON_NAME)%>%
summarize(n=n())
dwd.spp$pct<-(dwd.spp$n/sum(dwd.spp$n)*100)
# Chunk 4
dwd3$SPGR<-ifelse(dwd3$SFTWD_HRDWD=="S","Sftwd","Hwd")
dwd3$SPGR<-ifelse(dwd3$ECOSUB %in% c(251,411,255,333,999),"All", dwd3$SPGR)
dwd4<-merge(dwd3,parm,by=c("ECOSUB","SPGR"))
# Chunk 5
dwd5<-dwd4 %>%
mutate(ELEV_m=ELEV*0.0348,
SLOPDIST_m=SLOPDIST*0.3048,
HORIZ_DIST_m=HORIZ_DIST*0.3048,
TRANSDIA_cm=TRANSDIA*2.54,
SMALLDIA_cm=SMALLDIA*2.54,
LARGEDIA_cm=LARGEDIA*2.54,
LENGTH_m=LENGTH*0.3048)
DIAM.hat<-function(b0,b1,b2,b3,DT,DC){
DIAM.hat=b0+(b1*DT)+(b2*DC)+(b3*(DT*DC))
return(DIAM.hat)
}
LTH.hat<-function(b0,b1,b2,b3,DS.hat,DL.hat,DC){
LTH.hat=b0+(b1*DS.hat)+(b2*DL.hat)+(b3*DC)
return(LTH.hat)
}
dwd5$DL.hat.woodall<-DIAM.hat(b0=dwd5$b0_ld,b1=dwd5$b1_ld,b2=dwd5$b2_ld,b3=dwd5$b3_ld,
DT=dwd5$TRANSDIA_m,DC=dwd5$DECAYCD)
dwd5$b0_ld
dwd5$b1_ld
dwd5$b2_ld
dwd5$b3_ld
dwd5$DL.hat.woodall<-DIAM.hat(b0=dwd5$b0_ld,b1=dwd5$b1_ld,b2=dwd5$b2_ld,b3=dwd5$b3_ld,
DT=dwd5$TRANSDIA_cm,DC=dwd5$DECAYCD)
dwd5$DS.hat.woodall<-DIAM.hat(b0=dwd5$b0_sd,b1=dwd5$b1_sd,b2=dwd5$b2_sd,b3=dwd5$b3_sd,
DT=dwd5$TRANSDIA_cm,DC=dwd5$DECAYCD)
dwd5$LTH.hat.woodall<-LTH.hat(b0=dwd5$b0_lth,b1=dwd5$b1_lth,b2=dwd5$b2_lth,b3=dwd5$b3_lth,
DS.hat=dwd5$DS.hat.woodall,DL.hat=dwd5$DL.hat.woodall,DC=dwd5$DECAYCD)
p.DL<-ggplot(dwd5,aes(y=DL.hat.woodall,x=LARGEDIA_cm))+geom_point()+
xlab("Observed DL")+
ylab("Predicted DL from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"),
axis.ticks.y=element_blank())
p.DL
p.DS<-ggplot(dwd5,aes(y=DS.hat.woodall,x=SMALLLDIA_cm))+geom_point()+
xlab("Observed DS")+
ylab("Predicted DS from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"),
axis.ticks.y=element_blank())
p.DS
p.LTH<-ggplot(dwd5,aes(y=LTH.hat.woodall,x=LENGTH_m))+geom_point()+
xlab("Observed length")+
ylab("Predicted length from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"),
axis.ticks.y=element_blank())
p.LTH
p.DL<-ggplot(dwd5,aes(y=DL.hat.woodall,x=LARGEDIA_cm))+geom_point()+stat_smooth()+
xlab("Observed DL")+
ylab("Predicted DL from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"),
axis.ticks.y=element_blank())
p.DL
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//p.DL.png", plot=p.DL,width=4,height=4,units="in",scale=1)
p.DL<-ggplot(dwd5,aes(y=DL.hat.woodall,x=LARGEDIA_cm))+geom_point()+stat_smooth()+
xlab("Observed DL")+
ylab("Predicted DL from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"),
axis.ticks.y=element_blank())
#p.DL
p.DS<-ggplot(dwd5,aes(y=DS.hat.woodall,x=SMALLLDIA_cm))+geom_point()+stat_smooth()+
xlab("Observed DS")+
ylab("Predicted DS from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"),
axis.ticks.y=element_blank())
#p.DS
p.LTH<-ggplot(dwd5,aes(y=LTH.hat.woodall,x=LENGTH_m))+geom_point()++stat_smooth()+
xlab("Observed length")+
ylab("Predicted length from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"),
axis.ticks.y=element_blank())
#p.LTH
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//p.DL.png", plot=p.DL,width=4,height=4,units="in",scale=1)
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//p.DS.png", plot=p.DS,width=4,height=4,units="in",scale=1)
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//p.LTH.png", plot=p.LTH,width=4,height=4,units="in",scale=1)
p.DS<-ggplot(dwd5,aes(y=DS.hat.woodall,x=SMALLDIA_cm))+geom_point()+stat_smooth()+
xlab("Observed DS")+
ylab("Predicted DS from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"),
axis.ticks.y=element_blank())
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//p.DS.png", plot=p.DS,width=4,height=4,units="in",scale=1)
p.DL<-ggplot(dwd5,aes(y=DL.hat.woodall,x=LARGEDIA_cm))+geom_point()+stat_smooth()+
xlab("Observed DL")+
ylab("Predicted DL from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"))
#p.DL
p.DS<-ggplot(dwd5,aes(y=DS.hat.woodall,x=SMALLDIA_cm))+geom_point()+stat_smooth()+
xlab("Observed DS")+
ylab("Predicted DS from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"))
#p.DS
p.LTH<-ggplot(dwd5,aes(y=LTH.hat.woodall,x=LENGTH_m))+geom_point()+stat_smooth()+
xlab("Observed length")+
ylab("Predicted length from Woodall")+
theme(axis.text.y=element_blank(),
panel.background = element_rect(fill = "NA"))
#p.LTH
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//Analysis//p.DL.png", plot=p.DL,width=4,height=4,units="in",scale=1)
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//Analysis//p.DS.png", plot=p.DS,width=4,height=4,units="in",scale=1)
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//Analysis//p.LTH.png", plot=p.LTH,width=4,height=4,units="in",scale=1)
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown:::serve_site()
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
#Dataset = 736,553 observations, downloaded 11 May 2019
dwd.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//DWM_COARSE_WOODY_DEBRIS.csv')
plot.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//PLOT.csv')
plot.raw<-plot.raw %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV)
dwd<-merge(dwd.raw,plot.raw,by=c("STATECD","COUNTYCD","PLOT","INVYR"))
dwd<-dwd %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV,SUBP,TRANSECT,CWDID,MEASYEAR,CONDID,SLOPDIST,HORIZ_DIST, SPCD,DECAYCD,TRANSDIA,SMALLDIA,LARGEDIA,LENGTH,HOLLOWCD,CWDHSTCD,ECOSUBCD,LAT,LON,ELEV)
dwd<-mutate(dwd, ECOSUB = substr(ECOSUBCD,2,4))
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c("33A"),"333",dwd$ECOSUB)
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c(""),"999",dwd$ECOSUB)
dwd.eco<-dwd %>%
group_by(ECOSUB)%>%
summarize(n=n())
dwd.eco
#Woodall et al. parameters
#Woodall CW, Westfall JA, Lutes DC, Oswalt SN (2008).
#End-point diameter and total length coarse woody debris models for the United States.
#For Ecol Manage 255:3700-3706
#Some ecogerions do not have parameters listed in Woodall et al.
#For these, parameters for a similar ecogerion were used:
#211 = 212
#223 = 221
#241 = 242
#411 = 255
#999 = average of parameters from all others
parm<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//dwdparms.csv')
#Read in species dataset to get major species group codes
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
spp<-spp %>%
select(SPCD,MAJOR_SPGRPCD,SFTWD_HRDWD,COMMON_NAME)
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,999,dwd2$SPCD)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
# Chunk 3
dwd.spp<-dwd3 %>%
group_by(COMMON_NAME)%>%
summarize(n=n())
dwd.spp$pct<-(dwd.spp$n/sum(dwd.spp$n)*100)
# Chunk 4
dwd3$SPGR<-ifelse(dwd3$SFTWD_HRDWD=="S","Sftwd","Hwd")
dwd3$SPGR<-ifelse(dwd3$ECOSUB %in% c(251,411,255,333,999),"All", dwd3$SPGR)
dwd4<-merge(dwd3,parm,by=c("ECOSUB","SPGR"))
# Chunk 5
dwd5<-dwd4 %>%
mutate(ELEV_m=ELEV*0.0348,
SLOPDIST_m=SLOPDIST*0.3048,
HORIZ_DIST_m=HORIZ_DIST*0.3048,
TRANSDIA_cm=TRANSDIA*2.54,
SMALLDIA_cm=SMALLDIA*2.54,
LARGEDIA_cm=LARGEDIA*2.54,
LENGTH_m=LENGTH*0.3048)
# Chunk 6
DIAM.hat<-function(b0,b1,b2,b3,DT,DC){
DIAM.hat=b0+(b1*DT)+(b2*DC)+(b3*(DT*DC))
return(DIAM.hat)
}
LTH.hat<-function(b0,b1,b2,b3,DS.hat,DL.hat,DC){
LTH.hat=b0+(b1*DS.hat)+(b2*DL.hat)+(b3*DC)
return(LTH.hat)
}
dwd5$DL.hat.woodall<-DIAM.hat(b0=dwd5$b0_ld,b1=dwd5$b1_ld,b2=dwd5$b2_ld,b3=dwd5$b3_ld,
DT=dwd5$TRANSDIA_cm,DC=dwd5$DECAYCD)
dwd5$DS.hat.woodall<-DIAM.hat(b0=dwd5$b0_sd,b1=dwd5$b1_sd,b2=dwd5$b2_sd,b3=dwd5$b3_sd,
DT=dwd5$TRANSDIA_cm,DC=dwd5$DECAYCD)
dwd5$LTH.hat.woodall<-LTH.hat(b0=dwd5$b0_lth,b1=dwd5$b1_lth,b2=dwd5$b2_lth,b3=dwd5$b3_lth,
DS.hat=dwd5$DS.hat.woodall,DL.hat=dwd5$DL.hat.woodall,DC=dwd5$DECAYCD)
# Chunk 7
p.DL<-ggplot(dwd5,aes(y=DL.hat.woodall,x=LARGEDIA_cm))+geom_point()+stat_smooth()+
xlab("Observed DL")+
ylab("Predicted DL from Woodall")+
theme(panel.background = element_rect(fill = "NA"))
#p.DL
p.DS<-ggplot(dwd5,aes(y=DS.hat.woodall,x=SMALLDIA_cm))+geom_point()+stat_smooth()+
xlab("Observed DS")+
ylab("Predicted DS from Woodall")+
theme(panel.background = element_rect(fill = "NA"))
#p.DS
p.LTH<-ggplot(dwd5,aes(y=LTH.hat.woodall,x=LENGTH_m))+geom_point()+stat_smooth()+
xlab("Observed length")+
ylab("Predicted length from Woodall")+
theme(panel.background = element_rect(fill = "NA"))
#p.LTH
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//Analysis//p.DL.png", plot=p.DL,width=4,height=4,units="in",scale=1)
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//Analysis//p.DS.png", plot=p.DS,width=4,height=4,units="in",scale=1)
ggsave(filename = "C://Users//russellm//Documents//Projects//DWDModels//Analysis//p.LTH.png", plot=p.LTH,width=4,height=4,units="in",scale=1)
p.DSDT<-ggplot(dwd5,aes(y=SMALLDIA_cm,x=TRANSDIA_cm))+geom_point()+stat_smooth()+
xlab("Transect diameter (cm)")+
ylab("Small-end diameter (cm)")+
theme(panel.background = element_rect(fill = "NA"))
p.DSDT
#p.DS
p.DSDT<-ggplot(dwd5,aes(y=SMALLDIA_cm,x=TRANSDIA_cm))+geom_point()+stat_smooth()+
xlab("Transect diameter (cm)")+
ylab("Small-end diameter (cm)")+
theme(panel.background = element_rect(fill = "NA"))
p.DSDT
p.DLDT<-ggplot(dwd5,aes(y=LARGEDIA_cm,x=TRANSDIA_cm))+geom_point()+stat_smooth()+
xlab("Transect diameter (cm)")+
ylab("Large-end diameter (cm)")+
theme(panel.background = element_rect(fill = "NA"))
p.DLDT
p.LTHDT<-ggplot(dwd5,aes(y=LENGTH_m,x=TRANSDIA_cm))+geom_point()+stat_smooth()+
xlab("Transect diameter (cm)")+
ylab("Length (m)")+
theme(panel.background = element_rect(fill = "NA"))
p.LTHDT
head(dwd5)
DL_hat <- LARGEDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
DS_hat <- SMALLDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
LTH_hat <- SMALLDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
system.ols.linear <- list(LARGEDIA=DL_hat,SMALLDIA=DS_hat,LENGTH=LTH_hat)
## OLS estimation
fit.ols.linear <- systemfit(system.ols.linear, data=dwd5)
print(fit.ols.linear)
install.packages("systemfit")
library(systemfit)
DL_hat <- LARGEDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
DS_hat <- SMALLDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
LTH_hat <- SMALLDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
system.ols.linear <- list(LARGEDIA=DL_hat,SMALLDIA=DS_hat,LENGTH=LTH_hat)
## OLS estimation
fit.ols.linear <- systemfit(system.ols.linear, data=dwd5)
print(fit.ols.linear)
fit.ols.linear
fit.ols.linear$coefCov
fit.ols.linear$call
fit.ols.linear$rank
fit.ols.linear$iter
fit.ols.linear$residCov
fit.ols.linear$residCovEst
fit.sur.linear <- systemfit(system.sur.linear, data=dwd5,method="SUR")
print(fit.sur.linear)
fit.sur.linear$rank
install.packages("nlsystemfit")
###SUR estimation
fit.sur.linear <- systemfit(system.sur.linear, data=dwd5,method="SUR")
system.linear <- list(LARGEDIA=DL_hat,SMALLDIA=DS_hat,LENGTH=LTH_hat)
fit.sur.linear <- systemfit(system.linear, data=dwd5,method="SUR")
print(fit.sur.linear)
fit.sur.linear <- systemfit(system.linear, data=dwd5,method="OLS")
fit.ols.linear <- systemfit(system.ols.linear, data=dwd5)
View(fit.ols.linear)
fit.ols.linear[["residCov"]]
fit.ols.linear[["coefficients"]]
fit.ols.linear[["coefCov"]]
fit.ols.linear[["panelLike"]]
system.linear <- list(LARGEDIA=DL_hat,SMALLDIA=DS_hat,LENGTH=LTH_hat)
## OLS estimation
fit.ols.linear <- systemfit(system.linear, data=dwd5)
print(fit.ols.linear)
###SUR estimation
fit.sur.linear <- systemfit(system.linear, data=dwd5,method="OLS")
print(fit.sur.linear)
fit.sur.linear <- systemfit(system.linear, data=dwd5,method="SUR")
print(fit.sur.linear)
DL_hat <- LARGEDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
DS_hat <- SMALLDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
LTH_hat <- LENGTH_m ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
system.linear <- list(LARGEDIA=DL_hat,SMALLDIA=DS_hat,LENGTH=LTH_hat)
## OLS estimation
fit.ols.linear <- systemfit(system.linear, data=dwd5)
print(fit.ols.linear)
fit.sur.linear <- systemfit(system.linear, data=dwd5,method="SUR")
print(fit.sur.linear)
et al. models
```{r}
DL_hat <- LARGEDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
DS_hat <- SMALLDIA_cm ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
LTH_hat <- LENGTH_m ~ TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)
system.linear <- list(LARGEDIA=DL_hat,SMALLDIA=DS_hat,LENGTH=LTH_hat)
## OLS estimation
fit.ols.linear <- systemfit(system.linear, data=dwd5)
print(fit.ols.linear)
## SUR estimation
fit.sur.linear <- systemfit(system.linear, data=dwd5,method="SUR")
print(fit.sur.linear)
DL_hat <- LARGEDIA_cm ~ exp(a0+a1*TRANSDIA_cm + a2*DECAYCD + a3*(TRANSDIA_cm*DECAYCD))
DS_hat <- SMALLDIA_cm ~ exp(b0+b1*TRANSDIA_cm + b2*DECAYCD + b3*(TRANSDIA_cm*DECAYCD))
LTH_hat <- LENGTH_m ~ exp(c0+c1*TRANSDIA_cm + c2*DECAYCD + c3*(TRANSDIA_cm*DECAYCD))
system.nonlinear <- list(DL_hat,DS_hat,LTH_hat)
DL_hat <- LARGEDIA_cm ~ exp(a0+a1*TRANSDIA_cm + a2*DECAYCD + a3*(TRANSDIA_cm*DECAYCD))
DS_hat <- SMALLDIA_cm ~ exp(b0+b1*TRANSDIA_cm + b2*DECAYCD + b3*(TRANSDIA_cm*DECAYCD))
LTH_hat <- LENGTH_m ~ exp(c0+c1*TRANSDIA_cm + c2*DECAYCD + c3*(TRANSDIA_cm*DECAYCD))
system.nonlinear <- list(DL_hat,DS_hat,LTH_hat)
labels <- list( "Small-end diameter", "Large-end diameter", "Length" )
start.values <- c(a0=0, a1=0, a2=0, a3=0,
b0=0, b1=0, b2=0, b3=0,
c0=0, c1=0, c2=0, c3=0)
model.ols <- nlsystemfit( "OLS", system.nonlinear, start.values, data=dwd5, eqnlabels=labels )
print( model.ols )
model.ols <- nlsystemfit( "SUR", system.nonlinear, start.values, data=dwd5, eqnlabels=labels )
print( model.ols )
system.nonlinear <- list(DL_hat,DS_hat,LTH_hat)
labels <- list( "Small-end diameter", "Large-end diameter", "Length" )
start.values <- c(a0=5, a1=1.1, a2=-1, a3=-0.1,
b0=3, b1=0.4, b2=-1, b3=0.2,
c0=4, c1=0.1, c2=0.1, c3=-0.5)
model.ols <- nlsystemfit( "OLS", system.nonlinear, start.values, data=dwd5, eqnlabels=labels )
print( model.ols )
fit.sur.linear <- systemfit(system.linear, data=dwd5,method="SUR")
print(fit.sur.linear)
summary(fit.ols.linear)
summary(fit.sur.linear)
fit.ols.linear <- systemfit(system.linear, data=dwd5)
summary(fit.ols.linear)
summary(fit.ols.linear)
library(nlme)
DL.gnls = gnls(LARGEDIA_cm~exp(TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)),
data = dwd5,
start=c(a0=5, a1=1.1, a2=-1, a3=-0.1),
weights=varPower(0.2,form=~TRANSDIA_cm),
na.action=na.omit,
control=gnlsControl(maxIter=100,minScale=0.01,returnObject=T))
summary(DL.gnls)
summary(fit.ols.linear)
head(dwd5)
DL.nlme = nlme(LARGEDIA_cm~exp(TRANSDIA_cm + DECAYCD + (TRANSDIA_cm * DECAYCD)),
data = dwd5,
start=c(a0=5, a1=1.1, a2=-1, a3=-0.1),
weights=varPower(0.2,form=~TRANSDIA_cm),
fixed=c(a0+a1+a2+a3~1),
random=a0~1|SPCD,
na.action=na.omit,
control=gnlsControl(maxIter=100,minScale=0.01,returnObject=T))
summary(DL.nlme)
furnival(DL.nlme)
plot(DL.nlme)
DL.gnls = gnls(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD + a3*(TRANSDIA_cm * DECAYCD)),
data = dwd5,
start=c(a0=5, a1=1.1, a2=-1, a3=-0.1),
weights=varPower(0.2,form=~TRANSDIA_cm),
na.action=na.omit,
control=gnlsControl(maxIter=100,minScale=0.01,returnObject=T))
summary(DL.gnls)
DL.gnls = gnls(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD + a3*(TRANSDIA_cm * DECAYCD)),
data = dwd5,
start=c(a0=5, a1=1.1, a2=-1, a3=-0.1),
weights=varPower(0.2,form=~TRANSDIA_cm),
na.action=na.omit,
control=gnlsControl(maxIter=10000,minScale=0.01,returnObject=T))
summary(DL.gnls)
DL.nlme = nlme(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD + a3*(TRANSDIA_cm * DECAYCD)),
data = dwd5,
start=c(a0=5, a1=1.1, a2=-1, a3=-0.1),
weights=varPower(0.2,form=~TRANSDIA_cm),
fixed=c(a0+a1+a2+a3~1),
random=a0~1|SPCD,
na.action=na.omit,
control=gnlsControl(maxIter=100,minScale=0.01,returnObject=T))
summary(DL.nlme)
#GNLS model
DL.gnls = gnls(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD),
data = dwd5,
start=c(a0=5, a1=1.1, a2=-1),
weights=varPower(0.2,form=~TRANSDIA_cm),
na.action=na.omit,
control=gnlsControl(maxIter=10000,minScale=0.01,returnObject=T))
summary(DL.gnls)
DL.gnls = gnls(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD),
data = dwd5,
start=c(a0=0, a1=0, a2=-1),
weights=varPower(0.2,form=~TRANSDIA_cm),
na.action=na.omit,
control=gnlsControl(maxIter=10000,minScale=0.01,returnObject=T))
summary(DL.gnls)
#GNLS model
DL.gnls = gnls(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD),
data = dwd5,
start=c(a0=0, a1=0, a2=-1),
weights=varPower(0.2,form=~TRANSDIA_cm),
na.action=na.omit,
control=gnlsControl(maxIter=10000,minScale=0.01,returnObject=T))
summary(DL.gnls)
DL.gnls = gnls(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD),
data = dwd5,
start=c(a0=7, a1=0.1, a2=-1.5),
weights=varPower(0.2,form=~TRANSDIA_cm),
na.action=na.omit,
control=gnlsControl(maxIter=10000,minScale=0.01,returnObject=T))
summary(DL.gnls)
DL.gnls = gnls(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD + a3*(TRANSDIA_cm * DECAYCD)),
data = dwd5,
start=c(a0=2.4746346 , a1=0.0247, a2=-0.0003,a3=0),
weights=varPower(0.2,form=~TRANSDIA_cm),
na.action=na.omit,
control=gnlsControl(maxIter=10000,minScale=0.01,returnObject=T))
summary(DL.gnls)
DL.nlme = nlme(LARGEDIA_cm~exp(a0+a1*TRANSDIA_cm + a2*DECAYCD + a3*(TRANSDIA_cm * DECAYCD)),
data = dwd5,
start=c(a0=2.4746346 , a1=0.0247, a2=-0.0003,a3=0),
weights=varPower(0.2,form=~TRANSDIA_cm),
fixed=c(a0+a1+a2+a3~1),
random=a0~1|SPCD,
na.action=na.omit,
control=gnlsControl(maxIter=100,minScale=0.01,returnObject=T))
summary(DL.nlme)
furnival(DL.nlme)
source('C://Users//russellm//Documents//Analyses//R Functions//furnival.r')
furnival(DL.nlme)
plot(DL.nlme)
summary(DL.gnls)
plot(DL.gnls)
plot(DL.gnls)
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::insert_image_addin()
blogdown:::serve_site()
blogdown:::serve_site()
turn<-plot.ci<-data.frame(Deliveries=c(160,166,348,387,367,360,336,150,319,385,362,388,357,146,309,392,367,253,359,204,342,372,316,364,343,140,330,353,386,363,348,142,273,314,302,312,315,118,284,320,314,277,161,112,202,164,196,200,211,110,164,182,191,188,195,153,70,114,47,23,27,21,5,2,1,2,9,10,18,18,9,44,44,31,41,4),
TurnTime=c(20.3,23.25301205,22.90517241,25.22997416,22.79564033,26.43888889,25.2827381,17.62,24.7492163,29.88831169,23.31491713,31.43041237,25.82913165,20.76712329,30.16828479,31.86734694,30.82833787,41.51383399,23.99442897,24.69117647,30.50584795,28.52150538,26.62025316,28.82967033,26.47813411,19.92142857,26.38787879,24.66572238,24.97668394,26.24242424,26.04885057,22.0915493,27.31135531,24.34076433,23.71192053,23.81089744,21.93968254,17.49152542,23.57042254,24.41875,24.10509554,26.69314079,21.14906832,18.05357143,23.00990099,22.4695122,24.1377551,22.815,23.16113744,19.27272727,26.39634146,23.6978022,20.09947644,21.47340426,22.63589744,22.81699346,25.14285714,27.00877193,25.19148936,24.73913043,24.96296296,27.04761905,29.8,19,29,34.5,26.33333333,22.8,21.38888889,22.94444444,15.66666667,16.18181818,15.95454545,16,15.29268293,17.25))
