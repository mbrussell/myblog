# Chunk 1
library(tidyverse)
library(broom)
# Read in climate datasets
# Source: https://mco.umaine.edu/climate/me_monthly/?cdiv_id=me&var_id=t2anom&mon_id=ann
tmin <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2min_table.csv", skip = 5) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="tmin") |>
group_by(Year) |>
summarize(avg_tmin = mean(tmin))
tavg <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2_table.csv", skip = 5)|>
select(Year, Dec, Jan, Feb) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="t") |>
group_by(Year) |>
summarize(avg_t = mean(t))
temps <- inner_join(tmin, tavg, by = "Year")
# Read in stumpabe data
# Source: "Stumpage reports": https://www.maine.gov/dacf/mfs/publications/annual_reports.html
stump <- read_csv("C:/Users/matt/Documents/Arbor/Data/me_saw_stumpage.csv") |>
filter(!(species %in% c("Mixed Hardwood", "Mixed Soft/Hardwood", "Mixed Softwoods",
"Other Hardwood", "Other Softwoods")))
# Inflation rates to convert to 2021 dollars
# Source: https://www.usinflationcalculator.com/
infl <- tibble(
Year = c(2000:2021),
infl_rate = c(57.4, 53.1, 50.6, 47.3, 43.4, 38.7, 34.4, 30.7, 25.9, 26.3, 24.3,
20.5, 18.0, 16.3, 14.5, 14.3, 12.9, 10.5, 7.9, 6.0, 4.7, 0)
)
stump_spp <- stump |>
group_by(species) |>
summarize(num_years = n(),
mean_savg = mean(savg))
stump_spp
stump <- stump |>
inner_join(infl, by = "Year") |>
mutate(savg_adj = savg + (savg*(infl_rate/100)),
smin_adj = smin + (smin*(infl_rate/100)),
smax_adj = smax + (smax*(infl_rate/100)))
stump
stump_temps <-inner_join(stump, temps, by = "Year")
stump_temps
library(tidymodels)
stump_temps %>%
nest(data = -species) %>%
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)), # S3 list-col
tidied = map(test, tidy)
) %>%
unnest(tidied) |>
arrange(p.value)
stump_temps %>%
nest(data = -species) %>%
mutate(
test = map(data, ~ cor.test(.x$avg_t, .x$savg_adj)), # S3 list-col
tidied = map(test, tidy)
) %>%
unnest(tidied) |>
arrange(p.value)
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj, col = species)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tavg <- ggplot(stump_temps, aes(x = avg_t, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tavg
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj, col = species)) +
geom_point() +
geom_smooth(method = "lm") +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj, col = species)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
```{r, echo = F, warnings = F, message = F}
library(tidyverse)
library(broom)
# Read in climate datasets
# Source: https://mco.umaine.edu/climate/me_monthly/?cdiv_id=me&var_id=t2anom&mon_id=ann
tmin <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2min_table.csv", skip = 5) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="tmin") |>
group_by(Year) |>
summarize(avg_tmin = mean(tmin))
tavg <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2_table.csv", skip = 5)|>
select(Year, Dec, Jan, Feb) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="t") |>
group_by(Year) |>
summarize(avg_t = mean(t))
temps <- inner_join(tmin, tavg, by = "Year")
# Read in stumpabe data
# Source: "Stumpage reports": https://www.maine.gov/dacf/mfs/publications/annual_reports.html
stump <- read_csv("C:/Users/matt/Documents/Arbor/Data/me_saw_stumpage.csv") |>
filter(!(species %in% c("Mixed Hardwood", "Mixed Soft/Hardwood", "Mixed Softwoods",
"Other Hardwood", "Other Softwoods")))
# Inflation rates to convert to 2021 dollars
# Source: https://www.usinflationcalculator.com/
infl <- tibble(
Year = c(2000:2021),
infl_rate = c(57.4, 53.1, 50.6, 47.3, 43.4, 38.7, 34.4, 30.7, 25.9, 26.3, 24.3,
20.5, 18.0, 16.3, 14.5, 14.3, 12.9, 10.5, 7.9, 6.0, 4.7, 0)
)
stump_spp <- stump |>
group_by(species) |>
summarize(num_years = n(),
mean_savg = mean(savg))
stump_spp
stump_spp
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm") +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
cor.test(stump_temps$Year, stump_temps$avg_tmin)
cor_temps <- cor.test(stump_temps$Year, stump_temps$avg_tmin)
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm") +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm") +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj, col = species)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
cor_stump <- cor.test(stump_temps$Year, stump_temps$savg_adj)
cor_stump
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage ($/per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm") +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office") +
theme_bw()
p_spp_year
cor_stump <- cor.test(stump_temps$Year, stump_temps$savg_adj)
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage ($/per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm", se = T) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage ($/per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm", se = T) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office") +
theme_bw()
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm", se = T) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage ($/per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj, col = Species)) +
geom_point() +
# geom_smooth(method = "lm", se = T) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage ($/per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj, col = species)) +
geom_point() +
# geom_smooth(method = "lm", se = T) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage ($/per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
cor_temps
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj, col = species)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tavg <- ggplot(stump_temps, aes(x = avg_t, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tavg
cor_temps <- cor.test(stump_temps$Year, stump_temps$avg_tmin)
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm", se = T) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office") +
theme_bw()
p_spp_year
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
cor_stump_temps  <- stump_temps %>%
nest(data = -species) %>%
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)), # S3 list-col
tidied = map(test, tidy)
) %>%
unnest(tidied) |>
arrange(p.value)
cor_stump_temps
cor_stump_temps
cor_stump_temps <- cor_stump_temps |>
rename(`Pearson correlation` = estimate,
`P-value` = p.value,
Species = species) |>
select(Species, `Pearson correlation`, `P-value`)
cor_stump_temps
library(knitr)
library(formattable)
library(kableExtra)
install.packages("formattable")
library(formattable)
cor_stump_temps %>%
kable("html", caption = 'Number of PPP loans offered to logging businesses in Lake States cities.') %>%
kable_styling()
cor_stump_temps %>%
kable("html", caption = 'Pearson correlation coefficients bewteen stumpage price for sawlog species and minimum winter temperatures in Maine, 2000-2021.') %>%
kable_styling()
cor_stump_temps <- cor_stump_temps |>
rename(`Pearson correlation` = estimate,
`P-value` = p.value,
`Sawtimber species` = species) |>
select(Species, `Pearson correlation`, `P-value`)
cor_stump_temps %>%
kable("html", caption = 'Pearson correlation coefficients bewteen stumpage price for sawlog species and minimum winter temperatures in Maine, 2000-2021.') %>%
kable_styling()
cor_stump_temps <- cor_stump_temps |>
rename(`Pearson correlation` = estimate,
`P-value` = p.value,
`Sawtimber species` = species) |>
select(`Sawtimber species`, `Pearson correlation`, `P-value`)
cor_stump_temps %>%
kable("html", caption = 'Pearson correlation coefficients bewteen stumpage price for sawlog species and minimum winter temperatures in Maine, 2000-2021.') %>%
kable_styling()
# Chunk 1
library(tidyverse)
library(broom)
library(knitr)
library(formattable)
library(kableExtra)
# Chunk 2
# Read in climate datasets
# Source: https://mco.umaine.edu/climate/me_monthly/?cdiv_id=me&var_id=t2anom&mon_id=ann
tmin <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2min_table.csv", skip = 5) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="tmin") |>
group_by(Year) |>
summarize(avg_tmin = mean(tmin))
tavg <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2_table.csv", skip = 5)|>
select(Year, Dec, Jan, Feb) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="t") |>
group_by(Year) |>
summarize(avg_t = mean(t))
temps <- inner_join(tmin, tavg, by = "Year")
# Read in stumpabe data
# Source: "Stumpage reports": https://www.maine.gov/dacf/mfs/publications/annual_reports.html
stump <- read_csv("C:/Users/matt/Documents/Arbor/Data/me_saw_stumpage.csv") |>
filter(!(species %in% c("Mixed Hardwood", "Mixed Soft/Hardwood", "Mixed Softwoods",
"Other Hardwood", "Other Softwoods")))
# Inflation rates to convert to 2021 dollars
# Source: https://www.usinflationcalculator.com/
infl <- tibble(
Year = c(2000:2021),
infl_rate = c(57.4, 53.1, 50.6, 47.3, 43.4, 38.7, 34.4, 30.7, 25.9, 26.3, 24.3,
20.5, 18.0, 16.3, 14.5, 14.3, 12.9, 10.5, 7.9, 6.0, 4.7, 0)
)
# Chunk 3
stump_spp <- stump |>
group_by(species) |>
summarize(num_years = n(),
mean_savg = mean(savg))
# Chunk 4
stump <- stump |>
inner_join(infl, by = "Year") |>
mutate(savg_adj = savg + (savg*(infl_rate/100)),
smin_adj = smin + (smin*(infl_rate/100)),
smax_adj = smax + (smax*(infl_rate/100)))
# Chunk 5
stump_temps <-inner_join(stump, temps, by = "Year")
# Chunk 6
library(tidymodels)
cor_stump_temps  <- stump_temps %>%
nest(data = -species) %>%
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)), # S3 list-col
tidied = map(test, tidy)
) %>%
unnest(tidied) |>
arrange(p.value)
# stump_temps %>%
#   nest(data = -species) %>%
#   mutate(
#     test = map(data, ~ cor.test(.x$avg_t, .x$savg_adj)), # S3 list-col
#     tidied = map(test, tidy)
#   ) %>%
#   unnest(tidied) |>
#   arrange(p.value)
# Chunk 7
cor_temps <- cor.test(stump_temps$Year, stump_temps$avg_tmin)
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm", se = T) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office") +
theme_bw()
p_spp_year
# Chunk 8
cor_stump <- cor.test(stump_temps$Year, stump_temps$savg_adj)
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj, col = species)) +
geom_point() +
# geom_smooth(method = "lm", se = T) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage ($/per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
# Chunk 9
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
# Chunk 10
cor_stump_temps <- cor_stump_temps |>
rename(`Pearson correlation` = estimate,
`P-value` = p.value,
`Sawtimber species` = species) |>
select(`Sawtimber species`, `Pearson correlation`, `P-value`)
cor_stump_temps %>%
kable("html", caption = 'Pearson correlation coefficients bewteen stumpage price for sawlog species and minimum winter temperatures in Maine, 2000-2021.') %>%
kable_styling()
p_spp_tavg <- ggplot(stump_temps, aes(x = avg_t, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tavg
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
