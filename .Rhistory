# Calculate averages by loan size
mean_ppp_size <- ppp %>%
group_by(LoanSize) %>%
summarize(`Num loans` = n(),
`Total approved value (USD, millions)`= sum(InitialApprovalAmount)/1000000) %>%
mutate(`Percent of approved loans` = round((prop.table(`Num loans`)*100), 1),
`Percent of approved value` = round((prop.table(`Total approved value (USD, millions)`)*100), 1),
`Total approved value (USD, millions)` = round(`Total approved value (USD, millions)`, 1),
`Loan size (USD)` = as.character(LoanSize),
LoanSizeRank = ifelse(`Loan size (USD)`== "< 50K", 1,
ifelse(`Loan size (USD)`== "50K - 100K", 2,
ifelse(`Loan size (USD)`== "100K - 150K", 3,
ifelse(`Loan size (USD)`== "150K - 350K", 4,
ifelse(`Loan size (USD)`== "350K - 1M", 4,
ifelse(`Loan size (USD)`== "1M - 2M", 5,
ifelse(`Loan size (USD)`== "2M - 5M", 6,
7)))))))) %>%
# arrange(LoanSizeRank) %>%
arrange(LoanSizeRank) %>%
select(`Loan size (USD)`, `Num loans`, `Total approved value (USD, millions)`,
`Percent of approved loans`, `Percent of approved value`)
mean_ppp_size
21622/21622+4879+2332+3598+2139+587+156+161
21622/(21622+4879+2332+3598+2139+587+156+161)
(1213+816+481+337)/(1213+816+481+337+386+351+288+823)
# Make industry  table with loan amounts
mean_ppp_name <- ppp %>%
group_by(NAICSName) %>%
summarize(`Num loans` = n(),
`Avg loan value (USD)` = mean(InitialApprovalAmount),
`Total loan value (USD, millions)` = sum(InitialApprovalAmount)/1000000,
`Avg num jobs` = mean(JobsReported, na.rm=T),
`Total num jobs` = sum(JobsReported, na.rm=T)) %>%
arrange(desc(`Total num jobs`)) %>%
mutate(Industry = NAICSName,
`Avg loan value (USD)` = round(`Avg loan value (USD)`, 0),
`Total loan value (USD, millions)`= round(`Total loan value (USD, millions)`, 1),
`Avg num jobs` = round(`Avg num jobs`, 1)) %>%
select(Industry, `Num loans`, `Avg loan value (USD)`, `Total loan value (USD, millions)`,
`Avg num jobs`, `Total num jobs`)
mean_ppp_name
sum(mean_ppp_name$`Total num jobs`)
mean_ppp_name %>%
kable("html", format.args = list(big.mark = ","), escape = F,
caption = 'Mean value and number of jobs supported by PPP loans provided to forest products companies by NAICS industry categories.') %>%
kable_styling()
# Make state choropleth map with loan amounts
mean_ppp_state <- ppp %>%
group_by(BorrowerState) %>%
summarize(n_loans = n(),
mean_loan_initial = mean(InitialApprovalAmount),
sum_loan_initial = sum(InitialApprovalAmount),
mean_jobs = mean(JobsReported, na.rm=T),
sum_jobs = sum(JobsReported, na.rm=T)) %>%
mutate( state_abbv = BorrowerState,
state = BorrowerState) %>%
arrange(desc(sum_loan_initial))
# Make state choropleth map with loan amounts
mean_ppp_state <- ppp %>%
group_by(BorrowerState) %>%
summarize(n_loans = n(),
mean_loan_initial = mean(InitialApprovalAmount),
sum_loan_initial = sum(InitialApprovalAmount),
mean_jobs = mean(JobsReported, na.rm=T),
sum_jobs = sum(JobsReported, na.rm=T)) %>%
mutate( state_abbv = BorrowerState,
state = BorrowerState) %>%
arrange(desc(sum_loan_initial))
#mean_ppp_state
fips_cd <- fips_codes %>%
group_by(state) %>%
summarize(fips_code = max(state_code))
#fips_cd
mean_ppp_state <- inner_join(mean_ppp_state, fips_cd) %>%
mutate(state_fips = fips_code)
spatial_data <- left_join(get_urbn_map(map = "states", sf = TRUE),
statedata,
by = "state_name")
mean_ppp_state <- inner_join(mean_ppp_state, spatial_data)
mean_ppp_state <- left_join(mean_ppp_state, states, by = "state_name")
p.amt <-  ggplot(mean_ppp_state, mapping = aes(long, lat, group = group,
fill = sum_loan_initial/1000000)) +
geom_polygon(color = "black", size = 0.25) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_gradient(name="Total PPP \nloan amount \n($USD, millions)", low="white", high="brown") +
labs(title = "PPP loans to forest products industries") +
theme(panel.background = element_rect(fill = "NA"),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
legend.position = c(0.9, 0.4))
p.amt
# Make table by State and loan amount
mean_ppp_state <- ppp %>%
group_by(BorrowerState) %>%
summarize(`Num loans` = n(),
`Avg loan value (USD)` = mean(InitialApprovalAmount),
`Total loan value (USD, millions)` = sum(InitialApprovalAmount)/1000000,
`Avg num jobs` = mean(JobsReported, na.rm=T),
`Total num jobs` = sum(JobsReported, na.rm=T)) %>%
arrange(BorrowerState) %>%
# arrange(`Total loan value ($USD, millions)`) %>%
mutate(State = BorrowerState,
`Avg loan value (USD)` = round(`Avg loan value (USD)`, 0),
`Total loan value (USD, millions)`= round(`Total loan value (USD, millions)`, 1),
`Avg num jobs` = round(`Avg num jobs`, 1)) %>%
select(State, `Num loans`, `Avg loan value (USD)`, `Total loan value (USD, millions)`,
`Avg num jobs`, `Total num jobs`) %>%
filter(State != "NA")
#mean_ppp_state
fips_codes_state <- fips_codes %>%
distinct(state, state_name)
#fips_codes_state
mean_ppp_state <- mean_ppp_state %>%
mutate(state = State) %>%
inner_join(fips_codes_state)
mean_ppp_state <- mean_ppp_state %>%
rename(`State name` = state_name) %>%
select(`State name`, `Num loans`, `Avg loan value (USD)`, `Total loan value (USD, millions)`,
`Avg num jobs`, `Total num jobs`)
mean_ppp_state %>%
kable("html", format.args = list(big.mark = ","), escape = F,
caption = 'Mean value and number of jobs supported by PPP loans provided to forest products companies in each state.') %>%
kable_styling()
View(mean_ppp_state)
sum(mean_ppp_name$`Total num jobs`)
sum(ppp$InitialApprovalAmount)
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown::stop_server()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown::stop_server()
blogdown:::serve_site()
5.14+4.12+2.19+2.23
blogdown:::new_post_addin()
blogdown:::serve_site()
583.3+108.5+129.8
blogdown:::new_post_addin()
library(tidyverse)
library(knitr)
library(kableExtra)
price <- tribble(
~State/Region, ~Price ($/acre),	~Study,	~Notes,
"Vermont",	"$5 to $15",	"White et al. 2018", "Responses from a mail survey to landowners in the state’s Current Use Program.",
"Texas",	"$20 to $27",	"Simpson and Li 2010", "Values range from being willing to accept a five-year contract versus a conservation easement.",
"Southeastern US",	"$4 to $49",	"Tanger et al. 2021", "Payment rates vary depending on four treatments including different ages at thinning and final harvest.",
"Florida",	"$20 to $30",	"Soto et al. 2016", "Conclusion that amount would have significantly stronger impacts on enrollment than $5 or $10.",
"Lake States",	"$18 to $28",	"Miller et al. 2012", "$18 payment required to generate 50% participation rate. $28 payment for survey respondents that expressed a high certainty in their response to a valuation question."
)
price <- tribble(
~State/Region, ~`Price ($/acre)`,	~Study,	~Notes,
"Vermont",	"$5 to $15",	"White et al. 2018", "Responses from a mail survey to landowners in the state’s Current Use Program.",
"Texas",	"$20 to $27",	"Simpson and Li 2010", "Values range from being willing to accept a five-year contract versus a conservation easement.",
"Southeastern US",	"$4 to $49",	"Tanger et al. 2021", "Payment rates vary depending on four treatments including different ages at thinning and final harvest.",
"Florida",	"$20 to $30",	"Soto et al. 2016", "Conclusion that amount would have significantly stronger impacts on enrollment than $5 or $10.",
"Lake States",	"$18 to $28",	"Miller et al. 2012", "$18 payment required to generate 50% participation rate. $28 payment for survey respondents that expressed a high certainty in their response to a valuation question."
)
price <- tibble(
~State/Region, ~`Price ($/acre)`,	~Study,	~Notes,
"Vermont",	"$5 to $15",	"White et al. 2018", "Responses from a mail survey to landowners in the state’s Current Use Program.",
"Texas",	"$20 to $27",	"Simpson and Li 2010", "Values range from being willing to accept a five-year contract versus a conservation easement.",
"Southeastern US",	"$4 to $49",	"Tanger et al. 2021", "Payment rates vary depending on four treatments including different ages at thinning and final harvest.",
"Florida",	"$20 to $30",	"Soto et al. 2016", "Conclusion that amount would have significantly stronger impacts on enrollment than $5 or $10.",
"Lake States",	"$18 to $28",	"Miller et al. 2012", "$18 payment required to generate 50% participation rate. $28 payment for survey respondents that expressed a high certainty in their response to a valuation question."
)
price <- tibble(
~`State/Region`, ~`Price ($/acre)`,	~Study,	~Notes,
"Vermont",	"$5 to $15",	"White et al. 2018", "Responses from a mail survey to landowners in the state’s Current Use Program.",
"Texas",	"$20 to $27",	"Simpson and Li 2010", "Values range from being willing to accept a five-year contract versus a conservation easement.",
"Southeastern US",	"$4 to $49",	"Tanger et al. 2021", "Payment rates vary depending on four treatments including different ages at thinning and final harvest.",
"Florida",	"$20 to $30",	"Soto et al. 2016", "Conclusion that amount would have significantly stronger impacts on enrollment than $5 or $10.",
"Lake States",	"$18 to $28",	"Miller et al. 2012", "$18 payment required to generate 50% participation rate. $28 payment for survey respondents that expressed a high certainty in their response to a valuation question."
)
price <- tribble(
~`State/Region`, ~`Price ($/acre)`,	~Study,	~Notes,
"Vermont",	"$5 to $15",	"White et al. 2018", "Responses from a mail survey to landowners in the state’s Current Use Program.",
"Texas",	"$20 to $27",	"Simpson and Li 2010", "Values range from being willing to accept a five-year contract versus a conservation easement.",
"Southeastern US",	"$4 to $49",	"Tanger et al. 2021", "Payment rates vary depending on four treatments including different ages at thinning and final harvest.",
"Florida",	"$20 to $30",	"Soto et al. 2016", "Conclusion that amount would have significantly stronger impacts on enrollment than $5 or $10.",
"Lake States",	"$18 to $28",	"Miller et al. 2012", "$18 payment required to generate 50% participation rate. $28 payment for survey respondents that expressed a high certainty in their response to a valuation question."
)
price
blogdown:::serve_site()
blogdown:::new_post_addin()
# Chunk 1
knitr::opts_chunk$set(
echo = F, message = F, warning = F
)
# Chunk 2
my_REGION = "NE"
my_REGION_name = "Northeast"
my_STATE = "Maine"
my_STATE_abbr = "ME"
options(scipen=10000)
library(tidyverse)
library(knitr)
library(patchwork)
library(GGally)
library(rgdal)
library(usmap)
library(googlesheets4)
#trends <- read_sheet("https://docs.google.com/spreadsheets/d/1nTja9uSdwLoDNFpbLsUJIHdEKWEsZp2Jo_MKTKXGXh0/edit?usp=sharing")
trends <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/trends.csv')
trends_state <- trends %>%
group_by(State) %>%
summarize(min_C = first(C_MMT),
max_C = last(C_MMT))
trends_state <- trends_state %>%
mutate(pct_change = ((max_C - min_C)/min_C) * 100)
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep="")) %>%
filter(State == my_STATE_abbr)
trends_state
paste(my_STATE, "forest carbon stocks have increased by",
trends_state$pct_change_round_char,"from 1990 to 2019.")
trends_2017 <- trends %>%
filter(Year == 2017 & State == my_STATE_abbr)
paste("In", my_STATE, ", forests, urban trees, and harvested wood products remove",
round((trends_2017$Flux_MMTCO2 / trends_2017$Emissions_MMTCO2)*100, 0),
"% of all CO2 emissions in the state. Across the US, this value is 14%.")
paste("In", my_STATE, ", forests, urban trees, and harvested wood products store the equivalent of",
round(trends_2017$C_MMT / (trends_2017$Emissions_MMTCO2/3.667), 0),
"years of all CO2 emissions produced in the state.")
trends_new <- trends %>%
filter(StateName == my_STATE)
p.trends <- ggplot(trends_new, aes(Year, C_MMT)) +
geom_point() + geom_line() +
labs(x = "Year", y = "Forest ecosystem carbon\n(million metric tons)",
title = paste("Trends in", my_STATE)) +
scale_y_continuous(limits = c (min(trends_new$C_MMT)-(min(trends_new$C_MMT)*0.025),
max(trends_new$C_MMT)+(max(trends_new$C_MMT)*0.025))) +
scale_x_continuous(limits = c (1990, 2021)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom",
plot.margin = margin(0, 0, 0, 0, "cm")) +
guides(col = guide_legend(ncol = 2))
p.trends
#own <- read_sheet("https://docs.google.com/spreadsheets/d/1YrN9x5FOeqcXwdQ3Gw6HcoZfV0ZWSQrzkxVK6GmEN64/edit?usp=sharing")
own <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/own.csv')
p.own <- own %>%
mutate(C_MMT = C_MT/1000000) %>%
filter(StateName == my_STATE) %>%
ggplot(aes(reorder(Ownership, C_MMT), C_MMT, fill = C_MMT)) +
geom_bar(stat="identity") +
coord_flip() +
#scale_y_continuous(limits = c(0,16000)) +
labs(x = " ", y = "Carbon in live aboveground trees \n(million metric tons)",
title = paste("Carbon across", my_STATE_abbr, "ownerships"))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.position = "none",
#plot.margin = margin(0, 0, 0, 0, "cm")
)
p.own
own_mi<- own %>%
mutate(C_MMT = C_MT/1000000) %>%
filter(StateName == my_STATE)
own_mi
299/(299+28.1+3.59+1.69)
28.1/(299+28.1+3.59+1.69)
(3.59+1.69)/(299+28.1+3.59+1.69)
View(trends)
View(trends_state)
# Chunk 1
knitr::opts_chunk$set(
echo = F, message = F, warning = F
)
# Chunk 2
my_REGION = "NE"
my_REGION_name = "Northeast"
my_STATE = "Maine"
my_STATE_abbr = "ME"
options(scipen=10000)
# Chunk 3
library(tidyverse)
library(knitr)
library(patchwork)
library(GGally)
library(rgdal)
library(usmap)
library(googlesheets4)
# Chunk 4
#trends <- read_sheet("https://docs.google.com/spreadsheets/d/1nTja9uSdwLoDNFpbLsUJIHdEKWEsZp2Jo_MKTKXGXh0/edit?usp=sharing")
trends <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/trends.csv')
trends_state <- trends %>%
group_by(State) %>%
summarize(min_C = first(C_MMT),
max_C = last(C_MMT))
trends_state <- trends_state %>%
mutate(pct_change = ((max_C - min_C)/min_C) * 100)
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep="")) %>%
filter(State == my_STATE_abbr)
trends_state
paste(my_STATE, "forest carbon stocks have increased by",
trends_state$pct_change_round_char,"from 1990 to 2019.")
trends_2017 <- trends %>%
filter(Year == 2017 & State == my_STATE_abbr)
paste("In", my_STATE, ", forests, urban trees, and harvested wood products remove",
round((trends_2017$Flux_MMTCO2 / trends_2017$Emissions_MMTCO2)*100, 0),
"% of all CO2 emissions in the state. Across the US, this value is 14%.")
paste("In", my_STATE, ", forests, urban trees, and harvested wood products store the equivalent of",
round(trends_2017$C_MMT / (trends_2017$Emissions_MMTCO2/3.667), 0),
"years of all CO2 emissions produced in the state.")
trends_new <- trends %>%
filter(StateName == my_STATE)
p.trends <- ggplot(trends_new, aes(Year, C_MMT)) +
geom_point() + geom_line() +
labs(x = "Year", y = "Forest ecosystem carbon\n(million metric tons)",
title = paste("Trends in", my_STATE)) +
scale_y_continuous(limits = c (min(trends_new$C_MMT)-(min(trends_new$C_MMT)*0.025),
max(trends_new$C_MMT)+(max(trends_new$C_MMT)*0.025))) +
scale_x_continuous(limits = c (1990, 2021)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom",
plot.margin = margin(0, 0, 0, 0, "cm")) +
guides(col = guide_legend(ncol = 2))
p.trends
# Chunk 5
#own <- read_sheet("https://docs.google.com/spreadsheets/d/1YrN9x5FOeqcXwdQ3Gw6HcoZfV0ZWSQrzkxVK6GmEN64/edit?usp=sharing")
own <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/own.csv')
p.own <- own %>%
mutate(C_MMT = C_MT/1000000) %>%
filter(StateName == my_STATE) %>%
ggplot(aes(reorder(Ownership, C_MMT), C_MMT, fill = C_MMT)) +
geom_bar(stat="identity") +
coord_flip() +
#scale_y_continuous(limits = c(0,16000)) +
labs(x = " ", y = "Carbon in live aboveground trees \n(million metric tons)",
title = paste("Carbon across", my_STATE_abbr, "ownerships"))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.position = "none",
#plot.margin = margin(0, 0, 0, 0, "cm")
)
p.own
own_mi<- own %>%
mutate(C_MMT = C_MT/1000000) %>%
filter(StateName == my_STATE)
own_mi
# Chunk 6
#pools <- read_sheet("https://docs.google.com/spreadsheets/d/15jGuyx62Kdfcm3VzeDgfbhYGlxs3EvDEsd63QWVIPWM/edit?usp=sharing")
pools <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/pools.csv')
p.pool <- pools %>%
filter(StateName == my_STATE) %>%
ggplot(aes(reorder(Pool, C_MMT), C_MMT, fill = C_MMT)) +
geom_bar(stat="identity") +
coord_flip() +
#scale_y_continuous(limits = c(0,16000)) +
labs(x = " ", y = "Carbon stocks \n(million metric tons)",
title = paste("Carbon pools in", my_STATE_abbr, "forests")) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.position = "none",
#plot.margin = margin(0, 0, 0, 0, "cm")
)
p.pool
# Chunk 7
#storage <- read_sheet("https://docs.google.com/spreadsheets/d/1LfM2todi5uRGi88yhyh-5OypPT_Nl1FvgG-7Pv7WqZI/edit?usp=sharing")
storage <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/storage_state.csv')
storage_amt <- storage %>%
filter(State == my_STATE & ForestTypeGroup == "Total") %>%
mutate(Carbon_UStons = Total * 1.10)
paste("Average carbon density in aboveground trees across", my_STATE, "forests is",
round(storage_amt$Carbon_UStons, 1),"US tons per acre.")
storage_long <- storage %>%
filter(State == my_STATE & ForestTypeGroup == "Total") %>%
select(-Total) %>%
pivot_longer(`0`:`96-100`, names_to= "StandAge", values_to = "Carbon") %>%
mutate(Carbon_UStons = Carbon * 1.10)
# storage_type <- storage_long %>%
#   group_by(HdwdSfwd, StandAge) %>%
#   summarize(mean_Carbon_UStons = mean(Carbon_UStons, na.rm = T)) %>%
#   mutate(HdwdSfwd_name = ifelse(HdwdSfwd == "HW", "Hardwood forests", "Softwood forests"))
storage_type <- storage_long
storage_type$StandAge <- factor(storage_type$StandAge, levels = c("0", "0-5", "6-10", "11-15", "16-20",
"21-25", "26-30", "31-35", "36-40",
"41-45", "46-50", "51-55", "56-60",
"61-65", "66-70", "71-75", "76-80",
"81-85", "86-90", "91-95", "96-100"))
# write_csv(storage_type, "C://Users//russellm//Documents//c_storage_mn.csv")
p.storage <- ggplot(storage_type, aes(StandAge, Carbon_UStons)) +
geom_bar(stat="identity", col = "black", fill = "lightblue") +
scale_x_discrete(limits=storage_type$StandAge,breaks=storage_type$StandAge[seq(1,length(storage_type$StandAge),by=2)])+
labs(x = "Stand age (years)", y = "Average carbon storage \n(US tons per acre)",
title = paste("Carbon storage in", my_STATE_abbr))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
strip.text = element_text(size=10),
strip.background = element_rect(fill="white"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(size = 8, angle = 45, vjust = 0.5, color = "black"),
#plot.margin = margin(0, 0, 0, 0, "cm")
)
p.storage
# Chunk 8
sequest <- storage %>%
mutate(`0 ` = 0,
`0-5 ` = -1*(`0-5` / 5),
`6-10 ` = -1*((`6-10` - `0-5`) / 5),
`11-15 ` = -1*((`11-15` - `6-10`) / 5),
`16-20 ` = -1*((`16-20` - `11-15`) / 5),
`21-25 ` = -1*((`21-25` - `16-20`) / 5),
`26-30 ` = -1*((`26-30` - `21-25`) / 5),
`31-35 ` = -1*((`31-35` - `26-30`) / 5),
`36-40 ` = -1*((`36-40` - `31-35`) / 5),
`41-45 ` = -1*((`41-45` - `36-40`) / 5),
`46-50 ` = -1*((`46-50` - `41-45`) / 5),
`51-55 ` = -1*((`51-55` - `46-50`) / 5),
`56-60 ` = -1*((`56-60` - `51-55`) / 5),
`61-65 ` = -1*((`61-65` - `56-60`) / 5),
`66-70 ` = -1*((`66-70` - `61-65`) / 5),
`71-75 ` = -1*((`71-75` - `66-70`) / 5),
`76-80 ` = -1*((`76-80` - `71-75`) / 5),
`81-85 ` = -1*((`81-85` - `76-80`) / 5),
`86-90 ` = -1*((`86-90` - `81-85`) / 5),
`91-95 ` = -1*((`91-95` - `86-90`) / 5),
`96-100 ` = -1*((`96-100` - `91-95`) / 5))
sequest_long <- sequest %>%
filter(State == my_STATE & ForestTypeGroup == "Total") %>%
select(-c(Total, `0`:`96-100`)) %>%
pivot_longer(`0 `:`96-100 `, names_to= "StandAge", values_to = "Carbon") %>%
mutate(Carbon_UStons = Carbon * 1.10)
# sequest_type <- sequest_long %>%
#   group_by(HdwdSfwd, StandAge) %>%
#   summarize(mean_Carbon_UStons = mean(Carbon_UStons, na.rm = T)) %>%
#   mutate(HdwdSfwd_name = ifelse(HdwdSfwd == "HW", "Hardwood forests", "Softwood forests"))
sequest_type <- sequest_long
sequest_type$StandAge <- factor(sequest_type$StandAge, c("0 ", "0-5 ", "6-10 ", "11-15 ", "16-20 ",
"21-25 ", "26-30 ", "31-35 ", "36-40 ",
"41-45 ", "46-50 ", "51-55 ", "56-60 ",
"61-65 ", "66-70 ", "71-75 ", "76-80 ",
"81-85 ", "86-90 ", "91-95 ", "96-100 "))
sequest_type$StandAge_num <- 1:21
#write_csv(sequest_type, "C://Users//russellm//Documents//c_sequest_mn.csv")
p.sequest<- ggplot(sequest_type, aes(StandAge, Carbon_UStons, group = 1)) +
geom_point() +
stat_smooth(span = 1, se = F) +
scale_y_reverse() +
scale_x_discrete(limits=sequest_type$StandAge,breaks=sequest_type$StandAge[seq(1,length(sequest_type$StandAge),by=2)])+
labs(x = "Stand age (years)", y = "Average carbon sequestration \n(US tons per acre per year)",
title = paste("Carbon sequestration in", my_STATE_abbr))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
strip.text = element_text(size=10),
strip.background = element_rect(fill="white"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(size = 8, angle = 45, vjust = 0.5, color = "black"),
#plot.margin = margin(0, 0, 0, 0, "cm")
)
p.sequest
# Chunk 9
p.all <- (p.trends + (p.own/p.pool) ) /  (p.storage + p.sequest + plot_spacer())
p.all
# Chunk 10
library(usmap)
p.state <- plot_usmap(include = my_STATE_abbr, fill = "black")
p.state
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
library(blogdown)
blogdown:::serve_site()
update.packages("bookdown")
blogdown:::preview_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
install.packages("rmarkdown")
install.packages("rmarkdown")
install.packages("rmarkdown")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
blogdown:::serve_site()
blogdown:::serve_site()
