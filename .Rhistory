options(scipen=10000)
trends <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/trends.csv')
trends_state <- trends %>%
group_by(State) %>%
summarize(min_C = first(C_MMT),
max_C = last(C_MMT))
trends_state
trends
trends_state <- trends %>%
group_by(StateName) %>%
summarize(min_C = first(C_MMT),
max_C = last(C_MMT))
trends_state <- trends_state %>%
mutate(pct_change = ((max_C - min_C)/min_C) * 100)
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep=""))
trends_state
p.trends <- ggplot(trends_new, aes(StateName, pct_change)) +
geom_bar(stat = "identity") +
coord_flip()
p.trends <- ggplot(trends_state, aes(StateName, pct_change)) +
geom_bar(stat = "identity") +
coord_flip()
p.trends
p.trends <- ggplot(trends_state, aes(StateName, pct_change)) +
geom_bar(stat = "identity") +
coord_flip()
labs(x = "Percent change in forest carbon, 1990-2019",
y = "Forest ecosystem carbon\n(million metric tons)")
p.trends <- ggplot(trends_state, aes(StateName, pct_change)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(x = "Percent change in forest carbon, 1990-2019",
y = "Forest ecosystem carbon\n(million metric tons)")
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
scale_y_continuous(limits = c (min(trends_new$C_MMT)-(min(trends_new$C_MMT)*0.025),
max(trends_new$C_MMT)+(max(trends_new$C_MMT)*0.025))) +
scale_x_continuous(limits = c (1990, 2021)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom",
plot.margin = margin(0, 0, 0, 0, "cm")) +
guides(col = guide_legend(ncol = 2))
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
View(trends_state)
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep=""),
pct_change_color = ifelse(pct_change >= 0, 1, 0))
trends_state
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change)) +
geom_bar(stat = "identity", fill = pct_change_color) +
coord_flip() +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep=""),
pct_change_color = ifelse(pct_change >= 0, 1, 0))
trends_state
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change)) +
geom_bar(stat = "identity", fill = pct_change_color) +
coord_flip() +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change)) +
geom_bar(stat = "identity", col = pct_change_color) +
coord_flip() +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change)) +
geom_bar(stat = "identity", col = trends_state$pct_change_color) +
coord_flip() +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change)) +
geom_bar(stat = "identity", fill = trends_state$pct_change_color) +
coord_flip() +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep=""),
pct_change_color = ifelse(pct_change >= 0, "Pos", "Neg"))
trends_state
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change, color = pct_change_color)) +
geom_bar(stat = "identity") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen"))
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change, fill = pct_change_color)) +
geom_bar(stat = "identity") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen"))
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change, fill = pct_change_color)) +
geom_bar(stat = "identity") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change, fill = pct_change_color)) +
geom_bar(stat = "identity") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change,
fill = pct_change_color, col = black)) +
geom_bar(stat = "identity") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change,
fill = pct_change_color, col = "black")) +
geom_bar(stat = "identity") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change,
fill = pct_change_color, col = "black")) +
geom_bar(stat = "identity",  col = "black") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
# scale_y_continuous(limits = c (-50, 50)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change,
fill = pct_change_color, col = "black")) +
geom_bar(stat = "identity",  col = "black") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
scale_y_continuous(limits = c (-10, 55)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change,
fill = pct_change_color, col = "black")) +
geom_bar(stat = "identity",  col = "black") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
scale_y_continuous(limits = c (-15, 55)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change,
fill = pct_change_color, col = "black")) +
geom_bar(stat = "identity",  col = "black") +
coord_flip() +
scale_color_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
scale_y_continuous(limits = c (-20, 55)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change,
fill = pct_change_color, col = "black")) +
geom_bar(stat = "identity",  col = "black") +
coord_flip() +
scale_fill_manual(breaks = c("Pos", "Neg"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
scale_y_continuous(limits = c (-20, 55)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
p.trends <- ggplot(trends_state, aes(reorder(StateName, pct_change), pct_change,
fill = pct_change_color, col = "black")) +
geom_bar(stat = "identity",  col = "black") +
coord_flip() +
scale_fill_manual(breaks = c("Neg", "Pos"),
values=c("red", "darkgreen")) +
labs(y = "Percent change in forest carbon, 1990-2019",
x = " ") +
scale_y_continuous(limits = c (-20, 55)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none") +
guides(col = guide_legend(ncol = 2))
p.trends
trends_state
View(trends_state)
trends_state <- trends_state %>%
mutate(pct_change = ((max_C - min_C)/min_C) * 100,
change = ((max_C - min_C)/min_C))
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep=""),
pct_change_color = ifelse(pct_change >= 0, "Pos", "Neg"))
trends_state
trends <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/trends.csv')
trends_state <- trends %>%
group_by(StateName) %>%
summarize(min_C = first(C_MMT),
max_C = last(C_MMT))
trends_state <- trends_state %>%
mutate(pct_change = ((max_C - min_C)/min_C) * 100,
change = ((max_C - min_C)))
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep=""),
pct_change_color = ifelse(pct_change >= 0, "Pos", "Neg"))
trends_state
library(tidyverse)
library(knitr)
library(formattable)
library(kableExtra)
trends_state %>%
kable("html", caption = 'Trends in forest carbon stocks in 48 US states, 1990-2019.') %>%
kable_styling()
trends_state2 <- trends_state %>%
select(StateName, min_C, max_C, pct_change_round_char)
trends_state3 <- trends_state2 %>%
rename(State = StateName, `Forest carbon in 1990` = min_C,
`Forest carbon in 2019` = max_C,
`Percent change, 1990-2019` = pct_change_round_char)
trends_state3 %>%
kable("html", caption = 'Trends in forest carbon stocks in 48 US states, 1990-2019.') %>%
kable_styling()
trends_state3 %>%
arrange(`Percent change, 1990-2019`) %>%
kable("html", caption = 'Trends in forest carbon stocks in 48 US states, 1990-2019.') %>%
kable_styling()
trends_state2 <- trends_state %>%
select(StateName, min_C, max_C, pct_change_round_char)
trends_state3 <- trends_state2 %>%
rename(State = StateName, `Forest carbon in 1990` = min_C,
`Forest carbon in 2019` = max_C,
`Percent change, 1990-2019` = pct_change_round_char)
trends_state3 %>%
arrange(-`Percent change, 1990-2019`) %>%
kable("html", caption = 'Trends in forest carbon stocks in 48 US states, 1990-2019.') %>%
kable_styling()
trends_state2 <- trends_state %>%
arrange(pct_change) %>%
select(StateName, min_C, max_C, pct_change_round_char)
trends_state3 <- trends_state2 %>%
rename(State = StateName, `Forest carbon in 1990` = min_C,
`Forest carbon in 2019` = max_C,
`Percent change, 1990-2019` = pct_change_round_char)
trends_state3 %>%
kable("html", caption = 'Trends in forest carbon stocks in 48 US states, 1990-2019.') %>%
kable_styling()
trends_state2 <- trends_state %>%
arrange(-pct_change) %>%
select(StateName, min_C, max_C, pct_change_round_char)
trends_state3 <- trends_state2 %>%
rename(State = StateName, `Forest carbon in 1990` = min_C,
`Forest carbon in 2019 (MMT)` = max_C,
`Percent change, 1990-2019 (MMT)` = pct_change_round_char)
trends_state3 %>%
kable("html", caption = 'Trends in forest carbon stocks in 48 US states, 1990-2019.') %>%
kable_styling()
# Chunk 1
knitr::opts_chunk$set(
echo = F, message = F, warning = F
)
# Chunk 2
library(tidyverse)
library(knitr)
library(patchwork)
library(GGally)
library(rgdal)
library(usmap)
library(googlesheets4)
# Chunk 3
my_REGION = "US"
my_REGION_name = "United States"
options(scipen=10000)
# Chunk 4
#regions <- read_sheet("https://docs.google.com/spreadsheets/d/1xdnlltQsM1thqvLnLXCCkaI8yx3ePVpbblCIDi5e64E/edit?usp=sharing")
regions <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/regions.csv')
regions %>%
group_by(RegionName) %>%
summarize(n())
regions <- regions %>%
mutate(full = StateName) %>%
inner_join(statepop)
plot_usmap(data = regions, values = "RegionName", exclude = c("AK","HI")) +
theme(legend.position = "right")
# Chunk 5
#trends <- read_sheet("https://docs.google.com/spreadsheets/d/1nTja9uSdwLoDNFpbLsUJIHdEKWEsZp2Jo_MKTKXGXh0/edit?usp=sharing")
trends <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/trends.csv')
trends_region <- trends %>%
group_by(Year) %>%
summarize(sum_C_MMT = sum(C_MMT))
trends_region <- trends_region %>%
mutate(max_C = last(sum_C_MMT),
min_C = first(sum_C_MMT),
pct_change = ((max_C - min_C)/min_C) * 100)
trends_region <- trends_region %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep=""))
trends_region
paste(my_REGION_name, "forest carbon stocks have increased by",
trends_region$pct_change_round_char,"from 1990 to 2019.")
trends_2017 <- trends %>%
filter(Year == 2017) %>%
summarize(sum_C_MMT = sum(C_MMT),
sum_Flux_MMTCO2 = sum(Flux_MMTCO2),
sum_Emissions_MMTCO2 = sum(Emissions_MMTCO2))
paste("In", my_REGION_name, ", forests, urban trees, and harvested wood products remove",
round((trends_2017$sum_Flux_MMTCO2 / trends_2017$sum_Emissions_MMTCO2)*100, 0),
"% of all CO2 emissions in the state. Across the US, this value is 14%.")
paste("In", my_REGION_name, ", forests, urban trees, and harvested wood products store the equivalent of",
round(trends_2017$sum_C_MMT / (trends_2017$sum_Emissions_MMTCO2/3.667), 0),
"years of all CO2 emissions produced in the state.")
trends <- trends %>%
filter(Region == my_REGION)
p.trends <- ggplot(trends_region, aes(Year, sum_C_MMT)) +
geom_point() + geom_line() +
labs(x = "Year", y = "Forest ecosystem carbon\n(million metric tons)",
title = paste("Trends in", my_REGION_name, "forests")) +
scale_y_continuous(limits = c (min(trends_region$sum_C_MMT)-(min(trends_region$sum_C_MMT)*0.025),
max(trends_region$sum_C_MMT)+(max(trends_region$sum_C_MMT)*0.025))) +
scale_x_continuous(limits = c (1990, 2020)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.text = element_text(size = 7),
legend.key=element_blank(),
legend.position = "bottom",
plot.margin = margin(0, 0, 0, 0, "cm")) +
guides(col = guide_legend(ncol = 3))
p.trends
View(trends_region)
blogdown:::serve_site()
