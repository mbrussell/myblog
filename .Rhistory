theme(legend.position = "right",
legend.title = element_blank())
plot_usmap(data = deer, values = "Harvest_2017", lines = "red",
include = c("AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL",
"IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS",
"MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH",
"OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA",
"WA","WV","WI","WY"))+
scale_fill_continuous(low = "white", high = "red", name = "Harvest_2017", label = scales::comma) +
labs(title = "Number of deer harvested, 2017", subtitle = " ") +
theme(legend.position = "right",
legend.title = element_blank())
plot_usmap(data = deer, values = "DVA_Harvest", lines = "black",
include = c("AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL",
"IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS",
"MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH",
"OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA",
"WA","WV","WI","WY")) +
scale_fill_continuous(low = "white", high = "red", name = "DVA_Harvest", label = scales::comma) +
labs(title = "Percent of deer accidents relative to total deer harvest", subtitle = "dva per harvest") +
theme(legend.position = "right",
legend.title = element_blank())
plot_usmap(data = deer, values = "DVA_Harvest", lines = "black",
include = c("AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL",
"IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS",
"MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH",
"OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA",
"WA","WV","WI","WY")) +
scale_fill_continuous(low = "white", high = "red", name = "DVA_Harvest", label = scales::comma) +
labs(title = "Percent of deer-vehicle accidents relative to total deer harvest", subtitle = " ") +
theme(legend.position = "right",
legend.title = element_blank())
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::new_post_addin()
drdr [sss] (https://www.eforester.org/safconvention)
drdr [sss] ('https://www.eforester.org/safconvention')
blogdown:::new_post_addin()
blogdown:::serve_site()
# Chunk 1
# Read in libraries to use
library(gsheet)
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
library(tidyverse)
# Chunk 2
#devtools::install_github("SilviaTerra/forest_sampling")
library(forestsamplr)
# Chunk 3
tree<- gsheet2tbl('https://docs.google.com/spreadsheets/d/19XgWp2naizuqvSSr-DlJ0r-53IBgQd8X7yDx_KjkWWE/edit?usp=sharing')
# Select only the last year of measurement from each management unit
tree<-subset(tree, (MgmtUnit == 20 & Year==2008 & DBH >= 0) |
(MgmtUnit == 9 & Year==2013 & DBH >= 0) |
(MgmtUnit == 12 & Year==2014 & DBH >= 0) |
(MgmtUnit == 16 & Year==2012 & DBH >= 0))
#tree$MgmtUnit<-factor(tree$MgmtUnit)
tree$DBH<-as.numeric(tree$DBH)
# Chunk 4
#summarize data to calculate basal area
plot <- tree %>%
mutate(bapaTree = (DBH**2)*0.00545415*EXPF) %>%
group_by(MgmtUnit, Plot) %>%
summarize(BAPA = sum(bapaTree))
plot<-data.frame(plot)
plot$stratum<-plot$MgmtUnit
head(plot)
mgmtunit<-plot %>%
group_by(MgmtUnit) %>%
summarize(n_plots=n(),
mean_BAPA = mean(BAPA),
sd_BAPA = sd(BAPA))
mgmtunit
p.tree<-ggplot(tree,aes(MgmtUnit,DBH))+
xlab("Management unit")+
ylab("Tree diameter (inches)")+
theme(legend.position = "none",
panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.tree + geom_boxplot(outlier.colour="red",outlier.shape=8)
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA))+
xlab("Management unit")+
ylab("Tree diameter (inches)")+
theme(legend.position = "none",
panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.tree + geom_boxplot(outlier.colour="red",outlier.shape=8)
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA))+
xlab("Management unit")+
ylab("Tree diameter (inches)")+
theme(legend.position = "none",
panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.plot + geom_boxplot(outlier.colour="red",outlier.shape=8)
plot
mgmtunit
plot
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA,col=MgmtUnit))+
xlab("Management unit")+
ylab("Tree diameter (inches)")+
theme(legend.position = "none",
panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.plot + geom_boxplot(outlier.colour="red",outlier.shape=8)
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA,col=MgmtUnit))+
xlab("Management unit")+
ylab("Tree diameter (inches)")+
theme(legend.position = "none",
panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.plot + geom_violin(outlier.colour="red",outlier.shape=8)
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA,col=MgmtUnit))+
xlab("Management unit")+
ylab("Basal area (sq. ft per acre)")+
theme(legend.position = "none",
panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.plot + geom_violin(outlier.colour="red",outlier.shape=8)
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA,col=factor(MgmtUnit)))+
xlab("Management unit")+
ylab("Basal area (sq. ft per acre)")+
theme(legend.position = "none",
panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.plot + geom_violin(outlier.colour="red",outlier.shape=8)
plot$trmt<-ifelse(plot$MgmtUnit %in% c(9,16),"Five-year selection", "Ten-year selection")
head(plot)
# Chunk 1
# Read in libraries to use
library(gsheet)
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
library(tidyverse)
# Chunk 2
#devtools::install_github("SilviaTerra/forest_sampling")
library(forestsamplr)
# Chunk 3
tree<- gsheet2tbl('https://docs.google.com/spreadsheets/d/19XgWp2naizuqvSSr-DlJ0r-53IBgQd8X7yDx_KjkWWE/edit?usp=sharing')
# Select only the last year of measurement from each management unit
tree<-subset(tree, (MgmtUnit == 20 & Year==2008 & DBH >= 0) |
(MgmtUnit == 9 & Year==2013 & DBH >= 0) |
(MgmtUnit == 12 & Year==2014 & DBH >= 0) |
(MgmtUnit == 16 & Year==2012 & DBH >= 0))
#tree$MgmtUnit<-factor(tree$MgmtUnit)
tree$DBH<-as.numeric(tree$DBH)
# Chunk 4
#summarize data to calculate basal area
plot <- tree %>%
mutate(bapaTree = (DBH**2)*0.00545415*EXPF) %>%
group_by(MgmtUnit, Plot) %>%
summarize(BAPA = sum(bapaTree))
plot<-data.frame(plot)
plot$stratum<-plot$MgmtUnit
plot$trmt<-ifelse(plot$MgmtUnit %in% c(9,16),"Five-year selection", "Ten-year selection")
head(plot)
mgmtunit<-plot %>%
group_by(MgmtUnit) %>%
summarize(n_plots=n(),
mean_BAPA = mean(BAPA),
sd_BAPA = sd(BAPA))
mgmtunit
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA,col=factor(trmt)))+
xlab("Management unit")+
ylab("Basal area (sq. ft per acre)")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.plot + geom_violin(outlier.colour="red",outlier.shape=8)
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA,fill=factor(trmt)))+
xlab("Management unit")+
ylab("Basal area (sq. ft per acre)")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
p.plot + geom_violin(outlier.colour="red",outlier.shape=8)
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA,fill=factor(trmt)))+
xlab("Management unit")+
ylab("Basal area (sq. ft per acre)")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.title = element_blank())
p.plot + geom_violin(outlier.colour="red",outlier.shape=8)
p.plot<-ggplot(plot,aes(factor(MgmtUnit),BAPA,fill=factor(trmt)))+
xlab("Management unit")+
ylab("Basal area (sq. ft per acre)")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.title = element_blank())
p.plot + geom_violin()
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
#Dataset = 736,553 observations, downloaded 11 May 2019
dwd.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//DWM_COARSE_WOODY_DEBRIS.csv')
plot.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//PLOT.csv')
plot.raw<-plot.raw %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV)
dwd<-merge(dwd.raw,plot.raw,by=c("STATECD","COUNTYCD","PLOT","INVYR"))
dwd<-dwd %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV,SUBP,TRANSECT,CWDID,MEASYEAR,CONDID,SLOPDIST,HORIZ_DIST, SPCD,DECAYCD,TRANSDIA,SMALLDIA,LARGEDIA,LENGTH,HOLLOWCD,CWDHSTCD,ECOSUBCD,LAT,LON,ELEV)
dwd<-mutate(dwd, ECOSUB = substr(ECOSUBCD,2,4))
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c("33A"),"333",dwd$ECOSUB)
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c(""),"999",dwd$ECOSUB)
dwd.eco<-dwd %>%
group_by(ECOSUB)%>%
summarize(n=n())
dwd.eco
#Woodall et al. parameters
#Woodall CW, Westfall JA, Lutes DC, Oswalt SN (2008).
#End-point diameter and total length coarse woody debris models for the United States.
#For Ecol Manage 255:3700-3706
parm<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//dwdparms.csv')
View(dwd.eco)
View(dwd)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
#Dataset = 736,553 observations, downloaded 11 May 2019
dwd.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//DWM_COARSE_WOODY_DEBRIS.csv')
plot.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//PLOT.csv')
plot.raw<-plot.raw %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV)
dwd<-merge(dwd.raw,plot.raw,by=c("STATECD","COUNTYCD","PLOT","INVYR"))
dwd<-dwd %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV,SUBP,TRANSECT,CWDID,MEASYEAR,CONDID,SLOPDIST,HORIZ_DIST, SPCD,DECAYCD,TRANSDIA,SMALLDIA,LARGEDIA,LENGTH,HOLLOWCD,CWDHSTCD,ECOSUBCD,LAT,LON,ELEV)
dwd<-mutate(dwd, ECOSUB = substr(ECOSUBCD,2,4))
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c("33A"),"333",dwd$ECOSUB)
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c(""),"999",dwd$ECOSUB)
dwd.eco<-dwd %>%
group_by(ECOSUB)%>%
summarize(n=n())
dwd.eco
#Woodall et al. parameters
#Woodall CW, Westfall JA, Lutes DC, Oswalt SN (2008).
#End-point diameter and total length coarse woody debris models for the United States.
#For Ecol Manage 255:3700-3706
#Some ecogerions do not have parameters listed in Woodall et al.
#For these, parameters for a similar ecogerion were used:
#211 = 212
#223 = 221
#241 = 242
#411 = 255
#999 = average of parameters from all others
parm<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//dwdparms.csv')
dwd2<-merge(dwd,parm,by=c("ECOSUB"))
head(dw2)
head(dwd2)
View(dwd2)
dwd.spp<-dwd %>%
group_by(SPCD)%>%
summarize(n=n())
dwd.spp
View(dwd.spp)
is.numeric(dwd$SPCD)
parm<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//dwdparms.csv')
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
View(spp)
spp<-spp %>%
select(SPCD,MAJOR_SPGRCD,SFTWD_HRDWD)
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
spp<-spp %>%
select(SPCD,MAJOR_SPGRPCD,SFTWD_HRDWD)
head(spp)
dwd2<-merge(dwd,spp,by=c("SPCD"))
head(dwd2)
dwd.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//DWM_COARSE_WOODY_DEBRIS.csv')
plot.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//PLOT.csv')
plot.raw<-plot.raw %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV)
dwd<-merge(dwd.raw,plot.raw,by=c("STATECD","COUNTYCD","PLOT","INVYR"))
dwd<-dwd %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV,SUBP,TRANSECT,CWDID,MEASYEAR,CONDID,SLOPDIST,HORIZ_DIST, SPCD,DECAYCD,TRANSDIA,SMALLDIA,LARGEDIA,LENGTH,HOLLOWCD,CWDHSTCD,ECOSUBCD,LAT,LON,ELEV)
dwd<-mutate(dwd, ECOSUB = substr(ECOSUBCD,2,4))
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c("33A"),"333",dwd$ECOSUB)
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c(""),"999",dwd$ECOSUB)
dwd.eco<-dwd %>%
group_by(ECOSUB)%>%
summarize(n=n())
dwd.eco
#Woodall et al. parameters
#Woodall CW, Westfall JA, Lutes DC, Oswalt SN (2008).
#End-point diameter and total length coarse woody debris models for the United States.
#For Ecol Manage 255:3700-3706
#Some ecogerions do not have parameters listed in Woodall et al.
#For these, parameters for a similar ecogerion were used:
#211 = 212
#223 = 221
#241 = 242
#411 = 255
#999 = average of parameters from all others
parm<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//dwdparms.csv')
#Read in species dataset to get major species group codes
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
spp<-spp %>%
select(SPCD,MAJOR_SPGRPCD,SFTWD_HRDWD)
dwd2<-merge(dwd,spp,by=c("SPCD"))
View(dwd)
head(dwd
)
dwd5<-subset(dwd,DECAYCD)
dwd5<-subset(dwd,DECAYCD==5)
View(dwd5)
View(dwd5)
dwd.spp<-dwd %>%
group_by(STATECD,DECAYCD)%>%
summarize(n=n())
dwd.spp
View(spp)
View(dwd.spp)
dwd.spp<-dwd5 %>%
group_by(STATECD,DECAYCD)%>%
summarize(n=n())
dwd.spp
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
dwd.spp<-dwd2 %>%
group_by(SPCD)%>%
summarize(n=n())
dwd.spp
View(dwd.spp)
View(dwd2)
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
dwd.spp<-dwd2 %>%
group_by(SPCD)%>%
summarize(n=n())
dwd.spp
View(dwd.spp)
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,dwd2$SPCD=-40,dwd2$SPCD)
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,dwd2$SPCD==-40,dwd2$SPCD)
dwd.spp<-dwd2 %>%
group_by(SPCD)%>%
summarize(n=n())
dwd.spp
View(dwd.spp)
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,-40,dwd2$SPCD)
dwd.spp<-dwd2 %>%
group_by(SPCD)%>%
summarize(n=n())
dwd.spp
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,999,dwd2$SPCD)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
dwd.spp<-dwd2 %>%
group_by(SPCD)%>%
summarize(n=n())
dwd.spp
head(spp)
#Read in species dataset to get major species group codes
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
head(spp)
#Read in species dataset to get major species group codes
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
spp<-spp %>%
select(SPCD,MAJOR_SPGRPCD,SFTWD_HRDWD,COMMON_NAME)
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,999,dwd2$SPCD)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
dwd.spp<-dwd2 %>%
group_by(COMMON_NAME)%>%
summarize(n=n())
dwd.spp
#Read in species dataset to get major species group codes
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
spp<-spp %>%
select(SPCD,MAJOR_SPGRPCD,SFTWD_HRDWD,COMMON_NAME)
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,999,dwd2$SPCD)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
dwd.spp<-dwd3 %>%
group_by(COMMON_NAME)%>%
summarize(n=n())
dwd.spp
View(dwd.spp)
dwd.spp$pct<-(dwd.spp$n/sum(dwd.spp$n)*100
)
View(dwd.spp)
head(parms)
head(parm)
head(dwd4)
head(parm)
head(dwd3)
dwd3$SPGR<-ifelse(dwd3$SFTWD_HRDWD=="S","Sftwd","Hwd")
head(parm)
head(dwd3)
View(parm)
dwd3$SPGR<-ifelse(dwd3$SFTWD_HRDWD=="S","Sftwd","Hwd")
dwd3$SPGR<-ifelse(dwd3$ECOSUB %in% c(251,411,255,333,999),"All", dwd3$SPGR)
head(parm)
head(dwd3)
dwd4<-merge(dwd3,parms,by=c("SPGR"))
dwd4<-merge(dwd3,parm,by=c("SPGR"))
dwd4<-merge(dwd3,parm,by=c("ECOSUB","SPGR"))
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
#Dataset = 736,553 observations, downloaded 11 May 2019
dwd.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//DWM_COARSE_WOODY_DEBRIS.csv')
plot.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//PLOT.csv')
plot.raw<-plot.raw %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV)
dwd<-merge(dwd.raw,plot.raw,by=c("STATECD","COUNTYCD","PLOT","INVYR"))
dwd<-dwd %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV,SUBP,TRANSECT,CWDID,MEASYEAR,CONDID,SLOPDIST,HORIZ_DIST, SPCD,DECAYCD,TRANSDIA,SMALLDIA,LARGEDIA,LENGTH,HOLLOWCD,CWDHSTCD,ECOSUBCD,LAT,LON,ELEV)
dwd<-mutate(dwd, ECOSUB = substr(ECOSUBCD,2,4))
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c("33A"),"333",dwd$ECOSUB)
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c(""),"999",dwd$ECOSUB)
dwd.eco<-dwd %>%
group_by(ECOSUB)%>%
summarize(n=n())
dwd.eco
#Woodall et al. parameters
#Woodall CW, Westfall JA, Lutes DC, Oswalt SN (2008).
#End-point diameter and total length coarse woody debris models for the United States.
#For Ecol Manage 255:3700-3706
#Some ecogerions do not have parameters listed in Woodall et al.
#For these, parameters for a similar ecogerion were used:
#211 = 212
#223 = 221
#241 = 242
#411 = 255
#999 = average of parameters from all others
parm<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//dwdparms.csv')
#Read in species dataset to get major species group codes
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
spp<-spp %>%
select(SPCD,MAJOR_SPGRPCD,SFTWD_HRDWD,COMMON_NAME)
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,999,dwd2$SPCD)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
# Chunk 3
dwd.spp<-dwd3 %>%
group_by(COMMON_NAME)%>%
summarize(n=n())
dwd.spp$pct<-(dwd.spp$n/sum(dwd.spp$n)*100)
# Chunk 4
dwd3$SPGR<-ifelse(dwd3$SFTWD_HRDWD=="S","Sftwd","Hwd")
dwd3$SPGR<-ifelse(dwd3$ECOSUB %in% c(251,411,255,333,999),"All", dwd3$SPGR)
dwd4<-merge(dwd3,parm,by=c("ECOSUB","SPGR"))
?merge
dwd4<-merge(dwd3,parm,by=c("ECOSUB","SPGR"),all=T)
View(dwd4)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Chunk 2
#Dataset = 736,553 observations, downloaded 11 May 2019
dwd.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//DWM_COARSE_WOODY_DEBRIS.csv')
plot.raw<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//PLOT.csv')
plot.raw<-plot.raw %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV)
dwd<-merge(dwd.raw,plot.raw,by=c("STATECD","COUNTYCD","PLOT","INVYR"))
dwd<-dwd %>%
select(STATECD,COUNTYCD,PLOT,INVYR,ECOSUBCD,LAT,LON,ELEV,SUBP,TRANSECT,CWDID,MEASYEAR,CONDID,SLOPDIST,HORIZ_DIST, SPCD,DECAYCD,TRANSDIA,SMALLDIA,LARGEDIA,LENGTH,HOLLOWCD,CWDHSTCD,ECOSUBCD,LAT,LON,ELEV)
dwd<-mutate(dwd, ECOSUB = substr(ECOSUBCD,2,4))
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c("33A"),"333",dwd$ECOSUB)
dwd$ECOSUB<-ifelse(dwd$ECOSUB %in% c(""),"999",dwd$ECOSUB)
dwd.eco<-dwd %>%
group_by(ECOSUB)%>%
summarize(n=n())
dwd.eco
#Woodall et al. parameters
#Woodall CW, Westfall JA, Lutes DC, Oswalt SN (2008).
#End-point diameter and total length coarse woody debris models for the United States.
#For Ecol Manage 255:3700-3706
#Some ecogerions do not have parameters listed in Woodall et al.
#For these, parameters for a similar ecogerion were used:
#211 = 212
#223 = 221
#241 = 242
#411 = 255
#999 = average of parameters from all others
parm<-read.csv('C://Users//russellm//Documents//Projects//DWDModels//Data//dwdparms.csv')
#Read in species dataset to get major species group codes
spp<-read.csv('C://Users//russellm//Documents//Data//Species//REF_SPECIES.csv')
spp<-spp %>%
select(SPCD,MAJOR_SPGRPCD,SFTWD_HRDWD,COMMON_NAME)
#Remove Decay class 5 pieces
dwd2<-subset(dwd,DECAYCD<=4 & SPCD != 1)
dwd2$SPCD<-ifelse(dwd2$SPCD==0,999,dwd2$SPCD)
dwd3<-merge(dwd2,spp,by=c("SPCD"))
head(dwd3)
# Chunk 3
dwd.spp<-dwd3 %>%
group_by(COMMON_NAME)%>%
summarize(n=n())
dwd.spp$pct<-(dwd.spp$n/sum(dwd.spp$n)*100)
# Chunk 4
dwd3$SPGR<-ifelse(dwd3$SFTWD_HRDWD=="S","Sftwd","Hwd")
dwd3$SPGR<-ifelse(dwd3$ECOSUB %in% c(251,411,255,333,999),"All", dwd3$SPGR)
dwd4<-merge(dwd3,parm,by=c("ECOSUB","SPGR"),all=T)
dwd4<-merge(dwd3,parm,by=c("ECOSUB","SPGR"))
