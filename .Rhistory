labs(x = " ",
y = "R-squared")+
scale_fill_brewer(palette="Blues")+
theme(legend.position = "none")
blogdown:::serve_site()
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
geom_line(data = grid, color = "red", size = 1)+
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)")
grid <- tree %>%
data_grid(ST_OB_D_BH = seq_range(ST_OB_D_BH, 20)) %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH)) %>%
add_predictions(tree_mod, "l_AG_DW") %>%
mutate(AG_DW = 2 ^ l_AG_DW)
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
geom_line(data = grid, color = "red", size = 1)+
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)")
blogdown:::serve_site()
grid <- tree %>%
data_grid(ST_OB_D_BH = seq_range(ST_OB_D_BH, 20)) %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH)) %>%
add_predictions(tree_mod, "l_AG_DW") %>%
mutate(AG_DW = 2 ^ l_AG_DW)
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
geom_line(data = grid, color = "red", size = 1)+
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)")
blogdown:::serve_site()
# Chunk 1
library(tidyverse)
library(modelr)
library(knitr)
library(kableExtra)
# Chunk 2
tree_in <- read_csv("C:\\Users\\russellm\\Documents\\Arbor\\Data\\ga_tree.csv")
spp <- tibble (
SPCD = c(131, 110, 111, 121, 132, 611, 129),
Species = c("Loblolly pine", "Shortleaf pine", "Slash pine",
"Longleaf pine", "Virginia pine", "Sweetgum", "Eastern white pine")
)
tree2 <- inner_join(tree_in, spp)
tree <- tree2 %>%
filter(!is.na(ST_OB_D_BH),
!is.na(AG_DW))
tree3<-tree %>%
group_by(Species) %>%
summarize(`Num trees` = n(),
`Mean DBH` = round(mean(ST_OB_D_BH, na.rm=T), 1),
`Max DBH` = max(ST_OB_D_BH, na.rm=T),
`Min DBH` = min(ST_OB_D_BH, na.rm=T),
`Mean weight`= round(mean(AG_DW, na.rm=T), 1),
`Max weight` = max(AG_DW, na.rm=T),
`Min weight` = min(AG_DW, na.rm=T))%>%
arrange(desc(`Num trees`))
# Chunk 3
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
# Chunk 4
knitr::kable((tree3[,]),
caption = 'Summary statistics for diameter at breast height (DBH)
and aboveground dry weight (weight; pounds) for seven tree species.') %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
# Chunk 5
tree <- tree %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH),
l_AG_DW = log2(AG_DW))
tree_mod <- lm(l_AG_DW ~ l_ST_OB_D_BH, data = tree)
summary(tree_mod)
grid <- tree %>%
data_grid(ST_OB_D_BH = seq_range(ST_OB_D_BH, 20)) %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH)) %>%
add_predictions(tree_mod, "l_AG_DW") %>%
mutate(AG_DW = 2 ^ l_AG_DW)
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
geom_line(data = grid, color = "red", size = 1)+
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)")
blogdown:::serve_site()
blogdown:::serve_site()
by_spp <- by_spp %>%
mutate(preds = map2(data, model, add_predictions))
by_spp
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
# Chunk 1
library(tidyverse)
library(modelr)
library(knitr)
library(kableExtra)
# Chunk 2
tree_in <- read_csv("C:\\Users\\russellm\\Documents\\Arbor\\Data\\ga_tree.csv")
spp <- tibble (
SPCD = c(131, 110, 111, 121, 132, 611, 129),
Species = c("Loblolly pine", "Shortleaf pine", "Slash pine",
"Longleaf pine", "Virginia pine", "Sweetgum", "Eastern white pine")
)
tree2 <- inner_join(tree_in, spp)
tree <- tree2 %>%
filter(!is.na(ST_OB_D_BH),
!is.na(AG_DW))
tree3<-tree %>%
group_by(Species) %>%
summarize(`Num trees` = n(),
`Mean DBH` = round(mean(ST_OB_D_BH, na.rm=T), 1),
`Max DBH` = max(ST_OB_D_BH, na.rm=T),
`Min DBH` = min(ST_OB_D_BH, na.rm=T),
`Mean weight`= round(mean(AG_DW, na.rm=T), 1),
`Max weight` = max(AG_DW, na.rm=T),
`Min weight` = min(AG_DW, na.rm=T))%>%
arrange(desc(`Num trees`))
# Chunk 1
library(tidyverse)
library(modelr)
library(knitr)
library(kableExtra)
# Chunk 2
tree_in <- read_csv("C:\\Users\\russellm\\Documents\\Arbor\\Data\\ga_tree.csv")
spp <- tibble (
SPCD = c(131, 110, 111, 121, 132, 611, 129),
Species = c("Loblolly pine", "Shortleaf pine", "Slash pine",
"Longleaf pine", "Virginia pine", "Sweetgum", "Eastern white pine")
)
tree2 <- inner_join(tree_in, spp)
tree <- tree2 %>%
filter(!is.na(ST_OB_D_BH),
!is.na(AG_DW))
tree3<-tree %>%
group_by(Species) %>%
summarize(`Num trees` = n(),
`Mean DBH` = round(mean(ST_OB_D_BH, na.rm=T), 1),
`Max DBH` = max(ST_OB_D_BH, na.rm=T),
`Min DBH` = min(ST_OB_D_BH, na.rm=T),
`Mean weight`= round(mean(AG_DW, na.rm=T), 1),
`Max weight` = max(AG_DW, na.rm=T),
`Min weight` = min(AG_DW, na.rm=T))%>%
arrange(desc(`Num trees`))
tree3
186+100+80+80+80+42+40
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
knitr::kable((tree3[,]),
caption = 'Summary statistics for diameter at breast height (DBH)
and aboveground dry weight (weight; pounds) for seven tree species.') %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
tree <- tree %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH),
l_AG_DW = log2(AG_DW))
tree_mod <- lm(l_AG_DW ~ l_ST_OB_D_BH, data = tree)
summary(tree_mod)
grid <- tree %>%
data_grid(ST_OB_D_BH = seq_range(ST_OB_D_BH, 20)) %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH)) %>%
add_predictions(tree_mod, "l_AG_DW") %>%
mutate(AG_DW = 2 ^ l_AG_DW)
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
geom_line(data = grid, color = "red", size = 1) +
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)")
grid <- tree %>%
data_grid(ST_OB_D_BH = seq_range(ST_OB_D_BH, 20)) %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH)) %>%
add_predictions(tree_mod, "l_AG_DW") %>%
mutate(AG_DW = 2 ^ l_AG_DW)
tree_coef<- tree %>%
group_by(Species) %>%
do(broom::tidy(lm(l_AG_DW ~ l_ST_OB_D_BH, .)))
tree_coef
ggplot(tree_coef, aes(estimate, 1)) +
geom_point() +
geom_errorbarh(aes(xmin = estimate - (2*std.error),
xmax = estimate + (2*std.error),
height = 0.5)) +
scale_y_continuous(limits = c(0,2))+
facet_grid(term~Species)+
labs(x = "Coefficient", y = " ")+
ggtitle("Coefficients for determining aboveground dry weight \n(+/- two standard errors) for seven tree species")+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())
by_spp <- tree %>%
group_by(Species) %>%
nest()
species_model <- function(df){
lm(l_AG_DW ~ l_ST_OB_D_BH, data = df)
}
models <- map(by_spp$data, species_model)
by_spp <- by_spp %>%
mutate(model = map(data, species_model))
by_spp
by_spp <- by_spp %>%
mutate(preds = map2(data, model, add_predictions))
by_spp
ggplot(tree_coef, aes(estimate, 1)) +
geom_point() +
geom_errorbarh(aes(xmin = estimate - (2*std.error),
xmax = estimate + (2*std.error),
height = 0.5)) +
scale_y_continuous(limits = c(0,2))+
facet_grid(term~Species)+
labs(x = "Coefficient", y = " ")+
ggtitle("Coefficients for determining aboveground dry weight \n(+/- two standard errors) for seven tree species")+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())
by_spp <- tree %>%
group_by(Species) %>%
nest()
species_model <- function(df){
lm(l_AG_DW ~ l_ST_OB_D_BH, data = df)
}
models <- map(by_spp$data, species_model)
by_spp <- by_spp %>%
mutate(model = map(data, species_model))
by_spp
by_spp <- by_spp %>%
mutate(preds = map2(data, model, add_predictions))
by_spp
preds <- unnest(by_spp, preds)
preds %>%
mutate(tpred = 2 ^ pred) %>%
ggplot(aes(ST_OB_D_BH, tpred)) +
geom_line(aes(group = Species), size = 1) +
#geom_smooth(se = F) +
labs(x = "Diameter at breast height (inches)",
y = "Predicted aboveground\ndry weight (pounds)")+
facet_wrap(~ Species)
preds %>%
mutate(tpred = 2 ^ pred) %>%
ggplot(aes(ST_OB_D_BH, tpred)) +
geom_line(aes(group = Species), size = 1) +
geom_smooth(se = F) +
labs(x = "Diameter at breast height (inches)",
y = "Predicted aboveground\ndry weight (pounds)")+
facet_wrap(~ Species)
preds %>%
mutate(tpred = 2 ^ pred) %>%
ggplot(aes(ST_OB_D_BH, tpred)) +
geom_line(aes(group = Species), size = 1) +
geom_smooth() +
labs(x = "Diameter at breast height (inches)",
y = "Predicted aboveground\ndry weight (pounds)")+
facet_wrap(~ Species)
preds <- unnest(by_spp, preds)
preds %>%
mutate(tpred = 2 ^ pred) %>%
ggplot(aes(ST_OB_D_BH, tpred)) +
geom_line(aes(group = Species), size = 1) +
labs(x = "Diameter at breast height (inches)",
y = "Predicted aboveground\ndry weight (pounds)")+
facet_wrap(~ Species)
preds
by_spp <- by_spp %>%
mutate(resids = map2(data, model, add_residuals))
by_spp
resids <- unnest(by_spp, resids)
resids %>%
ggplot(aes(ST_OB_D_BH, resid)) +
geom_point(aes(group = Species), alpha = 1/3) +
geom_smooth(se = F) +
labs(x = "Diameter at breast height (inches)",
y = "Residual")+
geom_abline(intercept = 0, slope = 0, color = "pink")+
facet_wrap(~Species)
by_spp <- tree %>%
group_by(Species) %>%
nest()
species_model <- function(df){
lm(l_AG_DW ~ l_ST_OB_D_BH, data = df)
}
models <- map(by_spp$data, species_model)
by_spp <- by_spp %>%
mutate(model = map(data, species_model))
by_spp
glance <- by_spp %>%
mutate(glance = map(model, broom::glance)) %>%
unnest(glance, .drop = T)
glance <- by_spp %>%
mutate(glance = map(model, broom::glance)) %>%
unnest(glance, .drop = T)
glance <- by_spp %>%
mutate(glance = map(model, broom::glance)) %>%
unnest(glance, .drop = T)
glance <- by_spp %>%
mutate(glance = map(model, broom::glance)) %>%
unnest(glance, .drop = T)
glance %>%
arrange(desc(r.squared))
glance %>%
ggplot(aes(reorder(Species, r.squared), r.squared)) +
geom_bar(stat = "identity")+
coord_flip()+
geom_smooth(se = F) +
labs(x = " ",
y = "R-squared")+
theme(legend.position = "none")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
library(tidyverse)
# Chunk 1
library(tidyverse)
# Chunk 2
res <-
tribble(
~Type, ~Year, ~Num,
"Forest industry", 2002, 124,
"Forest industry", 2016, 62,
"Universities",	2002, 1361,
"Universities",	2016, 1224,
"US Forest Service",	2002, 618,
"US Forest Service",	2016, 500
)
p.res <- ggplot(res, aes(Year, Num, fill=Type)) +
geom_line() +
geom_point() +
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res
p.res <- ggplot(res, aes(Year, Num, col=Type)) +
geom_line() +
geom_point() +
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res
p.res <- ggplot(res, aes(Year, Num, col=Type, shape = Type)) +
geom_line() +
geom_point() +
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res
p.res2 <- ggplot(res, aes(Type, Num, fill = Year)) +
geom_bar(stat = "identity")+
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = Year)) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "left")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
axis.text = element_text(size=12, col = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
axis.text = element_text(size=12, color = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
axis.text = element_text(size=12, color = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=12, color = "black"),
axis.text = element_text(size=12, color = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
scale_fill_brewer(palette="Dark2")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=13, color = "black"),
axis.text = element_text(size=12, color = "black"))
p.res2
# p.res <- ggplot(res, aes(Year, Num, col=Type, shape = Type)) +
#          geom_line() +
#          geom_point() +
#   labs(x = "Year", y = "Forest scientists",
#        title = "The number of forestry resesearchers has declined by 15% since 2002.")+
#     theme(panel.background = element_rect(fill = "NA"),
#         axis.line = element_line(color="black"),
#         legend.position = "bottom")
# p.res
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry researchers has declined by 12% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
scale_fill_brewer(palette="Dark2")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=13, color = "black"),
axis.text = element_text(size=12, color = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry researchers has declined by 12% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
scale_fill_brewer(palette="Dark2")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=13, color = "black"),
axis.text = element_text(size=12, color = "black"),
axis.title.x = element_text(size = 13))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry researchers has declined by 12% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
scale_fill_brewer(palette="Dark2")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=13, color = "black"),
axis.text = element_text(size=12, color = "black"),
axis.title.y = element_text(size = 13))
p.res2
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
