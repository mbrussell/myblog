select(Year, Dec, Jan, Feb)
# Read in stumpabe data
# Source: "Stumpage reports": https://www.maine.gov/dacf/mfs/publications/annual_reports.html
stump <- read_csv("C:/Users/matt/Documents/Arbor/Data/me_saw_stumpage.csv") |>
filter(!(species %in% c("Mixed Hardwood", "Mixed Soft/Hardwood", "Mixed Softwoods",
"Other Hardwood", "Other Softwoods")))
# Inflation rates to convert to 2021 dollars
# Source: https://www.usinflationcalculator.com/
infl <- tibble(
Year = c(2000:2021),
infl_rate = c(57.4, 53.1, 50.6, 47.3, 43.4, 38.7, 34.4, 30.7, 25.9, 26.3, 24.3,
20.5, 18.0, 16.3, 14.5, 14.3, 12.9, 10.5, 7.9, 6.0, 4.7, 0)
)
# Chunk 3
stump_spp <- stump |>
group_by(species) |>
summarize(num_years = n(),
mean_savg = mean(savg))
stump_spp
stump <- stump |>
inner_join(infl, by = "Year") |>
mutate(savg_adj = savg + (savg*(infl_rate/100)),
smin_adj = smin + (smin*(infl_rate/100)),
smax_adj = smax + (smax*(infl_rate/100)))
stump
tavg <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2_table.csv", skip = 5)|>
select(Year, Dec, Jan, Feb)
View(tavg)
View(tmin)
tavg <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2_table.csv", skip = 5)|>
select(Year, Dec, Jan, Feb) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="t") |>
group_by(Year) |>
summarize(avg_t = mean(t))
tavg
tmin
temps <- inner_join(tmin, tavg, by = "Year")
temps
# Chunk 1
library(tidyverse)
# Chunk 2
# Read in climate datasets
# Source: https://mco.umaine.edu/climate/me_monthly/?cdiv_id=me&var_id=t2anom&mon_id=ann
tmin <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2min_table.csv", skip = 5) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="tmin") |>
group_by(Year) |>
summarize(avg_tmin = mean(tmin))
tavg <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2_table.csv", skip = 5)|>
select(Year, Dec, Jan, Feb) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="t") |>
group_by(Year) |>
summarize(avg_t = mean(t))
temps <- inner_join(tmin, tavg, by = "Year")
# Read in stumpabe data
# Source: "Stumpage reports": https://www.maine.gov/dacf/mfs/publications/annual_reports.html
stump <- read_csv("C:/Users/matt/Documents/Arbor/Data/me_saw_stumpage.csv") |>
filter(!(species %in% c("Mixed Hardwood", "Mixed Soft/Hardwood", "Mixed Softwoods",
"Other Hardwood", "Other Softwoods")))
# Inflation rates to convert to 2021 dollars
# Source: https://www.usinflationcalculator.com/
infl <- tibble(
Year = c(2000:2021),
infl_rate = c(57.4, 53.1, 50.6, 47.3, 43.4, 38.7, 34.4, 30.7, 25.9, 26.3, 24.3,
20.5, 18.0, 16.3, 14.5, 14.3, 12.9, 10.5, 7.9, 6.0, 4.7, 0)
)
# Chunk 3
stump_spp <- stump |>
group_by(species) |>
summarize(num_years = n(),
mean_savg = mean(savg))
stump_spp
# Chunk 4
stump <- stump |>
inner_join(infl, by = "Year") |>
mutate(savg_adj = savg + (savg*(infl_rate/100)),
smin_adj = smin + (smin*(infl_rate/100)),
smax_adj = smax + (smax*(infl_rate/100)))
stump
# Chunk 5
stump_temps <-inner_join(stump, temps, by = "Year")
stump_temps
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth() +
facet_wrap(~species) +
labs (x = "Minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars",
caption: "Sources: Maine Climate Office, Maine Forest Service Stumpage reports")
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth() +
facet_wrap(~species) +
labs (x = "Minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports")
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth() +
facet_wrap(~species) +
labs (x = "Minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tavg, y = savg_adj)) +
geom_point() +
geom_smooth() +
facet_wrap(~species) +
labs (x = "Average winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_t, y = savg_adj)) +
geom_point() +
geom_smooth() +
facet_wrap(~species) +
labs (x = "Average winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
cor_tmin <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_tmin, savg_adj))
cor_tmin
cor_tmin <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_tmin, savg_adj)) |>
arrange(desc(cor))
cor_tmin
cor_tmin <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_tmin, savg_adj)) |>
arrange((cor))
cor_tmin
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth() +
facet_wrap(~species) +
labs (x = "Minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
cor_t <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_t, savg_adj))
cor_t <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_t, savg_adj)) |>
arrange(cor)
cor_t
cor_tmin
# Chunk 1
library(tidyverse)
# Chunk 2
# Read in climate datasets
# Source: https://mco.umaine.edu/climate/me_monthly/?cdiv_id=me&var_id=t2anom&mon_id=ann
tmin <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2min_table.csv", skip = 5) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="tmin") |>
group_by(Year) |>
summarize(avg_tmin = mean(tmin))
tavg <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2_table.csv", skip = 5)|>
select(Year, Dec, Jan, Feb) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="t") |>
group_by(Year) |>
summarize(avg_t = mean(t))
temps <- inner_join(tmin, tavg, by = "Year")
# Read in stumpabe data
# Source: "Stumpage reports": https://www.maine.gov/dacf/mfs/publications/annual_reports.html
stump <- read_csv("C:/Users/matt/Documents/Arbor/Data/me_saw_stumpage.csv") |>
filter(!(species %in% c("Mixed Hardwood", "Mixed Soft/Hardwood", "Mixed Softwoods",
"Other Hardwood", "Other Softwoods")))
# Inflation rates to convert to 2021 dollars
# Source: https://www.usinflationcalculator.com/
infl <- tibble(
Year = c(2000:2021),
infl_rate = c(57.4, 53.1, 50.6, 47.3, 43.4, 38.7, 34.4, 30.7, 25.9, 26.3, 24.3,
20.5, 18.0, 16.3, 14.5, 14.3, 12.9, 10.5, 7.9, 6.0, 4.7, 0)
)
# Chunk 3
stump_spp <- stump |>
group_by(species) |>
summarize(num_years = n(),
mean_savg = mean(savg))
stump_spp
# Chunk 4
stump <- stump |>
inner_join(infl, by = "Year") |>
mutate(savg_adj = savg + (savg*(infl_rate/100)),
smin_adj = smin + (smin*(infl_rate/100)),
smax_adj = smax + (smax*(infl_rate/100)))
stump
# Chunk 5
stump_temps <-inner_join(stump, temps, by = "Year")
stump_temps
# Chunk 6
cor_tmin <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_tmin, savg_adj)) |>
arrange((cor))
cor_tmin
cor_t <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_t, savg_adj)) |>
arrange(cor)
cor_t
# Chunk 7
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth() +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tavg <- ggplot(stump_temps, aes(x = avg_t, y = savg_adj)) +
geom_point() +
geom_smooth(method = lm()) +
facet_wrap(~species) +
labs (x = "Average winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tavg <- ggplot(stump_temps, aes(x = avg_t, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tavg
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj, col = Year)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj, col = factor(Year))) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
p_spp_tmin <- ggplot(stump_temps, aes(x = avg_tmin, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Average minimum winter temperature (deg F)",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tmin
tidy(cor_tmin)
library(broom)
cor_tmin <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_tmin, savg_adj)) |>
arrange(cor)
tidy(cor_tmin)
glance(cor_tmin)
cor_tmin <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor(avg_tmin, savg_adj)) |>
arrange(cor)
glance(cor_tmin)
glimpse(cor_tmin)
cor_tmin <- stump_temps %>%
group_by(species) %>%
summarize(cor = cor.test(avg_tmin, savg_adj)) |>
arrange(cor)
stump_temps %>%
group_by(species) %>%
nest(data = avg_tmin, savg_adj)  |>
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)),
tidied = map(test, tidy)
) %>%
unnest(cols = tidied) %>%
select(-data, -test)
stump_temps %>%
group_by(species) %>%
nest(data = c(avg_tmin, savg_adj))  |>
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)),
tidied = map(test, tidy)
) %>%
unnest(cols = tidied) %>%
select(-data, -test)
stump_temps
stump_temps %>%
group_by(species) %>%
nest(data = c(avg_tmin, savg_adj))  |>
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)),
tidied = map(test, tidy)
) %>%
unnest(cols = tidied) %>%
select(-data, -test)
stump_temps %>%
nest(data = c(avg_tmin, savg_adj))  |>
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)),
tidied = map(test, tidy)
) %>%
unnest(cols = tidied) %>%
select(-data, -test)
# Chunk 1
library(tidyverse)
library(broom)
# Chunk 2
# Read in climate datasets
# Source: https://mco.umaine.edu/climate/me_monthly/?cdiv_id=me&var_id=t2anom&mon_id=ann
tmin <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2min_table.csv", skip = 5) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="tmin") |>
group_by(Year) |>
summarize(avg_tmin = mean(tmin))
tavg <- read_csv("C:/Users/matt/Documents/Arbor/Projects/Blog/noaa_me_t2_table.csv", skip = 5)|>
select(Year, Dec, Jan, Feb) |>
mutate(prev_Dec = lag(Dec)) |>
select(Year, Jan, Feb, prev_Dec) |>
filter(Year > 1895) |>
pivot_longer(Jan:prev_Dec, names_to = "Month", values_to ="t") |>
group_by(Year) |>
summarize(avg_t = mean(t))
temps <- inner_join(tmin, tavg, by = "Year")
# Read in stumpabe data
# Source: "Stumpage reports": https://www.maine.gov/dacf/mfs/publications/annual_reports.html
stump <- read_csv("C:/Users/matt/Documents/Arbor/Data/me_saw_stumpage.csv") |>
filter(!(species %in% c("Mixed Hardwood", "Mixed Soft/Hardwood", "Mixed Softwoods",
"Other Hardwood", "Other Softwoods")))
# Inflation rates to convert to 2021 dollars
# Source: https://www.usinflationcalculator.com/
infl <- tibble(
Year = c(2000:2021),
infl_rate = c(57.4, 53.1, 50.6, 47.3, 43.4, 38.7, 34.4, 30.7, 25.9, 26.3, 24.3,
20.5, 18.0, 16.3, 14.5, 14.3, 12.9, 10.5, 7.9, 6.0, 4.7, 0)
)
# Chunk 3
stump_spp <- stump |>
group_by(species) |>
summarize(num_years = n(),
mean_savg = mean(savg))
stump_spp
# Chunk 4
stump <- stump |>
inner_join(infl, by = "Year") |>
mutate(savg_adj = savg + (savg*(infl_rate/100)),
smin_adj = smin + (smin*(infl_rate/100)),
smax_adj = smax + (smax*(infl_rate/100)))
stump
# Chunk 5
stump_temps <-inner_join(stump, temps, by = "Year")
stump_temps
stump_temps %>%
group_by(species) %>%
nest(data = c(avg_tmin, savg_adj))  |>
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)),
tidied = map(test, tidy)
) %>%
unnest(cols = tidied) %>%
select(-data, -test)
stump_temps %>%
# group_by(species) %>%
nest(data = c(avg_tmin, savg_adj))  |>
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)),
tidied = map(test, tidy)
) %>%
unnest(cols = tidied) %>%
select(-data, -test)
nested <-
stump_temps %>%
nest(data = c(avg_tmin, savg_adj))
nested <-
stump_temps %>%
nest(data = c(avg_tmin, savg_adj))
nested %>%
mutate(test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)))
stump_temps
library(tidymodels)
nested <-
stump_temps %>%
nest(data = c(avg_tmin, savg_adj))
nested %>%
mutate(test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)))
stump_temps
stump_temps %>%
nest(data = -species) %>%
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)), # S3 list-col
tidied = map(test, tidy)
) %>%
unnest(tidied)
stump_temps %>%
nest(data = -species) %>%
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg_adj)), # S3 list-col
tidied = map(test, tidy)
) %>%
unnest(tidied) |>
arrange(p.value)
stump_temps %>%
nest(data = -species) %>%
mutate(
test = map(data, ~ cor.test(.x$avg_t, .x$savg_adj)), # S3 list-col
tidied = map(test, tidy)
) %>%
unnest(tidied) |>
arrange(p.value)
p_spp_tavg <- ggplot(stump_temps, aes(x = Year, y = savg_adj)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_tavg
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj, col = species)) +
geom_point() +
geom_smooth(method = "lm") +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj, col = species)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = avg_tmin)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Average minimum winter temperature (deg F)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
stump_temps %>%
nest(data = -species) %>%
mutate(
test = map(data, ~ cor.test(.x$avg_tmin, .x$savg)), # S3 list-col
tidied = map(test, tidy)
) %>%
unnest(tidied) |>
arrange(p.value)
p_spp_year <- ggplot(stump_temps, aes(x = Year, y = savg_adj, col = species)) +
geom_point() +
geom_smooth(method = "lm", se = F) +
#facet_wrap(~species) +
labs (x = "Year",
y = "Sawlog stumpage (per MBF, 2021 dollars)",
caption = "Sources: Maine Climate Office, Maine Forest Service Stumpage reports") +
theme_bw()
p_spp_year
