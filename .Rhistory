mutate(Year=2012)
h2b_12_2_num
h2b_11 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY2011.xlsx")
h2b_11_2 <- inner_join(h2b_11, soc)
h2b_11_2_num <- h2b_11_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2011)
h2b_11_2_num
h2b_all<-rbind(h2b_18_2_num,h2b_17_2_num,h2b_16_2_num,
h2b_15_2_num,h2b_14_2_num,h2b_13_2_num,
h2b_12_2_num,h2b_11_2_num)
h2b_all2 <- h2b_all %>%
group_by(Year) %>%
summarize(n.all = sum(`Number of workers`))
ggplot(h2b_all2, aes(Year, n.all)) +
geom_point() +
geom_line() +
labs(x = "Year", y = "Number of H-2B guest workers",
title = "H-2B forestry guest workers, 2011 - 2018")+
guides(col = guide_legend(nrow = 4))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom",
legend.title = element_blank())
h2b_all2
h2b_18_2_num <- h2b_18_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year = 2018)
h2b_18_2_num
h2b_17 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_Disclosure_Data_FY17.xlsx")
h2b_17_2 <- inner_join(h2b_17, soc)
h2b_17_2_num <- h2b_17_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2017)
h2b_17_2_num
h2b_16 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_Disclosure_Data_FY16.xlsx")
h2b_16_2 <- inner_join(h2b_16, soc)
h2b_16_2_num <- h2b_16_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2016)
h2b_16_2_num
h2b_15 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_Disclosure_Data_FY15_Q4.xlsx")
h2b_15_2 <- inner_join(h2b_15, soc)
h2b_15_2_num <- h2b_15_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2015)
h2b_15_2_num
h2b_14 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY14_Q4.xlsx")
h2b_14_2 <- inner_join(h2b_14, soc)
h2b_14_2_num <- h2b_14_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2014)
h2b_14_2_num
h2b_13 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY2013.xls")
h2b_13_2 <- inner_join(h2b_13, soc)
h2b_13_2_num <- h2b_13_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2013)
h2b_13_2_num
h2b_12 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY2012.xlsx")
h2b_12_2 <- inner_join(h2b_12, soc)
h2b_12_2_num <- h2b_12_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2012)
h2b_12_2_num
h2b_11 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY2011.xlsx")
h2b_11_2 <- inner_join(h2b_11, soc)
h2b_11_2_num <- h2b_11_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2011)
h2b_11_2_num
h2b_all<-rbind(h2b_18_2_num,h2b_17_2_num,h2b_16_2_num,
h2b_15_2_num,h2b_14_2_num,h2b_13_2_num,
h2b_12_2_num,h2b_11_2_num)
h2b_all2 <- h2b_all %>%
group_by(Year) %>%
summarize(n.all = sum(`Number of workers`))
ggplot(h2b_all2, aes(Year, n.all)) +
geom_point() +
geom_line() +
labs(x = "Year", y = "Number of H-2B guest workers",
title = "H-2B forestry guest workers, 2011 - 2018")+
guides(col = guide_legend(nrow = 4))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom",
legend.title = element_blank())
h2b_all %>%
ggplot(aes(Year,`Number of workers`,  col = MY_TITLE)) +
geom_point() +
geom_line() +
# facet_wrap(~MY_TITLE, ncol=2)+
labs(x = "Year", y = "Number of H-2B guest workers",
title = "H-2B forestry guest workers, 2011 - 2018")+
guides(col = guide_legend(nrow = 4))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom",
legend.title = element_blank())
h2b_all_11_18 <- h2b_all %>%
filter(Year %in% c(2011, 2018))
h2b_all_11_18
h2b_11_18<-
tribble(
~`Job title`, ~`Workers in 2011`, ~`Workers in 2018`,
"Farmworkers and laborers, crop, nursery, and greenhouse workers", 96, 1682,
"Forest and conservation workers", 8259, 11093,
"Recreation workers", 66, 1401,
"Tree trimmers and pruners", 106, 919
)
h2b_11_18<-h2b_11_18 %>%
mutate(`Percent increase` = round(((`Workers in 2018`-`Workers in 2011`)/`Workers in 2011`)*100)) %>%
arrange(desc(`Percent increase`))
knitr::kable((h2b_11_18[]),
caption = 'Increase in H-2B guest workers by job title, 2011 - 2018') %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
h2b_all_11_18 <- h2b_all %>%
filter(Year %in% c(2011, 2018))
h2b_all_11_18
h2b_11_18<-
tribble(
~`Job title`, ~`Workers in 2011`, ~`Workers in 2018`,
"Farmworkers and laborers, crop, nursery, and greenhouse workers", 96, 1682,
"Forest and conservation workers", 8259, 11093,
"Recreation workers", 66, 1401,
"Tree trimmers and pruners", 106, 919
)
h2b_11_18<-h2b_11_18 %>%
mutate(`Percent increase` = round(((`Workers in 2018`-`Workers in 2011`)/`Workers in 2011`)*100)) %>%
arrange(desc(`Percent increase`))
knitr::kable((h2b_11_18[]),
caption = 'Increase in H-2B guest workers by job title, 2011 - 2018') %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
blogdown:::serve_site()
blogdown:::serve_site()
library(tidyverse)
library(readxl)
library(GGally)
library(rgdal)
library(patchwork)
library(usmap)
library(cdlTools)
library(knitr)
library(kableExtra)
h2b_18 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_Disclosure_Data_FY2018_EOY.xlsx")
soc <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\SOC_TITLE.xlsx")
h2b_18_2 <- inner_join(h2b_18,soc)
h2b_18_2.df <- h2b_18_2 %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T))
h2b_18_2.df <- h2b_18_2 %>%
group_by(MY_TITLE, FOR) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
filter(n.workers > 900)
h2b_18_2 %>%
group_by(MY_TITLE, FOR) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
filter(n.workers > 900) %>%
ggplot(aes(reorder(MY_TITLE, n.workers),n.workers, fill = factor(FOR))) +
geom_bar(stat = "identity") +
labs(x = "", y = "Number of certified H-2B guest workers (FY2018)")+
scale_fill_manual(breaks=levels(h2b_18_2$FOR), values=c('black', 'red'))+
coord_flip() +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
h2b_18_2_jobs <- h2b_18_2 %>%
subset(FOR == 1)%>%
group_by(JOB_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(`Job title`= JOB_TITLE) %>%
filter(`Number of workers` > 450) %>%
arrange(desc(`Number of workers`))
knitr::kable((h2b_18_2_jobs[,3:2]),
caption = 'The eight most common forestry job titles listed on H-2B guest worker applications (FY2018)') %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
#
# h2b_18_2 %>%
#   subset(FOR == 1)%>%
#   group_by(JOB_TITLE) %>%
#   summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
#  # filter(n.workers > 900) %>%
#   ggplot(aes(reorder(JOB_TITLE, n.workers),n.workers)) +
#   geom_bar(stat = "identity") +
#   labs(x = "", y = "Number of certified H-2B guest workers (FY2018)", Title = "Job titles for forest and conservation workers (n = 11,093 total guest workers; FY2018)")+
#   scale_fill_manual(breaks=levels(h2b_18_2$FOR), values=c('black', 'red'))+
#   coord_flip() +
#   theme(panel.background = element_rect(fill = "NA"),
#         axis.line = element_line(color="black"),
#         legend.position = "none")
h2b_18_state <- h2b_18_2 %>%
subset(MY_TITLE == "Forest and conservation workers") %>%
group_by(EMPLOYEE_WORK_STATE) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T))
h2b_18_state <- h2b_18_state %>%
mutate(fips = fips(EMPLOYEE_WORK_STATE))
p.fcw<- plot_usmap(data = h2b_18_state, values = "n.workers",
include = c("AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL",
"IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS",
"MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH",
"OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA",
"WA","WV","WI","WY"))+
scale_fill_continuous(low = "white", high = "blue", name = " ",na.value="white", label = scales::comma) +
labs(title = "Forest and conservation workers",
subtitle = "n = 11,093 total guest workers") +
theme(legend.position = "right")
h2b_18_state_fwl <- h2b_18_2 %>%
subset(MY_TITLE == "Farm workers and laborers, crop, nursery, and greenhouse workers") %>%
group_by(EMPLOYEE_WORK_STATE) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T))
h2b_18_state_fwl <- h2b_18_state_fwl %>%
mutate(fips = fips(EMPLOYEE_WORK_STATE))
p.fwl <- plot_usmap(data = h2b_18_state_fwl, values = "n.workers",
include = c("AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL",
"IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS",
"MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH",
"OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA",
"WA","WV","WI","WY"))+
scale_fill_continuous(low = "white", high = "blue", name = " ",na.value="white", label = scales::comma) +
labs(title = "Farm workers and laborers, crop, nursery",
subtitle = "n = 1,682 total guest workers") +
theme(legend.position = "right")
h2b_18_state_rec <- h2b_18_2 %>%
subset(MY_TITLE == "Recreation workers") %>%
group_by(EMPLOYEE_WORK_STATE) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T))
h2b_18_state_rec <- h2b_18_state_rec %>%
mutate(fips = fips(EMPLOYEE_WORK_STATE))
p.rec <- plot_usmap(data = h2b_18_state_rec, values = "n.workers",
include = c("AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL",
"IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS",
"MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH",
"OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA",
"WA","WV","WI","WY"))+
scale_fill_continuous(low = "white", high = "blue", name = " ",na.value="white", label = scales::comma) +
labs(title = "Recreation workers",
subtitle = "n = 1,401 total guest workers") +
theme(legend.position = "right")
h2b_18_state_tree <- h2b_18_2 %>%
subset(MY_TITLE == "Tree trimmers and pruners") %>%
group_by(EMPLOYEE_WORK_STATE) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T))
h2b_18_state_tree <- h2b_18_state_tree %>%
mutate(fips = fips(EMPLOYEE_WORK_STATE))
p.tree <- plot_usmap(data = h2b_18_state_tree, values = "n.workers",
include = c("AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL",
"IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS",
"MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH",
"OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA",
"WA","WV","WI","WY"))+
scale_fill_continuous(low = "white", high = "blue", name = " ",na.value="white", label = scales::comma) +
labs(title = "Tree trimmers and pruners",
subtitle = "n = 919 total guest workers") +
theme(legend.position = "right")
p.all <- p.fcw+p.fwl+p.rec+p.tree
p.all
#All were full time
h2b_18_2 %>%
subset(FOR == 1)%>%
group_by(FULL_TIME_POSITION) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(freq = (n.workers / sum(n.workers))*100) %>%
ggplot(aes(reorder(FULL_TIME_POSITION, freq),freq)) +
geom_bar(stat = "identity") +
labs(x = "Nature of temporary need", y = "Percent of H-2B guest workers", title = "Forest and conservation workers (n = 11,093 total guest workers; FY 2018)")+
scale_fill_manual(breaks=levels(h2b_18_2$FOR), values=c('black', 'red'))+
coord_flip() +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
h2b_18_2 %>%
#subset(MY_TITLE == "Forest and conservation workers")%>%
subset(FOR== 1)%>%
#group_by(FULL_TIME_POSITION) %>%
# summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
#  mutate(freq = (n.workers / sum(n.workers))*100) %>%
ggplot(aes(NUMBER_OF_HOURS )) +
geom_histogram() +
labs(x = "Number of hours per week", y = "Number of H-2B applications", title = "Hours/week for H-2B guest workers in forestry (FY2018)")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
h2b_18_2_num <- h2b_18_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year = 2018)
h2b_18_2_num
h2b_17 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_Disclosure_Data_FY17.xlsx")
h2b_17_2 <- inner_join(h2b_17, soc)
h2b_17_2_num <- h2b_17_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2017)
h2b_17_2_num
h2b_16 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_Disclosure_Data_FY16.xlsx")
h2b_16_2 <- inner_join(h2b_16, soc)
h2b_16_2_num <- h2b_16_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2016)
h2b_16_2_num
h2b_15 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_Disclosure_Data_FY15_Q4.xlsx")
h2b_15_2 <- inner_join(h2b_15, soc)
h2b_15_2_num <- h2b_15_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2015)
h2b_15_2_num
h2b_14 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY14_Q4.xlsx")
h2b_14_2 <- inner_join(h2b_14, soc)
h2b_14_2_num <- h2b_14_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2014)
h2b_14_2_num
h2b_13 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY2013.xls")
h2b_13_2 <- inner_join(h2b_13, soc)
h2b_13_2_num <- h2b_13_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2013)
h2b_13_2_num
h2b_12 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY2012.xlsx")
h2b_12_2 <- inner_join(h2b_12, soc)
h2b_12_2_num <- h2b_12_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2012)
h2b_12_2_num
h2b_11 <- read_excel("C:\\Users\\russellm\\Documents\\Arbor\\Data\\h2b\\H-2B_FY2011.xlsx")
h2b_11_2 <- inner_join(h2b_11, soc)
h2b_11_2_num <- h2b_11_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year=2011)
h2b_11_2_num
h2b_all<-rbind(h2b_18_2_num,h2b_17_2_num,h2b_16_2_num,
h2b_15_2_num,h2b_14_2_num,h2b_13_2_num,
h2b_12_2_num,h2b_11_2_num)
h2b_all2 <- h2b_all %>%
group_by(Year) %>%
summarize(n.all = sum(`Number of workers`))
ggplot(h2b_all2, aes(Year, n.all)) +
geom_point() +
geom_line() +
labs(x = "Year", y = "Number of H-2B guest workers",
title = "H-2B forestry guest workers, 2011 - 2018")+
guides(col = guide_legend(nrow = 4))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom",
legend.title = element_blank())
h2b_all %>%
ggplot(aes(Year,`Number of workers`,  col = MY_TITLE)) +
geom_point() +
geom_line() +
# facet_wrap(~MY_TITLE, ncol=2)+
labs(x = "Year", y = "Number of H-2B guest workers",
title = "H-2B forestry guest workers, 2011 - 2018")+
guides(col = guide_legend(nrow = 4))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom",
legend.title = element_blank())
h2b_all_11_18 <- h2b_all %>%
filter(Year %in% c(2011, 2018))
h2b_all_11_18
h2b_11_18<-
tribble(
~`Job title`, ~`Workers in 2011`, ~`Workers in 2018`,
"Farm workers and laborers, crop, nursery, and greenhouse workers", 96, 1682,
"Forest and conservation workers", 8259, 11093,
"Recreation workers", 66, 1401,
"Tree trimmers and pruners", 106, 919
)
h2b_11_18<-h2b_11_18 %>%
mutate(`Percent increase` = round(((`Workers in 2018`-`Workers in 2011`)/`Workers in 2011`)*100)) %>%
arrange(desc(`Percent increase`))
knitr::kable((h2b_11_18[]),
caption = 'Increase in H-2B guest workers by job title, 2011 - 2018') %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
# Pay is tricky
h2b_18_2_pay <- h2b_18_2 %>%
mutate(BASIC_RATE_OF_PAY_num = as.numeric(gsub("\\$", "", BASIC_RATE_OF_PAY))) %>%
subset(FOR == 1) %>%
subset(PAY_RANGE_UNIT == "Hour") %>%
group_by(MY_TITLE ) %>%
summarize(mean.pay = mean(BASIC_RATE_OF_PAY_num, na.rm=T))
h2b_18_2_pay
h2b_18_2_pay_state <- h2b_18_2 %>%
mutate(BASIC_RATE_OF_PAY_num = as.numeric(gsub("\\$", "", BASIC_RATE_OF_PAY))) %>%
subset(FOR == 1) %>%
group_by(EMPLOYER_STATE ) %>%
summarize(n.apps = n(),
mean.pay = mean(BASIC_RATE_OF_PAY_num, na.rm=T))
h2b_18_2_pay_state
blogdown:::serve_site()
blogdown:::serve_site()
#All were full time
h2b_18_2 %>%
subset(FOR == 1)%>%
group_by(FULL_TIME_POSITION) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(freq = (n.workers / sum(n.workers))*100) %>%
ggplot(aes(reorder(FULL_TIME_POSITION, freq),freq)) +
geom_bar(stat = "identity") +
labs(x = "Nature of temporary need", y = "Percent of H-2B guest workers", title = "Forest and conservation workers (n = 11,093 total guest workers; FY 2018)")+
scale_fill_manual(breaks=levels(h2b_18_2$FOR), values=c('black', 'red'))+
coord_flip() +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
h2b_18_2 %>%
#subset(MY_TITLE == "Forest and conservation workers")%>%
subset(FOR== 1)%>%
#group_by(FULL_TIME_POSITION) %>%
# summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
#  mutate(freq = (n.workers / sum(n.workers))*100) %>%
ggplot(aes(NUMBER_OF_HOURS )) +
geom_histogram() +
labs(x = "Number of hours per week", y = "Number of H-2B applications", title = "Hours/week for H-2B guest workers in forestry (FY2018)")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
h2b_18_2 %>%
#subset(MY_TITLE == "Forest and conservation workers")%>%
subset(FOR== 1)%>%
#group_by(FULL_TIME_POSITION) %>%
# summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
#  mutate(freq = (n.workers / sum(n.workers))*100) %>%
ggplot(aes(NUMBER_OF_HOURS )) +
geom_histogram() +
labs(x = "Number of hours per week", y = "Number of H-2B applications", title = "Hours/week for H-2B guest workers in forestry (FY2018)")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
# Seasonal vs peakload
h2b_18_2 %>%
subset(FOR == 1)%>%
subset(NATURE_OF_TEMPORARY_NEED %in% c("Seasonal", "Peakload"))%>%
group_by(MY_TITLE,NATURE_OF_TEMPORARY_NEED) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(freq = (n.workers / sum(n.workers))*100) %>%
ggplot(aes(reorder(NATURE_OF_TEMPORARY_NEED, freq),freq)) +
geom_bar(stat = "identity") +
facet_wrap(~MY_TITLE, ncol=1)+
labs(x = "Nature of temporary need", y = "Percent of H-2B guest workers", title = "Hiring type of H-2B forestry guest workers; FY2018)")+
scale_fill_manual(breaks=levels(h2b_18_2$FOR), values=c('black', 'red'))+
coord_flip() +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
h2b_18_2_num <- h2b_18_2 %>%
subset(FOR == 1) %>%
group_by(MY_TITLE) %>%
summarize(`Number of workers` = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(Year = 2018)
h2b_18_2_num
h2b_18_2 %>%
#subset(MY_TITLE == "Forest and conservation workers")%>%
subset(FOR== 1)%>%
#group_by(FULL_TIME_POSITION) %>%
# summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
#  mutate(freq = (n.workers / sum(n.workers))*100) %>%
ggplot(aes(NUMBER_OF_HOURS )) +
geom_histogram() +
labs(x = "Number of hours per week", y = "Number of H-2B applications", title = "Hours/week for H-2B guest workers in forestry (FY2018)")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
h2b_18_2 %>%
subset(FOR == 1)%>%
group_by(FULL_TIME_POSITION) %>%
summarize(n.workers = sum(NBR_WORKERS_CERTIFIED, na.rm=T)) %>%
mutate(freq = (n.workers / sum(n.workers))*100) %>%
ggplot(aes(reorder(FULL_TIME_POSITION, freq),freq)) +
geom_bar(stat = "identity") +
labs(x = "Nature of temporary need", y = "Percent of H-2B guest workers", title = "Forest and conservation workers (n = 11,093 total guest workers; FY 2018)")+
scale_fill_manual(breaks=levels(h2b_18_2$FOR), values=c('black', 'red'))+
coord_flip() +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "none")
