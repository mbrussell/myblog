trends_state <- trends_state %>%
mutate(pct_change = ((max_C - min_C)/min_C) * 100)
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep="")) %>%
filter(State == my_STATE_abbr)
trends_state
paste(my_STATE, "forest carbon stocks have increased by",
trends_state$pct_change_round_char,"from 1990 to 2019.")
trends_2017 <- trends %>%
filter(Year == 2017 & State == my_STATE_abbr)
paste("In", my_STATE, ", forests, urban trees, and harvested wood products remove",
round((trends_2017$Flux_MMTCO2 / trends_2017$Emissions_MMTCO2)*100, 0),
"% of all CO2 emissions in the state. Across the US, this value is 14%.")
paste("In", my_STATE, ", forests, urban trees, and harvested wood products store the equivalent of",
round(trends_2017$C_MMT / (trends_2017$Emissions_MMTCO2/3.667), 0),
"years of all CO2 emissions produced in the state.")
trends_new <- trends %>%
filter(StateName == my_STATE)
p.trends <- ggplot(trends_new, aes(Year, C_MMT)) +
geom_point() + geom_line() +
labs(x = "Year", y = "Forest ecosystem carbon\n(million metric tons)",
title = paste("Trends in", my_STATE, "carbon stocks")) +
scale_y_continuous(limits = c (min(trends_new$C_MMT)-(min(trends_new$C_MMT)*0.025),
max(trends_new$C_MMT)+(max(trends_new$C_MMT)*0.025))) +
scale_x_continuous(limits = c (1990, 2021)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom",
plot.margin = margin(0, 0, 0, 0, "cm")) +
guides(col = guide_legend(ncol = 2))
p.trends
trends <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/trends.csv')
trends_state <- trends %>%
group_by(State) %>%
summarize(min_C = first(C_MMT),
max_C = last(C_MMT))
trends_state <- trends_state %>%
mutate(pct_change = ((max_C - min_C)/min_C) * 100)
trends_state <- trends_state %>%
mutate(pct_change_round = round(pct_change, 0),
pct_change_round_char = paste(pct_change_round,"%",sep="")) %>%
filter(State == my_STATE_abbr)
trends_state
paste(my_STATE, "forest carbon stocks have increased by",
trends_state$pct_change_round_char,"from 1990 to 2019.")
trends_2017 <- trends %>%
filter(Year == 2017 & State == my_STATE_abbr)
paste("In", my_STATE, ", forests, urban trees, and harvested wood products remove",
round((trends_2017$Flux_MMTCO2 / trends_2017$Emissions_MMTCO2)*100, 0),
"% of all CO2 emissions in the state. Across the US, this value is 14%.")
paste("In", my_STATE, ", forests, urban trees, and harvested wood products store the equivalent of",
round(trends_2017$C_MMT / (trends_2017$Emissions_MMTCO2/3.667), 0),
"years of all CO2 emissions produced in the state.")
trends_new <- trends %>%
filter(StateName == my_STATE)
p.trends <- ggplot(trends_new, aes(Year, C_MMT)) +
geom_point() + geom_line() +
labs(x = "Year", y = "Forest ecosystem carbon\n(million metric tons)",
title = paste("Trends in", my_STATE, "carbon stocks")) +
scale_y_continuous(limits = c (min(trends_new$C_MMT)-(min(trends_new$C_MMT)*0.025),
max(trends_new$C_MMT)+(max(trends_new$C_MMT)*0.025))) +
scale_x_continuous(limits = c (1990, 2021)) +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "bottom",
plot.margin = margin(0, 0, 0, 0, "cm")) +
guides(col = guide_legend(ncol = 2))
p.trends
storage <- read_csv('C:/Users/russellm/Documents/Arbor/Projects/FRAStateCarbon/Data/storage_state.csv')
storage_amt <- storage %>%
filter(State == my_STATE & ForestTypeGroup == "Total") %>%
mutate(Carbon_UStons = Total * 1.10)
paste("Average carbon density in aboveground trees across", my_STATE, "forests is",
round(storage_amt$Carbon_UStons, 1),"US tons per acre.")
storage_long <- storage %>%
filter(State == my_STATE & ForestTypeGroup == "Total") %>%
select(-Total) %>%
pivot_longer(`0`:`96-100`, names_to= "StandAge", values_to = "Carbon") %>%
mutate(Carbon_UStons = Carbon * 1.10)
# storage_type <- storage_long %>%
#   group_by(HdwdSfwd, StandAge) %>%
#   summarize(mean_Carbon_UStons = mean(Carbon_UStons, na.rm = T)) %>%
#   mutate(HdwdSfwd_name = ifelse(HdwdSfwd == "HW", "Hardwood forests", "Softwood forests"))
storage_type <- storage_long
storage_type$StandAge <- factor(storage_type$StandAge, levels = c("0", "0-5", "6-10", "11-15", "16-20",
"21-25", "26-30", "31-35", "36-40",
"41-45", "46-50", "51-55", "56-60",
"61-65", "66-70", "71-75", "76-80",
"81-85", "86-90", "91-95", "96-100"))
# write_csv(storage_type, "C://Users//russellm//Documents//c_storage_mn.csv")
p.storage <- ggplot(storage_type, aes(StandAge, Carbon_UStons)) +
geom_bar(stat="identity", col = "black", fill = "lightblue") +
scale_x_discrete(limits=storage_type$StandAge,breaks=storage_type$StandAge[seq(1,length(storage_type$StandAge),by=2)])+
labs(x = "Stand age (years)", y = "Average carbon storage \n(US tons per acre)",
title = paste("Carbon storage in", my_STATE))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
strip.text = element_text(size=10),
strip.background = element_rect(fill="white"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(size = 8, angle = 45, vjust = 0.5, color = "black"),
#plot.margin = margin(0, 0, 0, 0, "cm")
)
p.storage
sequest <- storage %>%
mutate(`0 ` = 0,
`0-5 ` = -1*(`0-5` / 5),
`6-10 ` = -1*((`6-10` - `0-5`) / 5),
`11-15 ` = -1*((`11-15` - `6-10`) / 5),
`16-20 ` = -1*((`16-20` - `11-15`) / 5),
`21-25 ` = -1*((`21-25` - `16-20`) / 5),
`26-30 ` = -1*((`26-30` - `21-25`) / 5),
`31-35 ` = -1*((`31-35` - `26-30`) / 5),
`36-40 ` = -1*((`36-40` - `31-35`) / 5),
`41-45 ` = -1*((`41-45` - `36-40`) / 5),
`46-50 ` = -1*((`46-50` - `41-45`) / 5),
`51-55 ` = -1*((`51-55` - `46-50`) / 5),
`56-60 ` = -1*((`56-60` - `51-55`) / 5),
`61-65 ` = -1*((`61-65` - `56-60`) / 5),
`66-70 ` = -1*((`66-70` - `61-65`) / 5),
`71-75 ` = -1*((`71-75` - `66-70`) / 5),
`76-80 ` = -1*((`76-80` - `71-75`) / 5),
`81-85 ` = -1*((`81-85` - `76-80`) / 5),
`86-90 ` = -1*((`86-90` - `81-85`) / 5),
`91-95 ` = -1*((`91-95` - `86-90`) / 5),
`96-100 ` = -1*((`96-100` - `91-95`) / 5))
sequest_long <- sequest %>%
filter(State == my_STATE & ForestTypeGroup == "Total") %>%
select(-c(Total, `0`:`96-100`)) %>%
pivot_longer(`0 `:`96-100 `, names_to= "StandAge", values_to = "Carbon") %>%
mutate(Carbon_UStons = Carbon * 1.10)
# sequest_type <- sequest_long %>%
#   group_by(HdwdSfwd, StandAge) %>%
#   summarize(mean_Carbon_UStons = mean(Carbon_UStons, na.rm = T)) %>%
#   mutate(HdwdSfwd_name = ifelse(HdwdSfwd == "HW", "Hardwood forests", "Softwood forests"))
sequest_type <- sequest_long
sequest_type$StandAge <- factor(sequest_type$StandAge, c("0 ", "0-5 ", "6-10 ", "11-15 ", "16-20 ",
"21-25 ", "26-30 ", "31-35 ", "36-40 ",
"41-45 ", "46-50 ", "51-55 ", "56-60 ",
"61-65 ", "66-70 ", "71-75 ", "76-80 ",
"81-85 ", "86-90 ", "91-95 ", "96-100 "))
sequest_type$StandAge_num <- 1:21
#write_csv(sequest_type, "C://Users//russellm//Documents//c_sequest_mn.csv")
p.sequest<- ggplot(sequest_type, aes(StandAge, Carbon_UStons, group = 1)) +
geom_point() +
stat_smooth(span = 1, se = F) +
scale_y_reverse() +
scale_x_discrete(limits=sequest_type$StandAge,breaks=sequest_type$StandAge[seq(1,length(sequest_type$StandAge),by=2)])+
labs(x = "Stand age (years)", y = "Average carbon sequestration \n(US tons per acre per year)",
title = paste("Carbon sequestration in", my_STATE_abbr))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
strip.text = element_text(size=10),
strip.background = element_rect(fill="white"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(size = 8, angle = 45, vjust = 0.5, color = "black"),
#plot.margin = margin(0, 0, 0, 0, "cm")
)
p.sequest
6+4.2=5.17
6+4.2+5.17
4.02+2.13+3+6.19
blogdown:::new_post_addin()
blogdown:::serve_site()
options(scipen=10000)
library(tidyverse)
library(knitr)
library(formattable)
library(kableExtra)
# Make a NAICS Code table
NAICS <- tribble(
~NAICSCode, ~IndustryTitle, ~IndustryCat, ~NAICSName, ~n_bus,
1131, "Agriculture, Forestry, Fishing and Hunting",	"Timber Tract Operations", "Timber Tract Operations", 2067,
113110,"Agriculture, Forestry, Fishing and Hunting", "Timber Tract Operations", "Timber Tract Operations", 2067,
1132, "Agriculture, Forestry, Fishing and Hunting",	"Forest Nurseries and Gathering of Forest Products", "Forest Nurseries and Gathering of Forest Products", 962,
113210, "Agriculture, Forestry, Fishing and Hunting",	"Forest Nurseries and Gathering of Forest Products", "Forest Nurseries and Gathering of Forest Products", 962,
1133, "Agriculture, Forestry, Fishing and Hunting",	"Logging", "Logging", 8250,
113310, "Agriculture, Forestry, Fishing and Hunting",	"Logging", "Logging", 8250,
1153,"Agriculture, Forestry, Fishing and Hunting",	"Support Activities for Forestry", "Support Activities for Forestry", 5277,
115310,"Agriculture, Forestry, Fishing and Hunting",	"Support Activities for Forestry", "Support Activities for Forestry", 5277,
3211, "Manufacturing",	"Sawmills and Wood Preservation",	"Sawmills and Wood Preservation",3120,
321113, "Manufacturing",	"Sawmills and Wood Preservation","Sawmills",	2480,
321114, "Manufacturing", "Sawmills and Wood Preservation",	"Wood Preservation",	640,
3212, "Manufacturing", "Veneer, Plywood, and Engineered Wood Product Manufacturing",	"Veneer, Plywood, and Engineered Wood Product Manufacturing",	1617,
321211, "Manufacturing", "Veneer, Plywood, and Engineered Wood Product Manufacturing",	"Hardwood Veneer and Plywood Manufacturing",	299,
321212, "Manufacturing", "Veneer, Plywood, and Engineered Wood Product Manufacturing",	"Softwood Veneer and Plywood Manufacturing",	80,
321213, "Manufacturing", "Veneer, Plywood, and Engineered Wood Product Manufacturing",	"Engineered Wood Member (except Truss) Manufacturing",	58,
321214, "Manufacturing", "Veneer, Plywood, and Engineered Wood Product Manufacturing",	"Truss Manufacturing",	869,
321219, "Manufacturing", "Veneer, Plywood, and Engineered Wood Product Manufacturing",	"Reconstituted Wood Product Manufacturing",	311,
3219, "Manufacturing",	"Other Wood Product Manufacturing", "Other Wood Product Manufacturing",	26742,
321911, "Manufacturing", "Other Wood Product Manufacturing", "Wood Window and Door Manufacturing",	1259,
321912, "Manufacturing", "Other Wood Product Manufacturing", "Cut Stock, Resawing Lumber, and Planing",	1225,
321918, "Manufacturing", "Other Wood Product Manufacturing", "Other Millwork (including Flooring)",	14687,
321920, "Manufacturing", "Other Wood Product Manufacturing", "Wood Container and Pallet Manufacturing",	3383,
321991, "Manufacturing", "Other Wood Product Manufacturing", "Manufactured Home (Mobile Home) Manufacturing",	570,
321992, "Manufacturing", "Other Wood Product Manufacturing", "Prefabricated Wood Building Manufacturing",	1111,
321999, "Manufacturing", "Other Wood Product Manufacturing",	"All Other Miscellaneous Wood Product Manufacturing",	4507,
3221, "Manufacturing",	"Pulp, Paper, and Paperboard Mills", "Pulp, Paper, and Paperboard Mills",	2956,
322110, "Manufacturing", "Pulp, Paper, and Paperboard Mills",	"Pulp Mills",	343,
322121, "Manufacturing", "Pulp, Paper, and Paperboard Mills",	"Paper (except Newsprint) Mills",	1921,
322122, "Manufacturing", "Pulp, Paper, and Paperboard Mills",	"Newsprint Mills",	34,
322130, "Manufacturing", "Pulp, Paper, and Paperboard Mills", "Paperboard Mills",	658,
3222, "Manufacturing", "Converted Paper Product Manufacturing", "Converted Paper Product Manufacturing",	6059,
322211, "Manufacturing", "Converted Paper Product Manufacturing", "Corrugated and Solid Fiber Box Manufacturing",	1852,
322212, "Manufacturing", "Converted Paper Product Manufacturing", "Folding Paperboard Box Manufacturing",	147,
322219, "Manufacturing", "Converted Paper Product Manufacturing", "Other Paperboard Container Manufacturing",	663,
322220, "Manufacturing", "Converted Paper Product Manufacturing", "Paper Bag and Coated and Treated Paper Manufacturing",	1471,
322230, "Manufacturing", "Converted Paper Product Manufacturing", "Stationery Product Manufacturing",	412,
322291, "Manufacturing", "Converted Paper Product Manufacturing", "Sanitary Paper Product Manufacturing",	374,
322299, "Manufacturing", "Converted Paper Product Manufacturing", "All Other Converted Paper Product Manufacturing",	1140
)
# Make a list of NAICS codes
NAICS_list <- c(1133,
113310,
1132,
113210,
1133,
113310,
1153,
115310,
3211,
321113,
321114,
3212,
321211,
321212,
321213,
321214,
321219,
3219,
321911,
321912,
321918,
321920,
321991,
321992,
321999,
3221,
322110,
322121,
322122,
322130,
3222,
322211,
322212,
322219,
322220,
322230,
322291,
322299)
# Read in data from US SBA website
# Data last updated January 2022
public_up_to_150k_1 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/af49f823-84da-4900-8a29-14d37783312c/download/public_up_to_150k_1_220102.csv')
public_up_to_150k_1 <- public_up_to_150k_1 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_2 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/7dd5066e-587b-4e7f-97d6-aeeb8d43e95e/download/public_up_to_150k_2_220102.csv')
public_up_to_150k_2 <- public_up_to_150k_2 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_3 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/87226a98-ab63-4d24-8c13-862dc4e231ce/download/public_up_to_150k_3_220102.csv')
public_up_to_150k_3 <- public_up_to_150k_3 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_4 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/9fc51bda-fb7f-4e60-a768-9f872bc97e20/download/public_up_to_150k_4_220102.csv')
public_up_to_150k_4 <- public_up_to_150k_4 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_5 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/3c6c0c0e-ed9f-478f-a6f4-56e0c7819a9d/download/public_up_to_150k_5_220102.csv')
public_up_to_150k_5 <- public_up_to_150k_5 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_6 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/de046832-58bb-4239-ac46-e17d42352126/download/public_up_to_150k_6_220102.csv')
public_up_to_150k_6 <- public_up_to_150k_6 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_7 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/77531198-8895-4bf2-ba25-cf0b74449545/download/public_up_to_150k_7_220102.csv')
public_up_to_150k_7 <- public_up_to_150k_7 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_8 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/0ac12ffc-0502-4655-81ff-a479b4302ee7/download/public_up_to_150k_8_220102.csv')
public_up_to_150k_8 <- public_up_to_150k_8 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_9 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/0b2cbc69-9a58-4b28-8fd6-3426243b8f90/download/public_up_to_150k_9_220102.csv')
public_up_to_150k_9 <- public_up_to_150k_9 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_10 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/0e8a121f-3baa-4b7e-ba71-466b867dcae8/download/public_up_to_150k_10_220102.csv')
public_up_to_150k_10 <- public_up_to_150k_10 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_11 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/23cbab5f-781d-498c-b7d7-7604d5cb6bde/download/public_up_to_150k_11_220102.csv')
public_up_to_150k_11 <- public_up_to_150k_11 %>%
filter(NAICSCode %in% NAICS_list)
public_up_to_150k_12 <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/809345ac-f85d-487e-b07b-f9a34064564d/download/public_up_to_150k_12_220102.csv')
public_up_to_150k_12 <- public_up_to_150k_12 %>%
filter(NAICSCode %in% NAICS_list)
# BIG
public_150k_plus <- read_csv('https://data.sba.gov/dataset/8aa276e2-6cab-4f86-aca4-a7dde42adf24/resource/c84fa84d-c047-4b66-8056-5748f6a2bfca/download/public_150k_plus_220102.csv')
public_150k_plus <- public_150k_plus %>%
filter(NAICSCode %in% NAICS_list)
head(ppp)
# Combine all PPP loan data and join to NAICS code table
ppp <- rbind(public_up_to_150k_1,
public_up_to_150k_2,
public_up_to_150k_3,
public_up_to_150k_4,
public_up_to_150k_5,
public_up_to_150k_6,
public_up_to_150k_7,
public_up_to_150k_8,
public_up_to_150k_9,
public_up_to_150k_10,
public_up_to_150k_11,
public_up_to_150k_12,
public_150k_plus)
ppp <- inner_join(ppp, NAICS)
head(ppp)
ls <- ppp %>%
filter(NAICSCode %in% c(1133, 113310) )
head(ls)
View(ls)
ls <- ppp %>%
filter(NAICSCode %in% c(1133, 113310) & BorrowerState %in% c("MI", "WI", "MN"))
View(ls)
mean_ls <- ls %>%
summarize(mean_loan = mean(LoanAmount),
mean_jobs = mean(JobsReported, na.rm=T))
View(ls)
mean_ls <- ls %>%
summarize(mean_loan = mean(CurrentApprovalAmountAmount),
mean_jobs = mean(JobsReported, na.rm=T))
mean_ls <- ls %>%
summarize(mean_loan = mean(CurrentApprovalAmount),
mean_jobs = mean(JobsReported, na.rm=T))
mean_ls
p.numloans <- ggplot(ls, aes(LoanAmount))+
geom_histogram(bins = 15, fill="cyan", col = "black")+
labs(y = "Number of PPP loans",
x = "Loan amount ($)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none")
p.numloans
p.numloans <- ggplot(ls, aes(CurrentApprovalAmount))+
geom_histogram(bins = 15, fill="cyan", col = "black")+
labs(y = "Number of PPP loans",
x = "Loan amount ($)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none")
p.numloans
p.numloans <- ggplot(ls, aes(CurrentApprovalAmount))+
geom_histogram(bins = 15, fill="cyan", col = "black")+
facet_wrap(~BorrowerState) +
labs(y = "Number of PPP loans",
x = "Loan amount ($)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none")
p.numloans
p.numloans <- ggplot(ls, aes(CurrentApprovalAmount/1000))+
geom_histogram(bins = 15, fill="cyan", col = "black")+
facet_wrap(~BorrowerState) +
labs(y = "Number of PPP loans",
x = "Loan amount ($, in thousands)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none")
p.numloans
ls_names <- tribble(
~BorrowerState, ~BorrowerStateName,
"MI", "Michigan",
"MN", "Minnesota",
"WI", "Wisconsin"
)
ls <- ppp %>%
filter(NAICSCode %in% c(1133, 113310) & BorrowerState %in% c("MI", "WI", "MN"))
mean_ls <- ls %>%
summarize(mean_loan = mean(CurrentApprovalAmount),
mean_jobs = mean(JobsReported, na.rm=T))
ls_names <- tribble(
~BorrowerState, ~BorrowerStateName,
"MI", "Michigan",
"MN", "Minnesota",
"WI", "Wisconsin"
)
ls <- inner_join(ls, ls_names)
p.numloans <- ggplot(ls, aes(CurrentApprovalAmount/1000))+
geom_histogram(bins = 15, fill="cyan", col = "black")+
facet_wrap(~BorrowerStateName) +
labs(y = "Number of PPP loans",
x = "Loan amount ($, in thousands)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none")
p.numloans
p.jobs<- ggplot(ls, aes(JobsReported, CurrentApprovalAmount/1000)) +
geom_point() +
geom_smooth() +
labs(y = "Loan amount ($, thousands)",
x = "Number of jobs reported") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none")
p.jobs
ls <- ppp %>%
filter(NAICSCode %in% c(1133, 113310) & BorrowerState %in% c("MI", "WI", "MN") & JobsReported < 100)
mean_ls <- ls %>%
summarize(mean_loan = mean(CurrentApprovalAmount),
mean_jobs = mean(JobsReported, na.rm=T))
mean_ls
sum(ls$CurrentApprovalAmount)
ls <- ppp %>%
filter(NAICSCode %in% c(1133, 113310) & BorrowerState %in% c("MI", "WI", "MN") & JobsReported < 100)
mean_ls <- ls %>%
summarize(mean_loan = mean(CurrentApprovalAmount),
mean_jobs = mean(JobsReported, na.rm=T))
sum(ls$CurrentApprovalAmount)
ls_names <- tribble(
~BorrowerState, ~BorrowerStateName,
"MI", "Michigan",
"MN", "Minnesota",
"WI", "Wisconsin"
)
ls <- inner_join(ls, ls_names)
p.numloans <- ggplot(ls, aes(CurrentApprovalAmount/1000))+
geom_histogram(bins = 15, fill="cyan", col = "black")+
facet_wrap(~BorrowerStateName) +
labs(y = "Number of PPP loans",
x = "Loan amount ($, in thousands)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none")
p.numloans
p.jobs<- ggplot(ls, aes(JobsReported, CurrentApprovalAmount/1000)) +
geom_point() +
geom_smooth() +
labs(y = "Loan amount ($, thousands)",
x = "Number of jobs reported") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text = element_text(color = "black"),
legend.title = element_blank(),
legend.key=element_blank(),
legend.position = "none")
p.jobs
mean_ls <- ls %>%
group_by(LoanRange) %>%
summarize(n_loans = n())
View(ls)
ls_city_all<- tibble(City = c(ls$BorrowerCity))
ls_city2 <- ls_city_all %>%
mutate(CITY = str_to_upper(City, locale = "en")) %>%
group_by(CITY) %>%
summarize(n_city = n())
ls_city3 <- ls_city2 %>%
rename(`Number of loans` = n_city) %>%
filter(`Number of loans` >= 5) %>%
arrange(desc(`Number of loans`))
ls_city3 %>%
kable("html", caption = 'Number of PPP loans offered to logging businesses in Maine cities.') %>%
kable_styling()
ls_city_all<- tibble(City = c(ls$BorrowerCity),
State = c(ls$BorrowerState))
ls_city2 <- ls_city_all %>%
mutate(CITY = str_to_upper(paste(City, State), locale = "en")) %>%
group_by(CITY) %>%
summarize(n_city = n())
ls_city3 <- ls_city2 %>%
rename(`Number of loans` = n_city) %>%
filter(`Number of loans` >= 5) %>%
arrange(desc(`Number of loans`))
ls_city3 %>%
kable("html", caption = 'Number of PPP loans offered to logging businesses in Maine cities.') %>%
kable_styling()
ls_city_all<- tibble(City = c(ls$BorrowerCity),
State = c(ls$BorrowerState))
ls_city2 <- ls_city_all %>%
mutate(CITY = str_to_upper(paste(City, ",", State), locale = "en")) %>%
group_by(CITY) %>%
summarize(n_city = n())
ls_city3 <- ls_city2 %>%
rename(`Number of loans` = n_city) %>%
filter(`Number of loans` >= 5) %>%
arrange(desc(`Number of loans`))
ls_city3 %>%
kable("html", caption = 'Number of PPP loans offered to logging businesses in Maine cities.') %>%
kable_styling()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
