tree <- tree %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH),
l_AG_DW = log2(AG_DW))
tree_mod <- lm(l_AG_DW ~ l_ST_OB_D_BH, data = tree)
summary(tree_mod)
grid <- tree %>%
data_grid(ST_OB_D_BH = seq_range(ST_OB_D_BH, 20)) %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH)) %>%
add_predictions(tree_mod, "l_AG_DW") %>%
mutate(AG_DW = 2 ^ l_AG_DW)
ggplot(tree, aes(ST_OB_D_BH, AG_DW)) +
geom_hex(bins = 20) +
geom_line(data = grid, color = "red", size = 1) +
labs(x = "Diameter at breast height (inches)",
y = "Aboveground dry weight (pounds)")
grid <- tree %>%
data_grid(ST_OB_D_BH = seq_range(ST_OB_D_BH, 20)) %>%
mutate(l_ST_OB_D_BH = log2(ST_OB_D_BH)) %>%
add_predictions(tree_mod, "l_AG_DW") %>%
mutate(AG_DW = 2 ^ l_AG_DW)
tree_coef<- tree %>%
group_by(Species) %>%
do(broom::tidy(lm(l_AG_DW ~ l_ST_OB_D_BH, .)))
tree_coef
ggplot(tree_coef, aes(estimate, 1)) +
geom_point() +
geom_errorbarh(aes(xmin = estimate - (2*std.error),
xmax = estimate + (2*std.error),
height = 0.5)) +
scale_y_continuous(limits = c(0,2))+
facet_grid(term~Species)+
labs(x = "Coefficient", y = " ")+
ggtitle("Coefficients for determining aboveground dry weight \n(+/- two standard errors) for seven tree species")+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())
by_spp <- tree %>%
group_by(Species) %>%
nest()
species_model <- function(df){
lm(l_AG_DW ~ l_ST_OB_D_BH, data = df)
}
models <- map(by_spp$data, species_model)
by_spp <- by_spp %>%
mutate(model = map(data, species_model))
by_spp
by_spp <- by_spp %>%
mutate(preds = map2(data, model, add_predictions))
by_spp
ggplot(tree_coef, aes(estimate, 1)) +
geom_point() +
geom_errorbarh(aes(xmin = estimate - (2*std.error),
xmax = estimate + (2*std.error),
height = 0.5)) +
scale_y_continuous(limits = c(0,2))+
facet_grid(term~Species)+
labs(x = "Coefficient", y = " ")+
ggtitle("Coefficients for determining aboveground dry weight \n(+/- two standard errors) for seven tree species")+
theme(axis.text.y = element_blank(),
axis.ticks.y = element_blank())
by_spp <- tree %>%
group_by(Species) %>%
nest()
species_model <- function(df){
lm(l_AG_DW ~ l_ST_OB_D_BH, data = df)
}
models <- map(by_spp$data, species_model)
by_spp <- by_spp %>%
mutate(model = map(data, species_model))
by_spp
by_spp <- by_spp %>%
mutate(preds = map2(data, model, add_predictions))
by_spp
preds <- unnest(by_spp, preds)
preds %>%
mutate(tpred = 2 ^ pred) %>%
ggplot(aes(ST_OB_D_BH, tpred)) +
geom_line(aes(group = Species), size = 1) +
#geom_smooth(se = F) +
labs(x = "Diameter at breast height (inches)",
y = "Predicted aboveground\ndry weight (pounds)")+
facet_wrap(~ Species)
preds %>%
mutate(tpred = 2 ^ pred) %>%
ggplot(aes(ST_OB_D_BH, tpred)) +
geom_line(aes(group = Species), size = 1) +
geom_smooth(se = F) +
labs(x = "Diameter at breast height (inches)",
y = "Predicted aboveground\ndry weight (pounds)")+
facet_wrap(~ Species)
preds %>%
mutate(tpred = 2 ^ pred) %>%
ggplot(aes(ST_OB_D_BH, tpred)) +
geom_line(aes(group = Species), size = 1) +
geom_smooth() +
labs(x = "Diameter at breast height (inches)",
y = "Predicted aboveground\ndry weight (pounds)")+
facet_wrap(~ Species)
preds <- unnest(by_spp, preds)
preds %>%
mutate(tpred = 2 ^ pred) %>%
ggplot(aes(ST_OB_D_BH, tpred)) +
geom_line(aes(group = Species), size = 1) +
labs(x = "Diameter at breast height (inches)",
y = "Predicted aboveground\ndry weight (pounds)")+
facet_wrap(~ Species)
preds
by_spp <- by_spp %>%
mutate(resids = map2(data, model, add_residuals))
by_spp
resids <- unnest(by_spp, resids)
resids %>%
ggplot(aes(ST_OB_D_BH, resid)) +
geom_point(aes(group = Species), alpha = 1/3) +
geom_smooth(se = F) +
labs(x = "Diameter at breast height (inches)",
y = "Residual")+
geom_abline(intercept = 0, slope = 0, color = "pink")+
facet_wrap(~Species)
by_spp <- tree %>%
group_by(Species) %>%
nest()
species_model <- function(df){
lm(l_AG_DW ~ l_ST_OB_D_BH, data = df)
}
models <- map(by_spp$data, species_model)
by_spp <- by_spp %>%
mutate(model = map(data, species_model))
by_spp
glance <- by_spp %>%
mutate(glance = map(model, broom::glance)) %>%
unnest(glance, .drop = T)
glance <- by_spp %>%
mutate(glance = map(model, broom::glance)) %>%
unnest(glance, .drop = T)
glance <- by_spp %>%
mutate(glance = map(model, broom::glance)) %>%
unnest(glance, .drop = T)
glance <- by_spp %>%
mutate(glance = map(model, broom::glance)) %>%
unnest(glance, .drop = T)
glance %>%
arrange(desc(r.squared))
glance %>%
ggplot(aes(reorder(Species, r.squared), r.squared)) +
geom_bar(stat = "identity")+
coord_flip()+
geom_smooth(se = F) +
labs(x = " ",
y = "R-squared")+
theme(legend.position = "none")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
library(tidyverse)
# Chunk 1
library(tidyverse)
# Chunk 2
res <-
tribble(
~Type, ~Year, ~Num,
"Forest industry", 2002, 124,
"Forest industry", 2016, 62,
"Universities",	2002, 1361,
"Universities",	2016, 1224,
"US Forest Service",	2002, 618,
"US Forest Service",	2016, 500
)
p.res <- ggplot(res, aes(Year, Num, fill=Type)) +
geom_line() +
geom_point() +
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res
p.res <- ggplot(res, aes(Year, Num, col=Type)) +
geom_line() +
geom_point() +
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res
p.res <- ggplot(res, aes(Year, Num, col=Type, shape = Type)) +
geom_line() +
geom_point() +
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res
p.res2 <- ggplot(res, aes(Type, Num, fill = Year)) +
geom_bar(stat = "identity")+
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = Year)) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = "Year", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "bottom")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "left")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right")
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
axis.text = element_text(size=12, col = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
axis.text = element_text(size=12, color = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
axis.text = element_text(size=12, color = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=12, color = "black"),
axis.text = element_text(size=12, color = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry resesearchers has declined by 15% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
scale_fill_brewer(palette="Dark2")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=13, color = "black"),
axis.text = element_text(size=12, color = "black"))
p.res2
# p.res <- ggplot(res, aes(Year, Num, col=Type, shape = Type)) +
#          geom_line() +
#          geom_point() +
#   labs(x = "Year", y = "Forest scientists",
#        title = "The number of forestry resesearchers has declined by 15% since 2002.")+
#     theme(panel.background = element_rect(fill = "NA"),
#         axis.line = element_line(color="black"),
#         legend.position = "bottom")
# p.res
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry researchers has declined by 12% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
scale_fill_brewer(palette="Dark2")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=13, color = "black"),
axis.text = element_text(size=12, color = "black"))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry researchers has declined by 12% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
scale_fill_brewer(palette="Dark2")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=13, color = "black"),
axis.text = element_text(size=12, color = "black"),
axis.title.x = element_text(size = 13))
p.res2
p.res2 <- ggplot(res, aes(Type, Num, fill = factor(Year))) +
geom_bar(stat = "identity", position = "dodge2")+
labs(x = " ", y = "Forest scientists",
title = "The number of forestry researchers has declined by 12% since 2002.",
caption = "Source: McGinley et al. 2020, Journal of Forestry",
fill = " ")+
scale_fill_brewer(palette="Dark2")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
legend.position = "right",
legend.text = element_text(size=13, color = "black"),
axis.text = element_text(size=12, color = "black"),
axis.title.y = element_text(size = 13))
p.res2
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
library(tidyverse)
library(patchwork)
vol<-read_csv("C:\\Users\\russellm\\Documents\\Arbor\\Data\\volume.csv")
vol <- vol %>%
mutate(GS_Volume_bf = GS_Volume_cuft * 12,
GS_Volume_cds = GS_Volume_bf/500)
vol.aspen <- vol %>%
filter(Type == "Aspen")
p.cds <- ggplot(vol.aspen, aes(GS_Volume_cds, Carbon)) +
geom_line(col = "grey") +
geom_point() +
scale_y_continuous(limits = c(0, 62))+
labs(y = "Carbon per acre \n(Metric tons)", x = "Cords per acre")+
annotate("text", x = 16, y = 60, label = "Aspen", size = 7)+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
p.cds
# Chunk 1
library(tidyverse)
library(patchwork)
# Chunk 2
vol<-read_csv("C:\\Users\\russellm\\Documents\\Arbor\\Data\\volume.csv")
# Chunk 3
vol <- vol %>%
mutate(GS_Volume_bf = GS_Volume_cuft * 12,
GS_Volume_cds = GS_Volume_bf/500)
# Chunk 4
vol.aspen <- vol %>%
filter(Type == "Aspen")
p.cds <- ggplot(vol.aspen, aes(GS_Volume_cds, Carbon)) +
geom_line(col = "grey") +
geom_point() +
scale_y_continuous(limits = c(0, 62))+
labs(y = "Carbon per acre \n(Metric tons)", x = "Cords per acre")+
annotate("text", x = 16, y = 60, label = "Aspen", size = 7)+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
#p.cds
# Chunk 5
vol.rp <- vol %>%
filter(Type == "Red pine") %>%
mutate(GS_Volume_bf_MBF = GS_Volume_bf/1000)
p.bf <- ggplot(vol.rp, aes(GS_Volume_bf_MBF, Carbon)) +
geom_line(col = "red") +
geom_point() +
scale_y_continuous(limits = c(0, 62))+
labs(y = " ", x = "Board feet per acre (MBF)")+
annotate("text", x = 20, y = 60, label = "Red pine", size = 7)+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
#p.bf
# Chunk 6
p.vol <- p.cds + p.bf
p.vol
# Chunk 7
plot<-read_csv("C:\\Users\\russellm\\Documents\\Arbor\\Data\\cfc_plot.csv")
# Chunk 1
library(tidyverse)
library(patchwork)
# Chunk 2
vol<-read_csv("C:\\Users\\russellm\\Documents\\Arbor\\Data\\volume.csv")
# Chunk 3
vol <- vol %>%
mutate(GS_Volume_bf = GS_Volume_cuft * 12,
GS_Volume_cds = GS_Volume_bf/500)
# Chunk 4
vol.aspen <- vol %>%
filter(Type == "Aspen")
p.cds <- ggplot(vol.aspen, aes(GS_Volume_cds, Carbon)) +
geom_line(col = "grey") +
geom_point() +
scale_y_continuous(limits = c(0, 62))+
labs(y = "Carbon per acre \n(Metric tons)", x = "Cords per acre")+
annotate("text", x = 16, y = 60, label = "Aspen", size = 7)+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
#p.cds
# Chunk 5
vol.rp <- vol %>%
filter(Type == "Red pine") %>%
mutate(GS_Volume_bf_MBF = GS_Volume_bf/1000)
p.bf <- ggplot(vol.rp, aes(GS_Volume_bf_MBF, Carbon)) +
geom_line(col = "red") +
geom_point() +
scale_y_continuous(limits = c(0, 62))+
labs(y = " ", x = "Board feet per acre (MBF)")+
annotate("text", x = 20, y = 60, label = "Red pine", size = 7)+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
#p.bf
# Chunk 6
p.vol <- p.cds + p.bf
p.vol
# Chunk 7
plot<-read_csv("C:\\Users\\russellm\\Documents\\Arbor\\Data\\cfc_plot.csv")
# Red pine is cover type = 2, Aspen is cover type = 60
plot <- plot %>%
filter(STAND_PLOT_COVE %in% c(2, 60)) %>%
mutate(Cover_name = ifelse(STAND_PLOT_COVE == 2, "Red pine", "Aspen"),
GS_Volume_bf = CFVolAcre * 12,
GS_Volume_cds = GS_Volume_bf/500)
p.vol <- ggplot(plot, aes(Cover_name, CFVolAcre)) +
geom_violin() +
labs(y = "Volume per acre (Cubic feet)", x = "Cover type")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
plot.aspen <- plot %>%
filter(STAND_PLOT_COVE == 60,
CFVolAcre > 50,
CFVolAcre <5000,
StandID != 201) %>%
mutate(Carbon = GS_Volume_cds * 0.77,
Cds_Seq = GS_Volume_cds/STAND_AGE,
Carbon_Seq = Carbon/STAND_AGE)
plot_aspen <- plot.aspen %>%
group_by(Cover_name) %>%
summarize(num.plots = n(),
mean.cds = mean(GS_Volume_cds, na.rm = T),
mean.age = mean(STAND_AGE, na.rm = T),
mean.bf = mean(GS_Volume_bf, na.rm = T),
mean.C = mean(Carbon, na.rm = T),
mean.Cds_Seq = mean (Cds_Seq, na.rm = T),
mean.Carbon_Seq = mean(Carbon_Seq, na.rm = T))
plot.redpine <- plot %>%
filter(STAND_PLOT_COVE == 2) %>%
mutate(Carbon = GS_Volume_bf * 0.0015)
plot_red <- plot.redpine %>%
group_by(Cover_name) %>%
summarize(num.plots = n(),
mean.cds = mean(GS_Volume_cds, na.rm = T),
mean.bf = mean(GS_Volume_bf, na.rm = T),
mean.C = mean(Carbon, na.rm = T))
p.vol.aspen <- ggplot(plot.aspen, aes(Cover_name, GS_Volume_cds)) +
geom_violin() +
labs(y = "Cords per acre", x = "Cover type")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
p.C.aspen <- ggplot(plot.aspen, aes(Cover_name, Carbon)) +
geom_violin(fill = "grey") + geom_jitter() +
labs(y = "Carbon per acre \n(Metric tons)", x = " ")+
scale_y_continuous(limits = c(0, 200))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"),
axis.text.x = element_text(size = 16))
p.vol.redpine <- ggplot(plot.redpine, aes(Cover_name, GS_Volume_bf/1000)) +
geom_violin(fill = "red") + geom_jitter()+
labs(y = "Board feet per acre (MBF)", x = "Cover type")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"))
p.C.redpine <- ggplot(plot.redpine, aes(Cover_name, Carbon)) +
geom_violin(fill = "red") + geom_jitter()+
scale_y_continuous(limits = c(0, 200))+
labs(y = " ", x = " ")+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color = "black"),
axis.text.x = element_text(size = 16))
p.all <-  p.C.aspen + p.C.redpine
p.all
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
