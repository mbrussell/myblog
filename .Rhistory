theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 3, col = "red")+
geom_abline(intercept = 30, slope = 3, col = "orange") +
geom_abline(intercept = 40, slope = 3, col = "black") +
geom_abline(intercept = 50, slope = 3, col = "green") +
geom_abline(intercept = 60, slope = 3, col = "blue") +
geom_abline(intercept = 70, slope = 3, col = "violet") +
labs(title = "Random intercept",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 150))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
# Chunk 2
ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 30, slope = 0.5, col = "red")+
geom_abline(intercept = 30, slope = 2, col = "orange") +
geom_abline(intercept = 30, slope = 3, col = "black") +
geom_abline(intercept = 30, slope = 5, col = "green") +
geom_abline(intercept = 30, slope = 7, col = "blue") +
geom_abline(intercept = 30, slope = 10, col = "violet") +
labs(title = "Random slope",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
# Chunk 3
ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 0.5, col = "red")+
geom_abline(intercept = 30, slope = 2, col = "orange") +
geom_abline(intercept = 40, slope = 3, col = "black") +
geom_abline(intercept = 50, slope = 5, col = "green") +
geom_abline(intercept = 60, slope = 7, col = "blue") +
geom_abline(intercept = 70, slope = 10, col = "violet") +
labs(title = "Random slope and intercept",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
# Chunk 4
library(patchwork)
# Nested - subject i
p.i <- ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 3, col = "red")+
geom_abline(intercept = 60, slope = 3, col = "black") +
geom_abline(intercept = 100, slope = 3, col = "blue") +
labs(title = "Subject i",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
# Nested - Subject j nested within subject i
p.ij <- ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 3, col = "red")+
geom_abline(intercept = 30, slope = 3, col = "orange") +
geom_abline(intercept = 40, slope = 3, col = "black") +
geom_abline(intercept = 50, slope = 3, col = "green") +
geom_abline(intercept = 60, slope = 3, col = "blue") +
geom_abline(intercept = 70, slope = 3, col = "violet") +
geom_abline(intercept = 80, slope = 3, col = "red")+
geom_abline(intercept = 90, slope = 3, col = "orange") +
geom_abline(intercept = 100, slope = 3, col = "black") +
geom_abline(intercept = 110, slope = 3, col = "green") +
geom_abline(intercept = 120, slope = 3, col = "blue") +
geom_abline(intercept = 130, slope = 3, col = "violet") +
labs(title = "Subject j nested within subject i",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
p.i + p.ij
# Chunk 5
library(knitr)
library(gridExtra)
library(kableExtra)
knitr::kable((pine[1:10, c(2,1,3,5,9)]),
caption = 'Sample red pine measurements from Cloquet, MN.') %>%
kable_styling(bootstrap_options = "bordered", full_width = FALSE)
# Chunk 6
pine.lm <- lm(HT ~ DBH, data = pine)
summary(pine.lm)
# Chunk 7
ggplot(pine, aes(DBH, HT)) +
geom_point() +
stat_smooth(method = "lm") +
labs(title = "Red pine at Cloquet Forestry Center",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
# Chunk 8
unique(pine$CoverType)
# Chunk 10
library(lme4)
# Chunk 11
pine.lme <- lmer(HT ~ DBH + (1 | CoverType),
data = pine)
summary(pine.lme)
# Chunk 12
plot(pine.lme)
# Chunk 13
ranef(pine.lme)
# Chunk 14
ggplot(pine, aes(DBH, HT)) +
geom_point(size = 0.1) +
geom_line(aes(y = predict(pine.lme), group = CoverType,
color = CoverType), size = 2) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by cover type",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
pine.lme2 <- lmer(HT ~ DBH + (1 + CoverType),
data = pine)
summary(pine.lme2)
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + CoverType),
data = pine)
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + DBH | CoverType),
data = pine)
summary(pine.lme2)
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + DBH | CoverType),
data = pine, REML + F)
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + DBH | CoverType),
data = pine, REML = F)
summary(pine.lme2)
plot(pine.lme2)
ranef(pine.lme2)
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 | DBH),
data = pine, REML = F)
summary(pine.lme2)
plot(pine.lme2)
ranef(pine.lme2)
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 | DBH/CoverType),
data = pine, REML = F)
summary(pine.lme2)
plot(pine.lme2)
ranef(pine.lme2)
ggplot(pine, aes(DBH, HT)) +
geom_point(size = 0.1) +
geom_line(aes(y = predict(pine.lme2), group = CoverType,
color = CoverType), size = 2) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by cover type",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + DBH/CoverType),
data = pine, REML = F)
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + DBH|CoverType),
data = pine, REML = F)
summary(pine.lme2)
plot(pine.lme2)
plot(pine.lme2)
ranef(pine.lme2)
ggplot(pine, aes(DBH, HT)) +
geom_point(size = 0.1) +
geom_line(aes(y = predict(pine.lme2), group = CoverType,
color = CoverType), size = 2) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by cover type",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + DBH | CoverType),
data = pine, REML = T)
summary(pine.lme2)
plot(pine.lme2)
ranef(pine.lme2)
ggplot(pine, aes(DBH, HT)) +
geom_point(size = 0.1) +
geom_line(aes(y = predict(pine.lme2), group = CoverType,
color = CoverType), size = 2) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by cover type",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
ggplot(pine, aes(DBH, HT)) +
geom_point(size = 0.1) +
geom_line(aes(y = predict(pine.lme2), group = DBH,
color = CoverType), size = 2) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by cover type",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
ggplot(pine, aes(DBH, HT)) +
geom_point(size = 0.1) +
geom_line(aes(y = predict(pine.lme2), group = CoverType,
color = CoverType), size = 2) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by cover type",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + DBH | CoverType),
data = pine, REML = F)
summary(pine.lme2)
n_distinct(pine$PlotNum)
ggplot(pine, aes(DBH, HT)) +
geom_point() +
facet_wrap(~PlotNum) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by plot number",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))+
ggplot(pine, aes(DBH, HT)) +
geom_point() +
facet_wrap(~PlotNum) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by plot number",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
blogdown:::serve_site()
ggplot(pine, aes(DBH, HT)) +
geom_point() +
facet_wrap(~CoverType, ncol = 7) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by plot number",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
ggplot(pine, aes(DBH, HT)) +
geom_point() +
facet_wrap(~PlotNum) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by plot number",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
pine.lme2 <- lmer(HT ~ DBH + (1 | CoverType/PlotNum),
data = pine)
summary(pine.lme2)
pine.lme3 <- lmer(HT ~ DBH + (1 | CoverType/PlotNum),
data = pine)
summary(pine.lme3)
plot(pine.lme3)
```{r}
head(ranef(pine.lme3))
```
head(ranef(pine.lme3[,1:10]))
head(ranef(pine.lme3))
plot(ranef(pine.lme3))
ranef(pine.lme3)
plot(ranef(pine.lme3))
# Nested - Subject j nested within subject i
ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 3, col = "red")+
geom_abline(intercept = 30, slope = 3, col = "orange") +
geom_abline(intercept = 40, slope = 3, col = "black") +
geom_abline(intercept = 50, slope = 3, col = "green") +
geom_abline(intercept = 60, slope = 3, col = "blue") +
geom_abline(intercept = 70, slope = 3, col = "violet") +
geom_abline(intercept = 80, slope = 3, col = "red")+
geom_abline(intercept = 90, slope = 3, col = "orange") +
geom_abline(intercept = 100, slope = 3, col = "black") +
geom_abline(intercept = 110, slope = 3, col = "green") +
geom_abline(intercept = 120, slope = 3, col = "blue") +
geom_abline(intercept = 130, slope = 3, col = "violet") +
labs(title = "Subject j nested within subject i",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
pine.lme3 <- lmer(HT ~ DBH + (1 | CoverType/PlotNum),
data = pine)
summary(pine.lme3)
ranef(pine.lme3)
plot(ranef(pine.lme3))
AIC(pine.lm, pine.lme, pine.lme2, pine.lme3)
# Chunk 1
library(tidyverse)
tree <- read_csv('C:/Users/russellm/Documents/Classes/UMN/NR 5021/Data/cfc.csv')
pine <- tree %>%
filter(Sp == 2 & HT > 10 &
TreeClass %in% c("Growth tree", "Ingrowth tree", "New tree in subplot"))
# Random intercepts
ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 3, col = "red")+
geom_abline(intercept = 30, slope = 3, col = "orange") +
geom_abline(intercept = 40, slope = 3, col = "black") +
geom_abline(intercept = 50, slope = 3, col = "green") +
geom_abline(intercept = 60, slope = 3, col = "blue") +
geom_abline(intercept = 70, slope = 3, col = "violet") +
labs(title = "Random intercept",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 150))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
# Chunk 2
ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 30, slope = 0.5, col = "red")+
geom_abline(intercept = 30, slope = 2, col = "orange") +
geom_abline(intercept = 30, slope = 3, col = "black") +
geom_abline(intercept = 30, slope = 5, col = "green") +
geom_abline(intercept = 30, slope = 7, col = "blue") +
geom_abline(intercept = 30, slope = 10, col = "violet") +
labs(title = "Random slope",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
# Chunk 3
ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 0.5, col = "red")+
geom_abline(intercept = 30, slope = 2, col = "orange") +
geom_abline(intercept = 40, slope = 3, col = "black") +
geom_abline(intercept = 50, slope = 5, col = "green") +
geom_abline(intercept = 60, slope = 7, col = "blue") +
geom_abline(intercept = 70, slope = 10, col = "violet") +
labs(title = "Random slope and intercept",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
# Chunk 4
library(patchwork)
# Nested - subject i
p.i <- ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 3, col = "red")+
geom_abline(intercept = 60, slope = 3, col = "black") +
geom_abline(intercept = 100, slope = 3, col = "blue") +
labs(title = "Subject i",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
# Nested - Subject j nested within subject i
p.ij <- ggplot(pine, aes(DBH, HT)) +
geom_point(col = "white") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black")) +
geom_abline(intercept = 20, slope = 3, col = "red")+
geom_abline(intercept = 30, slope = 3, col = "orange") +
geom_abline(intercept = 40, slope = 3, col = "black") +
geom_abline(intercept = 50, slope = 3, col = "green") +
geom_abline(intercept = 60, slope = 3, col = "blue") +
geom_abline(intercept = 70, slope = 3, col = "violet") +
geom_abline(intercept = 80, slope = 3, col = "red")+
geom_abline(intercept = 90, slope = 3, col = "orange") +
geom_abline(intercept = 100, slope = 3, col = "black") +
geom_abline(intercept = 110, slope = 3, col = "green") +
geom_abline(intercept = 120, slope = 3, col = "blue") +
geom_abline(intercept = 130, slope = 3, col = "violet") +
labs(title = "Subject j nested within subject i",
x = "X",
y = "Y") +
scale_y_continuous(limits = c(0, 250))+
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"),
axis.text=element_blank(),
axis.ticks=element_blank())
p.i + p.ij
# Chunk 5
library(knitr)
library(gridExtra)
library(kableExtra)
knitr::kable((pine[1:10, c(2,1,3,5,9)]),
caption = 'Sample red pine measurements from Cloquet, MN.') %>%
kable_styling(bootstrap_options = "bordered", full_width = FALSE)
# Chunk 6
pine.lm <- lm(HT ~ DBH, data = pine)
summary(pine.lm)
# Chunk 7
ggplot(pine, aes(DBH, HT)) +
geom_point() +
stat_smooth(method = "lm") +
labs(title = "Red pine at Cloquet Forestry Center",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
# Chunk 8
n_distinct(pine$CoverType)
# Chunk 9
ggplot(pine, aes(DBH, HT)) +
geom_point() +
facet_wrap(~CoverType, ncol = 7) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by CoverType",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
# Chunk 11
library(lme4)
# Chunk 12
pine.lme <- lmer(HT ~ DBH + (1 | CoverType),
data = pine)
summary(pine.lme)
# Chunk 13
plot(pine.lme)
# Chunk 14
ranef(pine.lme)
# Chunk 15
ggplot(pine, aes(DBH, HT)) +
geom_point(size = 0.1) +
geom_line(aes(y = predict(pine.lme), group = CoverType,
color = CoverType), size = 2) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by cover type",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
# Chunk 16
pine.lme2 <- lmer(HT ~ 1 + DBH + (1 + DBH | CoverType),
data = pine)
summary(pine.lme2)
# Chunk 17
n_distinct(pine$PlotNum)
# Chunk 18
ggplot(pine, aes(DBH, HT)) +
geom_point() +
facet_wrap(~PlotNum) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by plot number",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
# Chunk 19
pine.lme3 <- lmer(HT ~ DBH + (1 | CoverType/PlotNum),
data = pine)
summary(pine.lme3)
# Chunk 20
ranef(pine.lme3)
plot(ranef(pine.lme3))
AIC(pine.lm, pine.lme, pine.lme2, pine.lme3)
AIC(pine.lm, pine.lme, pine.lme2, pine.lme3)
blogdown:::serve_site()
ggplot(pine, aes(DBH, HT)) +
geom_point() +
facet_wrap(~CoverType, ncol = 7) +
labs(title = "Red pine at Cloquet Forestry Center",
subtitle = "HT-DBH by CoverType",
x = "Diameter at breast height (inches)",
y = "Height (feet)") +
theme(panel.background = element_rect(fill = "NA"),
axis.line = element_line(color="black"))
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
