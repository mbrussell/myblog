library(urbnmapr)
# Chunk 4
me_data <- tidy_fia(
states = "ME",
table_names = c("plot", "tree", "cond"),
postgis = FALSE
)
# Chunk 5
p.me <- plot(me_data)
p.me
# Chunk 6
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
cond <- me_data[["cond"]] %>% filter(invyr >= 1999)
tree <- me_data[["tree"]] %>% filter(invyr >= 1999)
# Chunk 7
plot_stats <- tree %>%
group_by(plt_cn) %>%
filter(statuscd == 1) %>%
summarize(
bapa = sum(tpa_unadj * 0.005454 * dia ^ 2, na.rm = TRUE),
cpa =  sum(tpa_unadj * carbon_ag, na.rm = TRUE)
) %>%
full_join(
plot %>% select(cn, statecd, unitcd, countycd, plot, invyr),
by = c("plt_cn" = "cn")
) %>%
mutate(cpa_tons = cpa /2000) %>%
replace_na(replace = list(bapa = 0, cpa = 0))
# Chunk 8
p.carbon <- ggplot(plot_stats, aes(x = bapa, y = cpa_tons)) +
geom_point() +
labs (x = "Basal area (sq. ft per acre)",
y = "Aboveground carbon (tons per acre)")
p.carbon
# Chunk 9
ref_species <- read_ref_table("REF_SPECIES") %>%
select(spcd, common_name)
common_spp <- me_data[["tree"]] %>%
group_by(spcd) %>%
tally %>%
top_n(6, wt = n) %>%
pull(spcd)
me_data[["tree"]] %>%
filter(spcd %in% common_spp) %>%
left_join(ref_species) %>%
ggplot(aes(x = dia, y = carbon_ag)) +
geom_point(alpha = 0.2) +
facet_wrap(~ common_name) +
labs (x = "Tree diameter (inches)",
y = "Aboveground carbon (pounds)")
# Chunk 10
plot2 <- plot_stats %>%
group_by(statecd, countycd, plot) %>%
mutate(plot_dummy = 1,
rem_id = cumsum(plot_dummy))
plot3 <- plot2 %>%
group_by(statecd, countycd, plot) %>%
summarize(max_rem_id = max(rem_id))
plot4 <- inner_join(plot3, plot2) %>%
filter(rem_id == max_rem_id)
remotes::install_github("SilviaTerra/tidyFIA")
library(tidyFIA)
library(sf)
library(spData)
library(knitr)
library(kableExtra)
library(tidycensus)
library(urbnmapr)
me_data <- tidy_fia(
states = "ME",
table_names = c("plot", "tree", "cond"),
postgis = FALSE
)
remotes::install_github("SilviaTerra/tidyFIA")
library(tidyFIA)
library(sf)
library(spData)
library(knitr)
library(kableExtra)
library(tidycensus)
library(urbnmapr)
me_data <- tidy_fia(
states = "ME",
table_names = c("plot", "tree", "cond"),
postgis = FALSE
)
p.me <- plot(me_data)
p.me
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
cond <- me_data[["cond"]] %>% filter(invyr >= 1999)
tree <- me_data[["tree"]] %>% filter(invyr >= 1999)
me_data[["plot"]]
me_data[["cond"]]
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
plot <- me_data[["plot"]]
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
plot <- me_data[["plot"]]
plot <- plot %>% filter(invyr >= 1999)
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
plot <- as.numeric(me_data[["plot"]]) %>% filter(invyr >= 1999)
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
cond <- me_data[["cond"]] %>% filter(invyr >= 1999)
cond
cond <- me_data[["cond"]]
View(cond)
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
cond <- me_data[["cond"]] %>% filter(invyr >= 1999)
remotes::install_github('rstudio/blogdown')
installed.packages("xfun")
install.packages("xfun")
# Chunk 2
library(tidyFIA)
# Chunk 3
library(sf)
library(spData)
library(knitr)
library(kableExtra)
library(tidycensus)
library(urbnmapr)
# Chunk 4
me_data <- tidy_fia(
states = "ME",
table_names = c("plot", "tree", "cond"),
postgis = FALSE
)
# Chunk 5
p.me <- plot(me_data)
p.me
# Chunk 6
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
cond <- me_data[["cond"]] %>% filter(invyr >= 1999)
tree <- me_data[["tree"]] %>% filter(invyr >= 1999)
plot <- me_data[["PLOT"]] %>% filter(invyr >= 1999)
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
# Chunk 2
library(tidyFIA)
# Chunk 3
library(sf)
library(spData)
library(knitr)
library(kableExtra)
library(tidycensus)
library(urbnmapr)
# Chunk 4
me_data <- tidy_fia(
states = "ME",
table_names = c("plot", "tree", "cond"),
postgis = FALSE
)
# Chunk 5
p.me <- plot(me_data)
p.me
# Chunk 6
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
cond <- me_data[["cond"]] %>% filter(invyr >= 1999)
tree <- me_data[["tree"]] %>% filter(invyr >= 1999)
plot <- me_data[["plot"]]
cond <- me_data[["cond"]]
tree <- me_data[["tree"]]
View(plot)
plot <- plot %>%
filter(invyr >= 1999)
is.numeric(plot$invyr)
plot2 <- plot %>%
filter(invyr >= 1999)
plot2 <- tibble(plot)
?tibble
plot2 <- as.tibble(plot)
library(tidyverse)
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
cond <- me_data[["cond"]] %>% filter(invyr >= 1999)
tree <- me_data[["tree"]] %>% filter(invyr >= 1999)
plot_stats <- tree %>%
group_by(plt_cn) %>%
filter(statuscd == 1) %>%
summarize(
bapa = sum(tpa_unadj * 0.005454 * dia ^ 2, na.rm = TRUE),
cpa =  sum(tpa_unadj * carbon_ag, na.rm = TRUE)
) %>%
full_join(
plot %>% select(cn, statecd, unitcd, countycd, plot, invyr),
by = c("plt_cn" = "cn")
) %>%
mutate(cpa_tons = cpa /2000) %>%
replace_na(replace = list(bapa = 0, cpa = 0))
p.carbon <- ggplot(plot_stats, aes(x = bapa, y = cpa_tons)) +
geom_point() +
labs (x = "Basal area (sq. ft per acre)",
y = "Aboveground carbon (tons per acre)")
p.carbon
ref_species <- read_ref_table("REF_SPECIES") %>%
select(spcd, common_name)
common_spp <- me_data[["tree"]] %>%
group_by(spcd) %>%
tally %>%
top_n(6, wt = n) %>%
pull(spcd)
me_data[["tree"]] %>%
filter(spcd %in% common_spp) %>%
left_join(ref_species) %>%
ggplot(aes(x = dia, y = carbon_ag)) +
geom_point(alpha = 0.2) +
facet_wrap(~ common_name) +
labs (x = "Tree diameter (inches)",
y = "Aboveground carbon (pounds)")
plot2 <- plot_stats %>%
group_by(statecd, countycd, plot) %>%
mutate(plot_dummy = 1,
rem_id = cumsum(plot_dummy))
plot3 <- plot2 %>%
group_by(statecd, countycd, plot) %>%
summarize(max_rem_id = max(rem_id))
plot4 <- inner_join(plot3, plot2) %>%
filter(rem_id == max_rem_id)
plot_stats_c<- plot4 %>%
ungroup() %>%
summarize(`FIA plots` = n(),
`Mean carbon` = round(mean(cpa_tons, na.rm = T), 1),
`SD carbon` = round(sd(cpa_tons, na.rm = T), 1),
`Min carbon` = round(min(cpa_tons, na.rm = T), 1),
`Max carbon` = round(max(cpa_tons, na.rm = T), 1))
kable((plot_stats_c[,])) %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
fips <- fips_codes %>%
rename(countycd = county_code) %>%
mutate(countycd = as.numeric(countycd)) %>%
filter(state == "ME")
plot4 <- inner_join(plot4, fips)
plot_stats_c_county<- plot4 %>%
group_by(county) %>%
summarize(`FIA plots` = n(),
`Mean carbon` = round(mean(cpa_tons, na.rm = T), 1),
`SD carbon` = round(sd(cpa_tons, na.rm = T), 1),
`Min carbon` = round(min(cpa_tons, na.rm = T), 1),
`Max carbon` = round(max(cpa_tons, na.rm = T), 1))
kable((plot_stats_c_county[,])) %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
plot_stats_c_county<- plot4 %>%
group_by(statecd, countycd) %>%
summarize(`FIA plots` = n(),
`Mean carbon` = round(mean(cpa_tons, na.rm = T), 1),
`SD carbon` = round(sd(cpa_tons, na.rm = T), 1),
`Min carbon` = round(min(cpa_tons, na.rm = T), 1),
`Max carbon` = round(max(cpa_tons, na.rm = T), 1))
plot_stats_c_county <- plot_stats_c_county %>%
mutate(county_fips = paste(statecd, ifelse(countycd < 10, paste0("00", countycd),
paste0("0", countycd)), sep = ""))
carbon_data <- left_join(plot_stats_c_county, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Mean carbon`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon (tons per acre)")
plot_stats_c_county<- plot4 %>%
group_by(statecd, countycd) %>%
summarize(`FIA plots` = n(),
`Mean carbon` = round(mean(cpa_tons, na.rm = T), 1),
`SD carbon` = round(sd(cpa_tons, na.rm = T), 1),
`Min carbon` = round(min(cpa_tons, na.rm = T), 1),
`Max carbon` = round(max(cpa_tons, na.rm = T), 1))
plot_stats_c_county <- plot_stats_c_county %>%
mutate(county_fips = paste(statecd, ifelse(countycd < 10, paste0("00", countycd),
paste0("0", countycd)), sep = ""))
carbon_data <- left_join(plot_stats_c_county, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Mean carbon`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon \n(tons per acre)")
plot_stats_c_county<- plot4 %>%
group_by(statecd, countycd) %>%
summarize(`FIA plots` = n(),
`Mean carbon` = round(mean(cpa_tons, na.rm = T), 1),
`SD carbon` = round(sd(cpa_tons, na.rm = T), 1),
`Min carbon` = round(min(cpa_tons, na.rm = T), 1),
`Max carbon` = round(max(cpa_tons, na.rm = T), 1))
plot_stats_c_county <- plot_stats_c_county %>%
mutate(county_fips = paste(statecd, ifelse(countycd < 10, paste0("00", countycd),
paste0("0", countycd)), sep = ""))
carbon_data <- left_join(plot_stats_c_county, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Mean carbon`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon \n(tons per acre)")
blogdown:::serve_site()
blogdown:::serve_site()
library(tidyverse)
library(sf)
library(spData)
library(tidycensus)
library(urbnmapr)
carbon <- read.csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon \n(tons per acre)")
# Chunk 2
library(tidyFIA)
# Chunk 3
library(tidyverse)
library(sf)
library(spData)
library(knitr)
library(kableExtra)
library(tidycensus)
library(urbnmapr)
# Chunk 4
me_data <- tidy_fia(
states = "RI",
table_names = c("plot", "tree", "cond"),
postgis = FALSE
)
# Chunk 5
p.me <- plot(me_data)
p.me
# Chunk 6
plot <- me_data[["plot"]] %>% filter(invyr >= 1999)
cond <- me_data[["cond"]] %>% filter(invyr >= 1999)
tree <- me_data[["tree"]] %>% filter(invyr >= 1999)
# Chunk 7
plot_stats <- tree %>%
group_by(plt_cn) %>%
filter(statuscd == 1) %>%
summarize(
bapa = sum(tpa_unadj * 0.005454 * dia ^ 2, na.rm = TRUE),
cpa =  sum(tpa_unadj * carbon_ag, na.rm = TRUE)
) %>%
full_join(
plot %>% select(cn, statecd, unitcd, countycd, plot, invyr),
by = c("plt_cn" = "cn")
) %>%
mutate(cpa_tons = cpa /2000) %>%
replace_na(replace = list(bapa = 0, cpa = 0))
# Chunk 8
p.carbon <- ggplot(plot_stats, aes(x = bapa, y = cpa_tons)) +
geom_point() +
labs (x = "Basal area (sq. ft per acre)",
y = "Aboveground carbon (tons per acre)")
p.carbon
# Chunk 9
ref_species <- read_ref_table("REF_SPECIES") %>%
select(spcd, common_name)
common_spp <- me_data[["tree"]] %>%
group_by(spcd) %>%
tally %>%
top_n(6, wt = n) %>%
pull(spcd)
me_data[["tree"]] %>%
filter(spcd %in% common_spp) %>%
left_join(ref_species) %>%
ggplot(aes(x = dia, y = carbon_ag)) +
geom_point(alpha = 0.2) +
facet_wrap(~ common_name) +
labs (x = "Tree diameter (inches)",
y = "Aboveground carbon (pounds)")
# Chunk 10
plot2 <- plot_stats %>%
group_by(statecd, countycd, plot) %>%
mutate(plot_dummy = 1,
rem_id = cumsum(plot_dummy))
plot3 <- plot2 %>%
group_by(statecd, countycd, plot) %>%
summarize(max_rem_id = max(rem_id))
plot4 <- inner_join(plot3, plot2) %>%
filter(rem_id == max_rem_id)
# Chunk 11
plot_stats_c<- plot4 %>%
ungroup() %>%
summarize(`FIA plots` = n(),
`Mean carbon` = round(mean(cpa_tons, na.rm = T), 1),
`SD carbon` = round(sd(cpa_tons, na.rm = T), 1),
`Min carbon` = round(min(cpa_tons, na.rm = T), 1),
`Max carbon` = round(max(cpa_tons, na.rm = T), 1))
# Chunk 12
kable((plot_stats_c[,])) %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
# Chunk 13
fips <- fips_codes %>%
rename(countycd = county_code) %>%
mutate(countycd = as.numeric(countycd)) %>%
filter(state == "ME")
plot4 <- inner_join(plot4, fips)
plot_stats_c_county<- plot4 %>%
group_by(county) %>%
summarize(`FIA plots` = n(),
`Mean carbon` = round(mean(cpa_tons, na.rm = T), 1),
`SD carbon` = round(sd(cpa_tons, na.rm = T), 1),
`Min carbon` = round(min(cpa_tons, na.rm = T), 1),
`Max carbon` = round(max(cpa_tons, na.rm = T), 1))
# Chunk 14
kable((plot_stats_c_county[,])) %>%
kable_styling(bootstrap_options = "bordered",
full_width = FALSE)
plot_stats_c_county<- plot4 %>%
group_by(statecd, countycd) %>%
summarize(`FIA plots` = n(),
`Mean carbon` = round(mean(cpa_tons, na.rm = T), 1),
`SD carbon` = round(sd(cpa_tons, na.rm = T), 1),
`Min carbon` = round(min(cpa_tons, na.rm = T), 1),
`Max carbon` = round(max(cpa_tons, na.rm = T), 1))
plot_stats_c_county <- plot_stats_c_county %>%
mutate(county_fips = paste(statecd, ifelse(countycd < 10, paste0("00", countycd),
paste0("0", countycd)), sep = ""))
carbon_data <- left_join(plot_stats_c_county, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Mean carbon`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon \n(tons per acre)")
carbon_data
carbon_data <- left_join(carbon, counties, by = "county_fips")
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon_data <- left_join(carbon, counties, by = "county_fips")
carbon %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon \n(tons per acre)")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon \n(tons per acre)")
carbon_data
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon_data <- left_join(carbon, counties, by = "county_fips")
counties
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon_data <- left_join(carbon, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon \n(tons per acre)")
counties$county_fips
carbon$county_fips
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon$county_fips <- as.character(carbon$county_fips)
carbon_data <- left_join(carbon, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Mean carbon \n(tons per acre)")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Total tree carbon \n(US tons)")
# Chunk 1
library(tidyverse)
library(sf)
library(spData)
library(tidycensus)
library(urbnmapr)
# Chunk 2
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon$county_fips <- as.character(carbon$county_fips)
carbon_data <- left_join(carbon, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Total tree carbon \n(US tons)")
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon$county_fips <- as.character(carbon$county_fips)
carbon_data <- left_join(carbon, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Total tree carbon \n(US tons)")
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon$county_fips <- as.character(carbon$county_fips)
carbon_data <- left_join(carbon, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Total tree carbon \n(US tons)")
carbon <- read_csv("C://Users//russellm//Documents//Projects//MFRC//Carbon//carboncounty.csv")
carbon$county_fips <- as.character(carbon$county_fips)
carbon_data <- left_join(carbon, counties, by = "county_fips")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Total tree carbon \n(US tons)")
carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Total tree carbon \n(US tons)")+
theme_bw()
carbon_data <- left_join(carbon, counties, by = "county_fips")
p.carbon <- carbon_data %>%
ggplot(aes(long, lat, group = group, fill = `Total`)) +
geom_polygon(color = NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
labs(fill = "Total tree carbon \n(US tons)",
x = "",
y = "")+
theme_bw()
ggsave(filename = "C://Users//russellm//Documents//Projects//MFRC//Carbon//mn_carbon.png",
plot = p.carbon, width = 3.0, height = 3.5, units = "in")
p.carbon
